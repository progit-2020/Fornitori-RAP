object R300FAccessiMensaDtM: TR300FAccessiMensaDtM
  OldCreateOrder = True
  OnCreate = R300FAccessiMensaDtMCreate
  OnDestroy = R300FAccessimensaDtMDestroy
  Height = 184
  Width = 485
  object Q360: TOracleDataSet
    SQL.Strings = (
      'SELECT * FROM T360_TERMENSA'
      '')
    Optimize = False
    QBEDefinition.QBEFieldDefs = {
      0500000023000000180000004E0055004D00540049004D004200500041005300
      54004F0001000000000018000000440049004600460054005200410032005400
      49004D0042000100000000001C000000540049004D00420044004F0050004F00
      55005300430049005400410001000000000020000000540049004D0042004100
      4E0054004500430045004E005400520041005400410001000000000022000000
      43004F004E00540052004F004C004C004F00500052004500530045004E005A00
      41000100000000001400000049004E00540045005200560041004C004C004F00
      01000000000022000000500041005500530041004D0045004E00530041004700
      4500530054004900540041000100000000001C00000050005200450053004500
      4E005A0041004D0049004E0049004D0041000100000000001400000056004F00
      430045005000410047004800450031000100000000001400000056004F004300
      45005000410047004800450032000100000000001C0000004F00520041005200
      49004F005300500045005A005A00410054004F000100000000000E0000004300
      41005500530041004C00450001000000000014000000430045004E0041005F00
      440041004C004C00450001000000000012000000430045004E0041005F004100
      4C004C0045000100000000001E0000004D0045004E00530041005F0053005400
      49004D0042005200410054004100010000000000260000004D0045004E005300
      41005F004E004F004E005F005300540049004D00420052004100540041000100
      00000000140000004F00520045005F004D0049004E0049004D00450001000000
      00002C0000004D0045004E00530041005F005300540049004D00420052004100
      540041005F0049004E005400450052004F00010000000000340000004D004500
      4E00530041005F004E004F004E005F005300540049004D004200520041005400
      41005F0049004E005400450052004F000100000000002E000000540049004D00
      420041004E0054004500430045004E00540052004100540041005F0049004E00
      5400450052004F000100000000002A000000540049004D00420044004F005000
      4F005500530043004900540041005F0049004E005400450052004F0001000000
      00003000000043004F004E00540052004F004C004C004F005000520045005300
      45004E005A0041005F0049004E005400450052004F000100000000002A000000
      4F0052004100520049004F005300500045005A005A00410054004F005F004900
      4E005400450052004F0001000000000030000000500041005500530041004D00
      45004E005300410047004500530054004900540041005F0049004E0054004500
      52004F000100000000002A000000500052004500530045004E005A0041004D00
      49004E0049004D0041005F0049004E005400450052004F000100000000002200
      000049004E00540045005200560041004C004C004F005F0049004E0054004500
      52004F00010000000000220000004F00520045005F004D0049004E0049004D00
      45005F0049004E005400450052004F000100000000002600000041004C004900
      4D0045004E00540041005F00420055004F004E00490050004100530054004F00
      01000000000016000000470045005300540049004F004E0045005F0050004D00
      01000000000024000000470045005300540049004F004E0045005F0050004D00
      5F0049004E005400450052004F000100000000000C00000050004D005F004D00
      49004E000100000000000C00000050004D005F004D0041005800010000000000
      1E00000050004D005F0041005300530045004E005A0045005F0054004F004C00
      4C000100000000002000000050004D005F00500052004500530045004E005A00
      45005F0054004F004C004C000100000000000C00000043004F00440049004300
      4500010000000000}
    Left = 8
    Top = 8
    object Q360NUMTIMBPASTO: TStringField
      FieldName = 'NUMTIMBPASTO'
      Size = 1
    end
    object Q360DIFFTRA2TIMB: TDateTimeField
      FieldName = 'DIFFTRA2TIMB'
    end
    object Q360TIMBDOPOUSCITA: TStringField
      FieldName = 'TIMBDOPOUSCITA'
      Size = 1
    end
    object Q360TIMBANTECENTRATA: TStringField
      FieldName = 'TIMBANTECENTRATA'
      Size = 1
    end
    object Q360CONTROLLOPRESENZA: TStringField
      FieldName = 'CONTROLLOPRESENZA'
      Size = 1
    end
    object Q360INTERVALLO: TStringField
      FieldName = 'INTERVALLO'
      Size = 5
    end
    object Q360PAUSAMENSAGESTITA: TStringField
      FieldName = 'PAUSAMENSAGESTITA'
      Size = 1
    end
    object Q360PRESENZAMINIMA: TStringField
      FieldName = 'PRESENZAMINIMA'
      Size = 1
    end
    object Q360VOCEPAGHE1: TStringField
      FieldName = 'VOCEPAGHE1'
      Size = 6
    end
    object Q360VOCEPAGHE2: TStringField
      FieldName = 'VOCEPAGHE2'
      Size = 6
    end
    object Q360ORARIOSPEZZATO: TStringField
      FieldName = 'ORARIOSPEZZATO'
      Size = 1
    end
    object Q360CAUSALE: TStringField
      FieldName = 'CAUSALE'
      Size = 1
    end
    object Q360CENA_DALLE: TStringField
      FieldName = 'CENA_DALLE'
      Size = 5
    end
    object Q360CENA_ALLE: TStringField
      FieldName = 'CENA_ALLE'
      Size = 5
    end
    object Q360MENSA_STIMBRATA: TStringField
      FieldName = 'MENSA_STIMBRATA'
      Size = 1
    end
    object Q360MENSA_NON_STIMBRATA: TStringField
      FieldName = 'MENSA_NON_STIMBRATA'
      Size = 1
    end
    object Q360ORE_MINIME: TStringField
      FieldName = 'ORE_MINIME'
      Size = 5
    end
    object Q360MENSA_STIMBRATA_INTERO: TStringField
      FieldName = 'MENSA_STIMBRATA_INTERO'
      Size = 1
    end
    object Q360MENSA_NON_STIMBRATA_INTERO: TStringField
      FieldName = 'MENSA_NON_STIMBRATA_INTERO'
      Size = 1
    end
    object Q360TIMBANTECENTRATA_INTERO: TStringField
      FieldName = 'TIMBANTECENTRATA_INTERO'
      Size = 1
    end
    object Q360TIMBDOPOUSCITA_INTERO: TStringField
      FieldName = 'TIMBDOPOUSCITA_INTERO'
      Size = 1
    end
    object Q360CONTROLLOPRESENZA_INTERO: TStringField
      FieldName = 'CONTROLLOPRESENZA_INTERO'
      Size = 1
    end
    object Q360ORARIOSPEZZATO_INTERO: TStringField
      FieldName = 'ORARIOSPEZZATO_INTERO'
      Size = 1
    end
    object Q360PAUSAMENSAGESTITA_INTERO: TStringField
      FieldName = 'PAUSAMENSAGESTITA_INTERO'
      Size = 1
    end
    object Q360PRESENZAMINIMA_INTERO: TStringField
      FieldName = 'PRESENZAMINIMA_INTERO'
      Size = 1
    end
    object Q360INTERVALLO_INTERO: TStringField
      FieldName = 'INTERVALLO_INTERO'
      Size = 1
    end
    object Q360ORE_MINIME_INTERO: TStringField
      FieldName = 'ORE_MINIME_INTERO'
      Size = 1
    end
    object Q360CODICE: TStringField
      FieldName = 'CODICE'
      Required = True
    end
    object Q360MATURA_BUONO: TStringField
      FieldName = 'MATURA_BUONO'
      Size = 1
    end
    object Q360MATURA_BUONO_INTERO: TStringField
      FieldName = 'MATURA_BUONO_INTERO'
      Size = 1
    end
    object Q360MENSA_DALLE: TStringField
      FieldName = 'MENSA_DALLE'
      Size = 5
    end
    object Q360MENSA_ALLE: TStringField
      FieldName = 'MENSA_ALLE'
      Size = 5
    end
    object Q360INTERVALLO_PM_INTERO: TStringField
      FieldName = 'INTERVALLO_PM_INTERO'
      Size = 1
    end
  end
  object Q370: TOracleDataSet
    SQL.Strings = (
      'SELECT DATA,ORA,VERSO,CAUSALE,RILEVATORE '
      'FROM T370_TIMBMENSA'
      'WHERE '
      'PROGRESSIVO = :PROGRESSIVO AND '
      'DATA BETWEEN :DADATA AND :ADATA AND '
      'FLAG IN ('#39'O'#39','#39'I'#39')'
      'ORDER BY DATA,ORA')
    Optimize = False
    Variables.Data = {
      0400000003000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000E0000003A0044004100440041005400
      41000C00000000000000000000000C0000003A00410044004100540041000C00
      00000000000000000000}
    Left = 44
    Top = 8
  end
  object Q100: TOracleDataSet
    SQL.Strings = (
      'SELECT DATA,ORA,VERSO,CAUSALE'
      'FROM T100_TIMBRATURE'
      'WHERE '
      'PROGRESSIVO = :PROGRESSIVO AND '
      'DATA BETWEEN :DADATA AND :ADATA AND '
      'FLAG IN ('#39'O'#39','#39'I'#39')'
      'UNION'
      'SELECT DATA,DAORE + 2 ORA,'#39'E'#39',CAUSALE'
      'FROM T040_GIUSTIFICATIVI T040, T275_CAUPRESENZE T275 '
      'WHERE '
      'T040.PROGRESSIVO = :PROGRESSIVO AND '
      'T040.DATA BETWEEN :DADATA AND :ADATA AND '
      'T040.TIPOGIUST = '#39'D'#39' AND'
      'T040.CAUSALE = T275.CODICE AND'
      'T275.GIUST_DAA_TIMB = '#39'S'#39
      'UNION'
      'SELECT DATA,AORE + 2 ORA,'#39'U'#39',CAUSALE'
      'FROM T040_GIUSTIFICATIVI T040, T275_CAUPRESENZE T275 '
      'WHERE '
      'T040.PROGRESSIVO = :PROGRESSIVO AND '
      'T040.DATA BETWEEN :DADATA AND :ADATA AND '
      'T040.TIPOGIUST = '#39'D'#39' AND'
      'T040.CAUSALE = T275.CODICE AND'
      'T275.GIUST_DAA_TIMB = '#39'S'#39
      'ORDER BY 1,2')
    Optimize = False
    Variables.Data = {
      0400000003000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000E0000003A0044004100440041005400
      41000C00000000000000000000000C0000003A00410044004100540041000C00
      00000000000000000000}
    Left = 80
    Top = 8
  end
  object selT305: TOracleDataSet
    SQL.Strings = (
      'SELECT T305.CODICE FROM '
      'T305_CAUGIUSTIF T305, T300_RAGGRGIUSTIF T300'
      'WHERE'
      'T305.CODRAGGR = T300.CODICE AND'
      'T300.CODINTERNO = '#39'B'#39)
    Optimize = False
    Left = 124
    Top = 8
  end
  object selT375: TOracleDataSet
    SQL.Strings = (
      'SELECT DATA,CAUSALE,ACCESSI,PRANZOCENA,RILEVATORE'
      'FROM T375_ACCESSIMENSA'
      'WHERE '
      'PROGRESSIVO = :PROGRESSIVO AND '
      'DATA BETWEEN :DADATA AND :ADATA'
      'ORDER BY DATA')
    Optimize = False
    Variables.Data = {
      0400000003000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000E0000003A0044004100440041005400
      41000C00000000000000000000000C0000003A00410044004100540041000C00
      00000000000000000000}
    Left = 8
    Top = 56
  end
  object QDelete: TOracleQuery
    SQL.Strings = (
      'DELETE FROM T410_PASTI'
      'WHERE '
      'PROGRESSIVO =:PROGRESSIVO AND'
      'ANNO =:ANNO AND'
      'MESE =:MESE')
    Optimize = False
    Variables.Data = {
      0400000003000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000A0000003A0041004E004E004F000300
      000000000000000000000A0000003A004D004500530045000300000000000000
      00000000}
    Left = 196
    Top = 12
  end
  object QInsert: TOracleQuery
    SQL.Strings = (
      'INSERT INTO T410_PASTI'
      '(PROGRESSIVO,ANNO,MESE,CAUSALE,PASTI,PASTI2)'
      'VALUES'
      '(:PROGRESSIVO,:ANNO,:MESE,:CAUSALE,:PASTI,:PASTI2) ')
    Optimize = False
    Variables.Data = {
      0400000006000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000A0000003A0041004E004E004F000300
      000000000000000000000A0000003A004D004500530045000300000000000000
      000000000C0000003A0050004100530054004900030000000000000000000000
      0E0000003A005000410053005400490032000300000000000000000000001000
      00003A00430041005500530041004C004500050000000000000000000000}
    Left = 236
    Top = 12
  end
  object selT360: TOracleDataSet
    SQL.Strings = (
      'select ALIMENTA_BUONIPASTO from T360_TERMENSA')
    Optimize = False
    Left = 288
    Top = 13
  end
  object QDelT680: TOracleQuery
    SQL.Strings = (
      'begin'
      '  DELETE FROM T680_BUONIMENSILI'
      '  WHERE PROGRESSIVO =:PROGRESSIVO '
      '  AND ANNO =:ANNO '
      '  AND MESE =:MESE'
      '  AND nvl(VARBUONIPASTO,0) = 0'
      '  AND nvl(VARTICKET,0) = 0;'
      '  '
      '  if sql%rowcount = 0 then'
      '    UPDATE T680_BUONIMENSILI set'
      '      BUONIPASTO = null,'
      '      TICKET = null'
      '    WHERE PROGRESSIVO =:PROGRESSIVO '
      '    AND ANNO =:ANNO '
      '    AND MESE =:MESE;'
      '  end if;'
      'end;')
    Optimize = False
    Variables.Data = {
      0400000003000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000A0000003A0041004E004E004F000300
      000000000000000000000A0000003A004D004500530045000300000000000000
      00000000}
    Left = 336
    Top = 13
  end
  object insT680: TOracleQuery
    SQL.Strings = (
      'begin'
      '  update t680_buonimensili set'
      '    buonipasto = :buonipasto,'
      '    ticket = :ticket'
      
        '  where progressivo = :progressivo and anno = :anno and mese = :' +
        'mese;'
      '  if sql%rowcount = 0 then'
      '    if (:buonipasto <> 0) or (:ticket <> 0) then'
      '      insert into t680_buonimensili '
      '        (progressivo,anno,mese,buonipasto,ticket)'
      '      values'
      '        (:progressivo,:anno,:mese,:buonipasto,:ticket);'
      '    end if;'
      '  end if;'
      'end;')
    Optimize = False
    Variables.Data = {
      0400000005000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000A0000003A0041004E004E004F000300
      000000000000000000000A0000003A004D004500530045000300000000000000
      00000000160000003A00420055004F004E00490050004100530054004F000300
      000000000000000000000E0000003A005400490043004B004500540003000000
      0000000000000000}
    Left = 390
    Top = 10
  end
end
