-- E' necessario eseguire i seguenti comandi come utente SYS:
-- GRANT SELECT ON V_$SESSION TO PUBLIC;
-- GRANT SELECT ON V_$MYSTAT TO PUBLIC;
CREATE OR REPLACE TRIGGER T030_AFTERINS_I060
  after insert on T030_ANAGRAFICO
  for each row
declare
azienda varchar2(50);
begin
  BEGIN
    SELECT AZIENDA INTO azienda FROM V$SESSION V, MONDOEDP.I090_ENTI I090
    WHERE V.SID = (SELECT MAX(SID) FROM V$MYSTAT) AND V.USERNAME = I090.UTENTE;
    INSERT INTO MONDOEDP.I060_LOGIN_DIPENDENTE (MATRICOLA,NOME_UTENTE,DATA_PW,AZIENDA)
    VALUES(:NEW.MATRICOLA,:NEW.MATRICOLA,TRUNC(SYSDATE),azienda);
  EXCEPTION
    WHEN OTHERS THEN NULL;
  END;
end T030_AFTERINS_I060;
/