/*
Anagrafica dati stipendiali
Integrità referenziali: T030_ANAGRAFICO P010_BANCHE P020_STATOCIVILE 
                        P040_PARTTIME P080_CAUSALIIRPEF P090_CODICIINPS P092_CODICIINAIL 
                        P120_NAZIONALITA P120_NAZIONALITAESTERE
*/
CREATE TABLE P430_ANAGRAFICO (
  PROGRESSIVO NUMBER,
  DECORRENZA DATE,
  COD_CONTRATTO VARCHAR2(5),
  COD_POSIZIONE_ECONOMICA VARCHAR2(5),
  COD_PARTTIME VARCHAR2(5),
  NO_CEDOLINO_NORMALE VARCHAR2(1) DEFAULT 'N',
  COD_PAGAMENTO VARCHAR2(5),
  COD_VALUTA_STAMPA VARCHAR2(10),
  DETRAZ_LAVDIP VARCHAR2(1) DEFAULT 'N',
  REDDITO_DETRAZ_LAVDIP NUMBER,
  REDDITO_DETRAZ_CONIUGE NUMBER,
  COD_TABELLAANF VARCHAR2(5),
  COMPONENTI_ANF NUMBER,
  REDDITO_ANF NUMBER,
  VARIAZIONE_IMPORTO_ANF NUMBER,
  SCADENZA_ANF DATE,
  PERC_IRPEF_MANUALE NUMBER,
  CONGUAGLIO VARCHAR2(1) DEFAULT 'C',
  TREDICESIMA VARCHAR2(1) DEFAULT 'C',
  TFR VARCHAR2(1) DEFAULT 'S',
  COD_BANCA VARCHAR2(15),
  CONTO_CORRENTE VARCHAR2(13),
  COD_STATOCIVILE VARCHAR2(5),
  COD_NAZIONALITA VARCHAR2(5),
  COD_NAZIONALITAESTERE VARCHAR2(5),
  REDDITO_DETRAZ_FIGLI_ALTRI NUMBER,
  COD_PARAMETRISTIPENDI VARCHAR2(5),
  PERC_IRPEF_TFR NUMBER DEFAULT 0 NOT NULL,
  TIPO_CALCOLO_IMPORTO13A VARCHAR2(2) DEFAULT 'AC' NOT NULL,
  COD_CODICEINPS VARCHAR2(5),
  COD_CODICEINAIL VARCHAR2(5),
  STATO_DIPENDENTE VARCHAR2(1) DEFAULT 1 NOT NULL,
  TIPO_DIPENDENTE VARCHAR2(2) DEFAULT 'RU',
  COD_CAUSALEIRPEF VARCHAR2(10),
  COD_TIPOASSOGGETTAMENTO VARCHAR2(5),
  DETRAZ_REDDITI_MIN_INDET VARCHAR2(1) DEFAULT 'N',
  DETRAZ_REDDITI_MIN_DET VARCHAR2(1) DEFAULT 'N',
  REDDITO_DETRAZ_REDDITI_MIN NUMBER,
  COD_REGIONE_IRPEF VARCHAR2(5),
  COD_COMUNE_IRPEF VARCHAR2(6),
  COD_CUDINPDAPCAUSACESS VARCHAR2(5),
  COD_INQUADRINPDAP VARCHAR2(10),
  COD_INQUADRINPS VARCHAR2(10),
  LIVELLO_INPS VARCHAR2(5),
  PROGRESSIVO_EREDE_DI NUMBER,
  PERC_EREDITA NUMBER,
  COD_CATEGPARTICOLARE VARCHAR2(5),
  COD_QUALIFICA_INAIL VARCHAR2(5),
  COD_COMUNE_INAIL VARCHAR2(4),
  COD_CAUSALELA VARCHAR2(5),
  COD_DEDUZIONEIRPEF VARCHAR2(10),
  DETRAZ_PROGR_IMP VARCHAR2(1) DEFAULT 'S',
  REDDITO_DETRAZ_PROGR_IMP NUMBER,
  CONSTRAINT P430_PK PRIMARY KEY (PROGRESSIVO,DECORRENZA)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 1M)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 1M)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P430_ANAGRAFICO.NO_CEDOLINO_NORMALE IS
  'Assenza cedolino: S=Emissione sole voci variabili, N=Emissione normale, F=Forzata la non emissione';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_PAGAMENTO IS
  'Tipo pagamento del cedolino: se non definito si assume il valore di setup';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_VALUTA_STAMPA IS
  'Valuta del netto del cedolino: se non definita si assume il valore di setup';
COMMENT ON COLUMN P430_ANAGRAFICO.DETRAZ_LAVDIP IS
  'Calcolo detrazioni lavoro dipendente';
COMMENT ON COLUMN P430_ANAGRAFICO.REDDITO_DETRAZ_LAVDIP IS
  'Reddito annuale fisso per calcolo detrazioni lavoro dipendente; (opzionale)';
COMMENT ON COLUMN P430_ANAGRAFICO.REDDITO_DETRAZ_CONIUGE IS
  'Reddito annuale fisso per calcolo detrazioni coniuge a carico; (opzionale)';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_TABELLAANF IS
  'Tabella INPS di riferimento per ANF';
COMMENT ON COLUMN P430_ANAGRAFICO.COMPONENTI_ANF IS
  'Componenti nucleo familiare per ANF';
COMMENT ON COLUMN P430_ANAGRAFICO.REDDITO_ANF IS
  'Reddito familiare per ANF';
COMMENT ON COLUMN P430_ANAGRAFICO.VARIAZIONE_IMPORTO_ANF IS
  'Variazione all''importo tabellare dell''ANF per particolari situazioni';
COMMENT ON COLUMN P430_ANAGRAFICO.SCADENZA_ANF IS
  'Scadenza documenti per ANF';
COMMENT ON COLUMN P430_ANAGRAFICO.PERC_IRPEF_MANUALE IS
  '% IRPEF manuale fissa; (opzionale)';
COMMENT ON COLUMN P430_ANAGRAFICO.CONGUAGLIO IS
  'Conguaglio IRPEF (S/N/C)';
COMMENT ON COLUMN P430_ANAGRAFICO.TREDICESIMA IS
  'Tredicesima (S/N/C)';
COMMENT ON COLUMN P430_ANAGRAFICO.TFR IS
  'Regime TFR (S/N)';
COMMENT ON COLUMN P430_ANAGRAFICO.REDDITO_DETRAZ_FIGLI_ALTRI IS
  'Reddito annuale complessivo per calcolo detrazioni figli o altri familiari a carico; (opzionale)';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_PARAMETRISTIPENDI IS
  'Codice parametri stipendi (es. gg.del mese)';
COMMENT ON COLUMN P430_ANAGRAFICO.PERC_IRPEF_TFR IS
  '% IRPEF per TFR';
COMMENT ON COLUMN P430_ANAGRAFICO.TIPO_CALCOLO_IMPORTO13A IS
  'Tipo calcolo importo tredicesima: AC=In base al contratto, UM=Calcolo considerando solo la retribuzione dell''ultimo mese, RM=Calcolo considerando la retribuzione di tutti i mesi';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_CODICEINPS IS
  'Codice INPS principalmente per modello DM/10';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_CODICEINAIL IS
  'Codice INAIL principalmente per modello 10-S.M.';
COMMENT ON COLUMN P430_ANAGRAFICO.STATO_DIPENDENTE IS
  'Stato dipendente: 0=Non dipendente, 1=Dipendente retribuito, 2=Dipendente non retribuito';
COMMENT ON COLUMN P430_ANAGRAFICO.TIPO_DIPENDENTE IS
  'Tipo dipendente: RU=A ruolo, ER=Erede, BO=Borsista, CO=Co.Co.Co., LU=L.S.U., LA=Lav.autonomo';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_CAUSALEIRPEF IS
  'Causale di versamento IRPEF';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_TIPOASSOGGETTAMENTO IS
  'Codice tipo assoggettamento';
COMMENT ON COLUMN P430_ANAGRAFICO.DETRAZ_REDDITI_MIN_INDET IS
  'Detrazioni redditi minimi contratto a tempo indeterminato';
COMMENT ON COLUMN P430_ANAGRAFICO.DETRAZ_REDDITI_MIN_DET IS
  'Detrazioni redditi minimi contratto a tempo determinato';
COMMENT ON COLUMN P430_ANAGRAFICO.REDDITO_DETRAZ_REDDITI_MIN IS
  'Reddito annuale complessivo per calcolo detrazioni per redditi minimi; (opzionale)';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_REGIONE_IRPEF IS
  'Codice regione particolare per addizionale IRPEF';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_COMUNE_IRPEF IS
  'Codice comune particolare per addizionale IRPEF';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_CUDINPDAPCAUSACESS IS
  'Codice causa di cessazione sezione INPDAP del CUD';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_INQUADRINPDAP IS
  'Codice inquadramento INPDAP';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_INQUADRINPS IS
  'Codice inquadramento INPS';
COMMENT ON COLUMN P430_ANAGRAFICO.LIVELLO_INPS IS
  'Livello di inquadramento INPS';
COMMENT ON COLUMN P430_ANAGRAFICO.PROGRESSIVO_EREDE_DI IS
  'Progressivo del dipendente di cui e'' erede';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_CATEGPARTICOLARE IS
  'Codice categoria particolare 770';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_QUALIFICA_INAIL IS
  'Codice qualifica INAIL (ulteriore categoria) 770';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_COMUNE_INAIL IS
  'Codice comune INAIL sede di lavoro principale';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_CAUSALELA IS
  'Codice causale somme erogate lavoratori autonomi 770';
COMMENT ON COLUMN P430_ANAGRAFICO.COD_DEDUZIONEIRPEF IS
  'Codice deduzione IRPEF';
COMMENT ON COLUMN P430_ANAGRAFICO.DETRAZ_PROGR_IMP IS
  'Calcolo detrazioni per mantenimento progressivita'' imposizione';
COMMENT ON COLUMN P430_ANAGRAFICO.REDDITO_DETRAZ_PROGR_IMP IS
  'Reddito annuale complessivo per calcolo deduzioni e detrazioni no-tax area; (opzionale)';

ALTER TABLE P430_ANAGRAFICO ADD CONSTRAINT P430_FK_T030
  FOREIGN KEY (PROGRESSIVO) REFERENCES T030_ANAGRAFICO;

ALTER TABLE P430_ANAGRAFICO ADD CONSTRAINT P430_FK_P010
  FOREIGN KEY (COD_BANCA) REFERENCES P010_BANCHE;

ALTER TABLE P430_ANAGRAFICO ADD CONSTRAINT P430_FK_P020
  FOREIGN KEY (COD_STATOCIVILE) REFERENCES P020_STATOCIVILE;

ALTER TABLE P430_ANAGRAFICO ADD CONSTRAINT P430_FK_P040
  FOREIGN KEY (COD_PARTTIME) REFERENCES P040_PARTTIME;

ALTER TABLE P430_ANAGRAFICO ADD CONSTRAINT P430_FK_P080
  FOREIGN KEY (COD_CAUSALEIRPEF) REFERENCES P080_CAUSALIIRPEF;

ALTER TABLE P430_ANAGRAFICO ADD CONSTRAINT P430_FK_P120
  FOREIGN KEY (COD_NAZIONALITA) REFERENCES P120_NAZIONALITA;

ALTER TABLE P430_ANAGRAFICO ADD CONSTRAINT P430_FK_P121
  FOREIGN KEY (COD_NAZIONALITAESTERE) REFERENCES P121_NAZIONALITAESTERE;

ALTER TABLE P430_ANAGRAFICO ADD CONSTRAINT P430_FK_P130
  FOREIGN KEY (COD_PAGAMENTO) REFERENCES P130_PAGAMENTI;

ALTER TABLE P430_ANAGRAFICO ADD CONSTRAINT P430_FK_T482
  FOREIGN KEY (COD_REGIONE_IRPEF) REFERENCES T482_REGIONI;

ALTER TABLE P430_ANAGRAFICO ADD CONSTRAINT P430_FK_T480
  FOREIGN KEY (COD_COMUNE_IRPEF) REFERENCES T480_COMUNI;

/*
Stato cedolini dipendente
Integrità referenziali: T030_ANAGRAFICO
*/
CREATE TABLE P440_CEDOLINOSTATO (
  PROGRESSIVO NUMBER,
  ID_CEDOLINO_APERTO NUMBER DEFAULT 0,
  CEDOLINO_CALCOLATO VARCHAR2(1) DEFAULT 'N',
  ID_CEDOLINO_CHIUSO NUMBER DEFAULT 0,
  DATA_CEDOLINO_CHIUSO DATE DEFAULT NULL,
  CONSTRAINT P440_PK PRIMARY KEY (PROGRESSIVO)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 512K)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P440_CEDOLINOSTATO.DATA_CEDOLINO_CHIUSO IS
  'Anno e mese di paga (cassa)';
COMMENT ON COLUMN P440_CEDOLINOSTATO.CEDOLINO_CALCOLATO IS
  'Indica se il cedolino aperto e'' gia'' stato calcolato';

ALTER TABLE P440_CEDOLINOSTATO ADD CONSTRAINT P440_FK_T030
  FOREIGN KEY (PROGRESSIVO) REFERENCES T030_ANAGRAFICO;

/*
Testata cedolino dipendente
Integrità referenziali: T030_ANAGRAFICO, P130_PAGAMENTI
*/
CREATE TABLE P441_CEDOLINO (
  PROGRESSIVO NUMBER NOT NULL,
  DATA_CEDOLINO DATE NOT NULL,
  DATA_RETRIBUZIONE DATE NOT NULL,
  TIPO_CEDOLINO VARCHAR2(2) NOT NULL,
  DATA_EMISSIONE DATE DEFAULT NULL,
  ID_CEDOLINO NUMBER,
  CHIUSO VARCHAR2(1) DEFAULT 'N',
  PROGRESSIVO_MESE NUMBER,
  COD_VALUTA_STAMPA VARCHAR2(10),
  COD_PAGAMENTO VARCHAR2(5),
  PERC_IRPEF_MANUALE NUMBER,
  NOTE LONG,
  CONSTRAINT P441_PK PRIMARY KEY (ID_CEDOLINO)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 10M)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 10M)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P441_CEDOLINO.DATA_CEDOLINO IS
  'Anno e mese di paga (cassa)';
COMMENT ON COLUMN P441_CEDOLINO.DATA_RETRIBUZIONE IS
  'Anno e mese di retribuzione';
COMMENT ON COLUMN P441_CEDOLINO.TIPO_CEDOLINO IS
  'Tipo cedolino: NR=Normale; TR=Tredicesima; EX=Extra 27; RP=Rapporto di lavoro precedente';
COMMENT ON COLUMN P441_CEDOLINO.DATA_EMISSIONE IS
  'Data di emissione del cedolino (se assente il cedolino non è stato emesso)';
COMMENT ON COLUMN P441_CEDOLINO.CHIUSO IS
  'Chiuso (S/N) se il cedolino è stato chiuso';
COMMENT ON COLUMN P441_CEDOLINO.PROGRESSIVO_MESE IS
  'Per la gestione dei cedolini vidimati che devono contenere il numero progressivo';
COMMENT ON COLUMN P441_CEDOLINO.COD_VALUTA_STAMPA IS
  'Valuta del netto del cedolino';
COMMENT ON COLUMN P441_CEDOLINO.COD_PAGAMENTO IS
  'Codice pagamento';
COMMENT ON COLUMN P441_CEDOLINO.PERC_IRPEF_MANUALE IS
  '% IRPEF manuale fissa; (opzionale)';

ALTER TABLE P441_CEDOLINO ADD CONSTRAINT P441_FK_T030
  FOREIGN KEY (PROGRESSIVO) REFERENCES T030_ANAGRAFICO;

ALTER TABLE P441_CEDOLINO ADD CONSTRAINT P441_FK_P130
  FOREIGN KEY (COD_PAGAMENTO) REFERENCES P130_PAGAMENTI;

/*
Voci del cedolino del dipendente
Integrità referenziali: P200_VOCI P441_CEDOLINO
*/
CREATE TABLE P442_CEDOLINOVOCI (
  ID_CEDOLINO NUMBER,
  TIPO_RECORD VARCHAR2(1),
  COD_CONTRATTO VARCHAR2(5),
  COD_VOCE VARCHAR2(5),
  COD_VOCE_SPECIALE VARCHAR2(5),
  ID_VOCE NUMBER DEFAULT 0,
  QUANTITA VARCHAR2(10),
  DATOBASE VARCHAR2(15),
  IMPORTO NUMBER,
  IMPORTO_INTERO NUMBER,
  ORIGINE VARCHAR2(1),
  DATA_COMPETENZA_QUOTE DATE,
  DATA_COMPETENZA_DA DATE,
  DATA_COMPETENZA_A DATE,
  ECCEZIONI VARCHAR2(5)
)
STORAGE (pctincrease 0 initial 16K next 10M)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P442_CEDOLINOVOCI.TIPO_RECORD IS
  'Tipo record: A=Automatico; M=Manuale';
COMMENT ON COLUMN P442_CEDOLINOVOCI.QUANTITA IS
  'Ore / Giorni / % / Quantità';
COMMENT ON COLUMN P442_CEDOLINOVOCI.DATOBASE IS
  'Valore da stampare nella colonna Dato base. Può essere importo unitario,imponibile o altro';
COMMENT ON COLUMN P442_CEDOLINOVOCI.IMPORTO_INTERO IS
  'Importo della voce prima della riduzione per Part-time e per assunzione/cessazione oppure importo prima dell''arrotondamento del calcolo';
COMMENT ON COLUMN P442_CEDOLINOVOCI.ORIGINE IS
  'Origine della voce: I=Voce iniziale (es. Straordinario; Assenza) gli importi possono essere calcolati dal precalcolo; P=Voce creata in fase di precalcolo (es. Stipendio); C=Voce creata in fase di calcolo (es. ritenute, detr.coniuge a carico autom.)';
COMMENT ON COLUMN P442_CEDOLINOVOCI.DATA_COMPETENZA_QUOTE IS
  'Anno e mese di competenza per il calcolo delle quote';
COMMENT ON COLUMN P442_CEDOLINOVOCI.DATA_COMPETENZA_DA IS
  'Inizio periodo di competenza per la voce';
COMMENT ON COLUMN P442_CEDOLINOVOCI.DATA_COMPETENZA_A IS
  'Fine periodo di competenza per la voce';
COMMENT ON COLUMN P442_CEDOLINOVOCI.ECCEZIONI IS
  'Eccezioni di calcolo a cui sottoporre la voce';

ALTER TABLE P442_CEDOLINOVOCI ADD CONSTRAINT P442_FK_P200
  FOREIGN KEY (ID_VOCE) REFERENCES P200_VOCI(ID_VOCE);

ALTER TABLE P442_CEDOLINOVOCI ADD CONSTRAINT P442_FK_P441
  FOREIGN KEY (ID_CEDOLINO) REFERENCES P441_CEDOLINO ON DELETE CASCADE;

CREATE SEQUENCE P442_ID_CEDOLINO
  MINVALUE 1
  NOMAXVALUE
  INCREMENT BY 1
  NOORDER
  NOCACHE;

/*
Dati mensili
Integrità referenziali: T030_ANAGRAFICO
*/
CREATE TABLE P450_DATIMENSILI (
  PROGRESSIVO NUMBER,
  DATA_RETRIBUZIONE DATE,
  TIPO_RECORD VARCHAR2(1),
  COD_CAMPO VARCHAR2(5),
  VALORE VARCHAR2(15) DEFAULT '0',
  VARIAZIONE_CALCOLATA NUMBER DEFAULT 0 NOT NULL,
  VARIAZIONE_TOTALE NUMBER DEFAULT 0 NOT NULL,
  CONSTRAINT P450_PK PRIMARY KEY (PROGRESSIVO,DATA_RETRIBUZIONE,TIPO_RECORD,COD_CAMPO)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 1M)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P450_DATIMENSILI.TIPO_RECORD IS
  'Tipo record: A=Automatico; M=Manuale';
COMMENT ON COLUMN P450_DATIMENSILI.COD_CAMPO IS
  'Codice interno del campo';
COMMENT ON COLUMN P450_DATIMENSILI.VARIAZIONE_CALCOLATA IS
  'Variazione retroattiva alla quantita'' specificata nel campo valore calcolata dal cedolino aperto';
COMMENT ON COLUMN P450_DATIMENSILI.VARIAZIONE_TOTALE IS
  'Variazione retroattiva totale della quantita'' specificata nel campo valore';

ALTER TABLE P450_DATIMENSILI ADD CONSTRAINT P450_FK_T030
  FOREIGN KEY (PROGRESSIVO) REFERENCES T030_ANAGRAFICO;

/*
Descrizione dati mensili
*/
CREATE TABLE P452_DATIMENSILIDESC (
  COD_CAMPO VARCHAR2(5),
  DESCRIZIONE VARCHAR2(40) NOT NULL,
  TIPO_DATO VARCHAR2(1) DEFAULT 'N' NOT NULL,
  NUMERO_DECIMALI NUMBER(1) DEFAULT 0,
  VALORI_PREVISTI VARCHAR2(255),
  ORIGINE VARCHAR2(1) DEFAULT 'A' NOT NULL,
  CONSTRAINT P452_PK PRIMARY KEY (COD_CAMPO)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 512K)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P452_DATIMENSILIDESC.TIPO_DATO IS
  'Tipo dato: N=Numerico; T=Testo';
COMMENT ON COLUMN P452_DATIMENSILIDESC.NUMERO_DECIMALI IS
  'Numero di cifre decimali. Richiesto solo se Tipo dato = N';
COMMENT ON COLUMN P452_DATIMENSILIDESC.VALORI_PREVISTI IS
  'Valori previsti per il testo (es. S,N). Richiesto solo se Tipo dato = T';
COMMENT ON COLUMN P452_DATIMENSILIDESC.ORIGINE IS
  'Origine: P=Precalcolo, A=Altro';

/*
Dati di setup del CUD
Integrità referenziali:
*/
CREATE TABLE P500_CUDSETUP (
  ANNO NUMBER(4),
  COD_VALUTA VARCHAR2(10),
  COD_FISCALE VARCHAR2(20),
  DENOMINAZIONE VARCHAR2(60),
  COMUNE VARCHAR2(40),
  PROVINCIA VARCHAR2(2),
  CAP VARCHAR2(5),
  INDIRIZZO VARCHAR2(60),
  TELEFONO_FAX VARCHAR2(40),
  E_MAIL VARCHAR2(40),
  MATRICOLA_INPS VARCHAR2(20),
  FIRMATARIO VARCHAR2(60),
  TIPO_FORNITORE VARCHAR2(2),
  CODICE_ATTIVITA VARCHAR2(5),
  TELEFONO VARCHAR2(12),
  FAX VARCHAR2(12),
  STATO_ENTE VARCHAR2(1),
  NATURA_GIURIDICA VARCHAR2(2),
  SITUAZIONE_ENTE VARCHAR2(1),
  COD_FISCALE_DICASTERO VARCHAR2(11),
  COD_FISCALE_FIRMA VARCHAR2(16),
  CODICE_CARICA_FIRMA VARCHAR2(2),
  COGNOME_FIRMA VARCHAR2(24),
  NOME_FIRMA VARCHAR2(20),
  SESSO_FIRMA VARCHAR2(1) DEFAULT 'M' NOT NULL,
  DATA_NASCITA_FIRMA DATE,
  COMUNE_NASCITA_FIRMA VARCHAR2(40),
  PROVINCIA_NASCITA_FIRMA VARCHAR2(2),
  COMUNE_RESIDENZA_FIRMA VARCHAR2(40),
  PROVINCIA_RESIDENZA_FIRMA VARCHAR2(2),
  CAP_RESIDENZA_FIRMA VARCHAR2(5),
  INDIRIZZO_FIRMA VARCHAR2(35),
  TELEFONO_FIRMA VARCHAR2(12),
  FIRMA_ORGANO_CONTROLLO VARCHAR2(1) DEFAULT '0' NOT NULL,
  CONSTRAINT P500_PK PRIMARY KEY (ANNO)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 512K)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P500_CUDSETUP.MATRICOLA_INPS IS
  'Matricola assegnata dall''INPS all''ente';
COMMENT ON COLUMN P500_CUDSETUP.FIRMA_ORGANO_CONTROLLO IS
  'Indica se prevista firma da parte di organi di controllo (S/N)';

/*
Regole per calcolo del CUD
Integrità referenziali:
*/
CREATE TABLE P502_CUDREGOLE (
  ANNO NUMBER(4),
  PARTE VARCHAR2(5),
  NUMERO VARCHAR2(3),
  DESCRIZIONE VARCHAR2(150),
  NUMERICO VARCHAR2(1) DEFAULT 'S',
  COD_ARROTONDAMENTO VARCHAR2(5),
  FORMATO VARCHAR2(11),
  OMETTI_VUOTO VARCHAR2(1) DEFAULT 'S',
  REGOLA_CALCOLO_AUTOMATICA VARCHAR2(1500),
  REGOLA_CALCOLO_MANUALE VARCHAR2(1500),
  REGOLA_MODIFICABILE VARCHAR2(1) DEFAULT 'N',
  COMMENTO VARCHAR2(300),
  CONSTRAINT P502_PK PRIMARY KEY (ANNO,PARTE,NUMERO)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 512K)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P502_CUDREGOLE.PARTE IS
  'Parte o sezione del CUD';
COMMENT ON COLUMN P502_CUDREGOLE.NUMERO IS
  'Numero del dato o codice interno';
COMMENT ON COLUMN P502_CUDREGOLE.NUMERICO IS
  'Dato numerico (S/N)';
COMMENT ON COLUMN P502_CUDREGOLE.COD_ARROTONDAMENTO IS
  'Codice arrotondamento. Richiesto solo se dato numerico';
COMMENT ON COLUMN P502_CUDREGOLE.FORMATO IS
  'Formato di stampa. Richiesto solo se dato numerico';
COMMENT ON COLUMN P502_CUDREGOLE.OMETTI_VUOTO IS
  'Ometti se dato non significativo';
COMMENT ON COLUMN P502_CUDREGOLE.REGOLA_CALCOLO_AUTOMATICA IS
  'Query per estrazione dato prevista di default';
COMMENT ON COLUMN P502_CUDREGOLE.REGOLA_CALCOLO_MANUALE IS
  'Query per estrazione dato modificata dall''utente';
COMMENT ON COLUMN P502_CUDREGOLE.REGOLA_MODIFICABILE IS
  'Query per estrazione dato modificabile dall''utente';

/*
Testata del CUD
Integrità referenziali:
*/
CREATE TABLE P504_CUDTESTATE (
  PROGRESSIVO NUMBER NOT NULL,
  ANNO NUMBER(4),
  DATA_EMISSIONE DATE DEFAULT NULL,
  ID_CUD NUMBER,
  CHIUSO VARCHAR2(1) DEFAULT 'N',
  ANNOTAZIONI LONG,
  DATA_CHIUSURA DATE DEFAULT NULL,
  DATA_CONSEGNA DATE DEFAULT NULL,
  ANNO_REGOLE NUMBER(4) NOT NULL,
  CONSTRAINT P504_PK PRIMARY KEY (ID_CUD)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 512K)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P504_CUDTESTATE.CHIUSO IS
  'Chiuso (S/N)';
COMMENT ON COLUMN P504_CUDTESTATE.DATA_CHIUSURA IS
  'Data chiusura del CUD: impostata alla data del sistema';
COMMENT ON COLUMN P504_CUDTESTATE.DATA_CONSEGNA IS
  'Data consegna al dipendente';
COMMENT ON COLUMN P504_CUDTESTATE.ANNO_REGOLE IS
  'Anno delle regole utilizzate';

/*
Dati del CUD
Integrità referenziali: P504_CUDTESTATE
*/
CREATE TABLE P505_CUDDATI (
  ID_CUD NUMBER,
  PARTE VARCHAR2(5),
  NUMERO VARCHAR2(3),
  PROGRESSIVO_NUMERO NUMBER DEFAULT 1,
  TIPO_RECORD VARCHAR2(1),
  VALORE VARCHAR2(40),
  CONSTRAINT P505_PK PRIMARY KEY (ID_CUD,PARTE,NUMERO,PROGRESSIVO_NUMERO,TIPO_RECORD)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 512K)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P505_CUDDATI.PARTE IS
  'Parte o sezione del CUD';
COMMENT ON COLUMN P505_CUDDATI.NUMERO IS
  'Numero del dato o codice interno';
COMMENT ON COLUMN P505_CUDDATI.PROGRESSIVO_NUMERO IS
  'Progressivo per i campi molteplici';
COMMENT ON COLUMN P505_CUDDATI.TIPO_RECORD IS
  'Tipo record: A=Automatico; M=Manuale';

ALTER TABLE P505_CUDDATI ADD CONSTRAINT P505_FK_P504
  FOREIGN KEY (ID_CUD) REFERENCES P504_CUDTESTATE ON DELETE CASCADE;

CREATE SEQUENCE P505_ID_CUD
  MINVALUE 1
  NOMAXVALUE
  INCREMENT BY 1
  NOORDER
  NOCACHE;

/*
Regole per calcolo del 770
Integrità referenziali:
*/
CREATE TABLE P602_770REGOLE (
  ANNO NUMBER(4),
  PARTE VARCHAR2(5),
  NUMERO VARCHAR2(3),
  TIPO_RECORD VARCHAR2(1),
  SEZIONE_FILE VARCHAR2(2),
  FORMATO_FILE VARCHAR2(5),
  PARTE_CUD VARCHAR2(5),
  NUMERO_CUD VARCHAR2(3),
  DESCRIZIONE VARCHAR2(150),
  NUMERICO VARCHAR2(1) DEFAULT 'S',
  COD_ARROTONDAMENTO VARCHAR2(5),
  FORMATO VARCHAR2(11),
  OMETTI_VUOTO VARCHAR2(1) DEFAULT 'S',
  REGOLA_CALCOLO_AUTOMATICA VARCHAR2(1500),
  REGOLA_CALCOLO_MANUALE VARCHAR2(1500),
  REGOLA_MODIFICABILE VARCHAR2(1) DEFAULT 'N',
  COMMENTO VARCHAR2(300),
  FORMATO_ANNOMESE VARCHAR2(1) DEFAULT 'N' NOT NULL,
  CONSTRAINT P602_PK PRIMARY KEY (ANNO,PARTE,NUMERO)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 512K)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P602_770REGOLE.PARTE IS
  'Parte o sezione del 770';
COMMENT ON COLUMN P602_770REGOLE.NUMERO IS
  'Numero del dato o codice interno';
COMMENT ON COLUMN P602_770REGOLE.TIPO_RECORD IS
  'Tipo record del file di esportazione, valori ammessi: A,B,E,F,G,H,Z';
COMMENT ON COLUMN P602_770REGOLE.SEZIONE_FILE IS
  'Sezione sul file di esportazione, es.: ST,SX DA,DB,DC,DD AU';
COMMENT ON COLUMN P602_770REGOLE.FORMATO_FILE IS
  'Formato dati per il file di esportazione';
COMMENT ON COLUMN P602_770REGOLE.PARTE_CUD IS
  'Parte o sezione del CUD collegata';
COMMENT ON COLUMN P602_770REGOLE.NUMERO_CUD IS
  'Numero del dato o codice interno del CUD collegato';
COMMENT ON COLUMN P602_770REGOLE.NUMERICO IS
  'Dato numerico (S/N)';
COMMENT ON COLUMN P602_770REGOLE.COD_ARROTONDAMENTO IS
  'Codice arrotondamento. Richiesto solo se dato numerico';
COMMENT ON COLUMN P602_770REGOLE.FORMATO IS
  'Formato di stampa. Richiesto solo se dato numerico';
COMMENT ON COLUMN P602_770REGOLE.OMETTI_VUOTO IS
  'Ometti se dato non significativo';
COMMENT ON COLUMN P602_770REGOLE.REGOLA_CALCOLO_AUTOMATICA IS
  'Query per estrazione dato prevista di default';
COMMENT ON COLUMN P602_770REGOLE.REGOLA_CALCOLO_MANUALE IS
  'Query per estrazione dato modificata dall''utente';
COMMENT ON COLUMN P602_770REGOLE.REGOLA_MODIFICABILE IS
  'Query per estrazione dato modificabile dall''utente';
COMMENT ON COLUMN P602_770REGOLE.FORMATO_ANNOMESE IS
  'Indica se il campo prevede la sdoppiatura del dato anno/mese su due record (S/N)';

/*
Testata del 770
Integrità referenziali:
*/
CREATE TABLE P604_770TESTATE (
  ANNO NUMBER(4),
  DATA_EMISSIONE DATE DEFAULT NULL,
  ID_770 NUMBER,
  CHIUSO VARCHAR2(1) DEFAULT 'N',
  DATA_CHIUSURA DATE DEFAULT NULL,
  CONSTRAINT P604_PK PRIMARY KEY (ID_770)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 512K)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P604_770TESTATE.CHIUSO IS
  'Chiuso (S/N)';
COMMENT ON COLUMN P604_770TESTATE.DATA_CHIUSURA IS
  'Data chiusura del 770: impostata alla data del sistema';

/*
Dati del 770 individuali
Integrità referenziali: P604_770TESTATE
*/
CREATE TABLE P605_770DATIINDIVIDUALI (
  ID_770 NUMBER,
  PROGRESSIVO NUMBER NOT NULL,
  PARTE VARCHAR2(5),
  NUMERO VARCHAR2(3),
  PROGRESSIVO_NUMERO NUMBER DEFAULT 1,
  TIPO_RECORD VARCHAR2(1),
  VALORE VARCHAR2(40),
  CONSTRAINT P605_PK PRIMARY KEY (ID_770,PROGRESSIVO,PARTE,NUMERO,PROGRESSIVO_NUMERO,TIPO_RECORD)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 512K)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P605_770DATIINDIVIDUALI.PARTE IS
  'Parte o sezione del 770';
COMMENT ON COLUMN P605_770DATIINDIVIDUALI.NUMERO IS
  'Numero del dato o codice interno';
COMMENT ON COLUMN P605_770DATIINDIVIDUALI.PROGRESSIVO_NUMERO IS
  'Progressivo per i campi molteplici';
COMMENT ON COLUMN P605_770DATIINDIVIDUALI.TIPO_RECORD IS
  'Tipo record: A=Automatico; M=Manuale';

ALTER TABLE P605_770DATIINDIVIDUALI ADD CONSTRAINT P605_FK_P604
  FOREIGN KEY (ID_770) REFERENCES P604_770TESTATE ON DELETE CASCADE;

CREATE SEQUENCE P605_ID_770
  MINVALUE 1
  NOMAXVALUE
  INCREMENT BY 1
  NOORDER
  NOCACHE;

/*
Regole per calcolo della fornitura mensile all'INPDAP
Integrità referenziali:
*/
CREATE TABLE P652_INPDAPMMREGOLE (
  DECORRENZA DATE,
  PARTE VARCHAR2(5),
  NUMERO VARCHAR2(3),
  TIPO_RECORD VARCHAR2(1),
  SEZIONE_FILE VARCHAR2(2),
  NUMERO_FILE VARCHAR2(3),
  FORMATO_FILE VARCHAR2(5),
  DESCRIZIONE VARCHAR2(150),
  NUMERICO VARCHAR2(1) DEFAULT 'S',
  COD_ARROTONDAMENTO VARCHAR2(5),
  FORMATO VARCHAR2(11),
  OMETTI_VUOTO VARCHAR2(1) DEFAULT 'S',
  COMMENTO VARCHAR2(300),
  FORMATO_ANNOMESE VARCHAR2(1) DEFAULT 'N' NOT NULL,
  CONSTRAINT P652_PK PRIMARY KEY (DECORRENZA,PARTE,NUMERO)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 512K)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P652_INPDAPMMREGOLE.PARTE IS
  'Parte o sezione del CUD';
COMMENT ON COLUMN P652_INPDAPMMREGOLE.NUMERO IS
  'Numero del dato o codice interno del CUD';
COMMENT ON COLUMN P652_INPDAPMMREGOLE.TIPO_RECORD IS
  'Tipo record del file di esportazione, valori ammessi: A,B,E,F,G,H,Z';
COMMENT ON COLUMN P652_INPDAPMMREGOLE.SEZIONE_FILE IS
  'Sezione sul file di esportazione, es.: ST,SX DA,DB,DC,DD AU';
COMMENT ON COLUMN P652_INPDAPMMREGOLE.NUMERO_FILE IS
  'Numero sul file di esportazione';
COMMENT ON COLUMN P652_INPDAPMMREGOLE.FORMATO_FILE IS
  'Formato dati per il file di esportazione';
COMMENT ON COLUMN P652_INPDAPMMREGOLE.NUMERICO IS
  'Dato numerico (S/N)';
COMMENT ON COLUMN P652_INPDAPMMREGOLE.COD_ARROTONDAMENTO IS
  'Codice arrotondamento. Richiesto solo se dato numerico';
COMMENT ON COLUMN P652_INPDAPMMREGOLE.FORMATO IS
  'Formato di stampa. Richiesto solo se dato numerico';
COMMENT ON COLUMN P652_INPDAPMMREGOLE.OMETTI_VUOTO IS
  'Ometti se dato non significativo';
COMMENT ON COLUMN P652_INPDAPMMREGOLE.FORMATO_ANNOMESE IS
  'Indica se il campo prevede la sdoppiatura del dato anno/mese su due record (S/N)';

/*
Testata della fornitura mensile all'INPDAP
Integrità referenziali:
*/
CREATE TABLE P654_INPDAPMMTESTATE (
  DATA_FINE_PERIODO DATE NOT NULL,
  ID_INPDAPMM NUMBER,
  CHIUSO VARCHAR2(1) DEFAULT 'N',
  DATA_CHIUSURA DATE DEFAULT NULL,
  CONSTRAINT P654_PK PRIMARY KEY (ID_INPDAPMM)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 512K)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P654_INPDAPMMTESTATE.DATA_FINE_PERIODO IS
  'Anno e mese di fine periodo elaborato';
COMMENT ON COLUMN P654_INPDAPMMTESTATE.CHIUSO IS
  'Chiuso (S/N)';
COMMENT ON COLUMN P654_INPDAPMMTESTATE.DATA_CHIUSURA IS
  'Data chiusura della fornitura mensile all''INPDAP: impostata alla data del sistema';

/*
Dati della fornitura mensile all'INPDAP
Integrità referenziali: P654_INPDAPMMTESTATE
*/
CREATE TABLE P655_INPDAPMMDATIINDIVIDUALI (
  ID_INPDAPMM NUMBER,
  PROGRESSIVO NUMBER NOT NULL,
  PARTE VARCHAR2(5),
  NUMERO VARCHAR2(3),
  PROGRESSIVO_NUMERO NUMBER DEFAULT 1,
  TIPO_RECORD VARCHAR2(1),
  VALORE VARCHAR2(40),
  CONSTRAINT P655_PK PRIMARY KEY (ID_INPDAPMM,PROGRESSIVO,PARTE,NUMERO,PROGRESSIVO_NUMERO,TIPO_RECORD)
  USING INDEX STORAGE (pctincrease 0 initial 16K next 512K)
  TABLESPACE INDICI pctfree 10
)
STORAGE (pctincrease 0 initial 16K next 512K)
TABLESPACE LAVORO pctfree 10 pctused 40;

COMMENT ON COLUMN P655_INPDAPMMDATIINDIVIDUALI.PARTE IS
  'Parte o sezione del CUD';
COMMENT ON COLUMN P655_INPDAPMMDATIINDIVIDUALI.NUMERO IS
  'Numero del dato o codice interno del CUD';
COMMENT ON COLUMN P655_INPDAPMMDATIINDIVIDUALI.PROGRESSIVO_NUMERO IS
  'Progressivo per i campi molteplici';
COMMENT ON COLUMN P655_INPDAPMMDATIINDIVIDUALI.TIPO_RECORD IS
  'Tipo record: A=Automatico; M=Manuale';

ALTER TABLE P655_INPDAPMMDATIINDIVIDUALI ADD CONSTRAINT P655_FK_P654
  FOREIGN KEY (ID_INPDAPMM) REFERENCES P654_INPDAPMMTESTATE ON DELETE CASCADE;

CREATE SEQUENCE P655_ID_INPDAPMM
  MINVALUE 1
  NOMAXVALUE
  INCREMENT BY 1
  NOORDER
  NOCACHE;
