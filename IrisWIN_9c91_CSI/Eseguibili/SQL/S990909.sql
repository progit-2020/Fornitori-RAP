DELETE FROM I091_DATIENTE WHERE TIPO IN ('C6_INDENNITATURNO','C8_INDSPEC');

ALTER TABLE T033_LAYOUT ADD CAMPODB VARCHAR2(20);

ALTER TABLE T080_PIANIFORARI MODIFY INDPRESENZA VARCHAR2(5);

ALTER TABLE T161_INDGRUPPO MODIFY INDENNITA VARCHAR2(5);

ALTER TABLE T160_INDPRESENZA DROP CONSTRAINT T160_PK;

CREATE TABLE T160_PROFILIINDENNITA (
  CODICE VARCHAR2(5),
  INDENNITA VARCHAR2(5),
  CONSTRAINT T160_PK PRIMARY KEY (CODICE,INDENNITA) USING INDEX TABLESPACE INDICI
) TABLESPACE LAVORO;

CREATE TABLE T162_INDENNITA (
  CODICE VARCHAR2(5),
  DESCRIZIONE VARCHAR2(40),
  IMPORTO NUMBER,
  VOCEPAGHE VARCHAR2(6),
  TIPO VARCHAR2(1),
  NUMTURNI NUMBER,
  TURNI VARCHAR2(4),
  ASSENZE VARCHAR2(200),
  CODICE2 VARCHAR2(5),
  CONSTRAINT T162_PK PRIMARY KEY (CODICE) USING INDEX TABLESPACE INDICI
) TABLESPACE LAVORO;

INSERT INTO T162_INDENNITA (CODICE,DESCRIZIONE,IMPORTO,VOCEPAGHE,TIPO)
  SELECT CODICE,DESCRIZIONE,IMPORTO,CODPAGHE,'Z'
  FROM T160_INDPRESENZA WHERE CODIND1 IS NULL;

INSERT INTO T162_INDENNITA (CODICE,IMPORTO,VOCEPAGHE,TIPO,NUMTURNI)
  SELECT CODICE,IMPORTO,VOCEPAGHE,'V',NG
  FROM T165_INDSPECIALI;

INSERT INTO T162_INDENNITA
  (CODICE,IMPORTO,VOCEPAGHE,TIPO,NUMTURNI,TURNI,ASSENZE,CODICE2)
  SELECT CODICE,IMPORTO,VOCEPAGHE,TIPO,NUMTURNI,TURNI,ASSENZE,CODICE2
  FROM T170_INDTURNO;

CREATE TABLE T163_CODICIINDENNITA (
  CODICE VARCHAR2(5),
  DESCRIZIONE VARCHAR2(40),
  CONSTRAINT T163_PK PRIMARY KEY(CODICE) USING INDEX TABLESPACE INDICI
) TABLESPACE LAVORO;

INSERT INTO T160_PROFILIINDENNITA (CODICE,INDENNITA)
  SELECT CODICE,CODIND1 FROM T160_INDPRESENZA WHERE CODIND1 IS NOT NULL;
INSERT INTO T160_PROFILIINDENNITA (CODICE,INDENNITA)
  SELECT CODICE,CODIND2 FROM T160_INDPRESENZA WHERE CODIND2 IS NOT NULL;
INSERT INTO T160_PROFILIINDENNITA (CODICE,INDENNITA)
  SELECT CODICE,CODIND3 FROM T160_INDPRESENZA WHERE CODIND3 IS NOT NULL;
INSERT INTO T160_PROFILIINDENNITA (CODICE,INDENNITA)
  SELECT CODICE,CODIND4 FROM T160_INDPRESENZA WHERE CODIND4 IS NOT NULL;
INSERT INTO T160_PROFILIINDENNITA (CODICE,INDENNITA)
  SELECT CODICE,CODIND5 FROM T160_INDPRESENZA WHERE CODIND5 IS NOT NULL;
INSERT INTO T160_PROFILIINDENNITA (CODICE,INDENNITA)
  SELECT CODICE,CODICE FROM T160_INDPRESENZA 
  WHERE CODIND1 IS NULL AND CODIND2 IS NULL AND CODIND3 IS NULL AND CODIND4 IS NULL AND CODIND5 IS NULL;
INSERT INTO T163_CODICIINDENNITA (CODICE,DESCRIZIONE)
  SELECT CODICE,DESCRIZIONE FROM T160_INDPRESENZA;

INSERT INTO T072_SCHEDAINDPRES (PROGRESSIVO,DATA,CODINDPRES,INDPRES)
  SELECT PROGRESSIVO,DATA,CODINDTURNO,LTRIM(TO_CHAR(NUMINDTURNO,'90.9'))
  FROM T070_SCHEDARIEPIL
  WHERE CODINDTURNO IS NOT NULL AND NUMINDTURNO > 0;

UPDATE T020_ORARI SET FLAGPRES = 'N' WHERE LTRIM(FLAGPRES) IS NULL AND MMINDPRES IS NULL;
UPDATE T020_ORARI SET FLAGPRES = NULL WHERE MMINDPRES IS NOT NULL;

ALTER TABLE T080_PIANIFORARI ADD TURNO1EU VARCHAR2(1);
ALTER TABLE T080_PIANIFORARI ADD TURNO2EU VARCHAR2(1);

ALTER TABLE T081_PROVVISORIO ADD TURNO1EU VARCHAR2(1);
ALTER TABLE T081_PROVVISORIO ADD TURNO2EU VARCHAR2(1);

ALTER TABLE T611_CICLIGIORNALIERI ADD TURNO1EU VARCHAR2(1);
ALTER TABLE T611_CICLIGIORNALIERI ADD TURNO2EU VARCHAR2(1);

UPDATE T020_ORARI SET INDPRESSTR = '2' WHERE INDPRESSTR = '0';
UPDATE T020_ORARI SET INDPRESSTR = '0' WHERE INDPRESSTR IN ('S','1');
UPDATE T020_ORARI SET INDPRESSTR = '1' WHERE INDPRESSTR = 'N';

UPDATE T020_ORARI SET INDFESTSTR = '2' WHERE INDFESTSTR = '0';
UPDATE T020_ORARI SET INDFESTSTR = '0' WHERE INDFESTSTR IN ('S','1');
UPDATE T020_ORARI SET INDFESTSTR = '1' WHERE INDFESTSTR = 'N';

UPDATE T020_ORARI SET INDNOTSTR = '2' WHERE INDNOTSTR = '0';
UPDATE T020_ORARI SET INDNOTSTR = '0' WHERE INDNOTSTR IN ('S','1');
UPDATE T020_ORARI SET INDNOTSTR = '1' WHERE INDNOTSTR = 'N';

CREATE TABLE T110_ORALEGALESOLARE (
  DATA DATE,
  ORAVECCHIA VARCHAR2(5),
  ORANUOVA VARCHAR2(5),
  CONSTRAINT T110_PK PRIMARY KEY (DATA) USING INDEX TABLESPACE INDICI
)
TABLESPACE LAVORO;

ALTER TABLE T430_STORICO ADD STRAORDEU2 VARCHAR2(1);
UPDATE T430_STORICO SET STRAORDEU2 = STRAORDEU;

UPDATE I500_DATILIBERI SET PROGRESSIVO = PROGRESSIVO + 1;
UPDATE T431_DATISTORICI SET CODICE = CODICE + 1 WHERE CODICE >= 42;
INSERT INTO T431_DATISTORICI VALUES (42,'Str.uscite prec.');
UPDATE T431_DATISTORICI SET DESCRIZIONE = 'Str.prima entrata' WHERE CODICE = 13;
UPDATE T431_DATISTORICI SET DESCRIZIONE = 'Str.ultima uscita' WHERE CODICE = 14;
UPDATE T431_DATISTORICI SET DESCRIZIONE = 'Str.entrate succ.' WHERE CODICE = 15;
DELETE FROM T033_LAYOUT WHERE NUMCOMP IN (25,26,27);
UPDATE T033_LAYOUT SET NUMCOMP = NUMCOMP + 1 WHERE NUMCOMP >=28;

