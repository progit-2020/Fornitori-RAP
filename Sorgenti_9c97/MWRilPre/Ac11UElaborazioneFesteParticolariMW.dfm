inherited Ac11FElaborazioneFesteParticolariMW: TAc11FElaborazioneFesteParticolariMW
  OldCreateOrder = True
  OnDestroy = DataModuleDestroy
  Height = 304
  Width = 345
  object selListaFeste: TOracleDataSet
    SQL.Strings = (
      'select distinct TIPO_FESTIVITA, DATA_FESTIVITA'
      'from CSI010_FESTIVITA_PARTICOLARI'
      'where to_char(DATA_FESTIVITA,'#39'YYYY'#39') = :ANNO'
      'and PROGRESSIVO = -1'
      'order by DATA_FESTIVITA, TIPO_FESTIVITA')
    Optimize = False
    Variables.Data = {
      04000000010000000A0000003A0041004E004E004F0005000000000000000000
      0000}
    Left = 32
    Top = 16
  end
  object selTipiFesta: TOracleDataSet
    SQL.Strings = (
      'select '#39'A'#39' CODICE, '#39'Santo Patrono'#39' DESCRIZIONE'
      'from DUAL'
      'union'
      'SELECT '#39'B'#39' CODICE, '#39'Ex-festivita'#39#39#39' DESCRIZIONE'
      'from DUAL'
      'union'
      'select '#39'C'#39' CODICE, '#39'Festivita'#39#39' in giorno di riposo'#39' DESCRIZIONE'
      'from DUAL'
      'order by CODICE')
    Optimize = False
    Left = 96
    Top = 16
    object selTipiFestaCODICE: TStringField
      DisplayWidth = 7
      FieldName = 'CODICE'
      Size = 5
    end
    object selTipiFestaDESCRIZIONE: TStringField
      DisplayWidth = 50
      FieldName = 'DESCRIZIONE'
      Size = 40
    end
  end
  object delaCSI010: TOracleQuery
    SQL.Strings = (
      'delete CSI010_FESTIVITA_PARTICOLARI'
      'where TIPO_FESTIVITA = :TIPO_FESTIVITA'
      'and DATA_FESTIVITA = :DATA_FESTIVITA'
      'and TIPO_RECORD = :TIPO_RECORD'
      'and PROGRESSIVO <> -1'
      'and PROGRESSIVO = NVL(:PROGRESSIVO,PROGRESSIVO)')
    Optimize = False
    Variables.Data = {
      04000000040000001E0000003A005400490050004F005F004600450053005400
      490056004900540041000500000000000000000000001E0000003A0044004100
      540041005F004600450053005400490056004900540041000C00000000000000
      00000000180000003A005400490050004F005F005200450043004F0052004400
      050000000000000000000000180000003A00500052004F004700520045005300
      5300490056004F00030000000000000000000000}
    Left = 32
    Top = 184
  end
  object selRegoleFesta: TOracleDataSet
    SQL.Strings = (
      'select *'
      'from CSI010_FESTIVITA_PARTICOLARI'
      'where TIPO_FESTIVITA = :TIPO_FESTIVITA'
      'and DATA_FESTIVITA = :DATA_FESTIVITA'
      'and PROGRESSIVO = -1'
      'and FILTRO_ANAGRA = NVL(:FILTRO_ANAGRA,FILTRO_ANAGRA)'
      'order by FILTRO_ANAGRA')
    Optimize = False
    Variables.Data = {
      04000000030000001E0000003A005400490050004F005F004600450053005400
      490056004900540041000500000000000000000000001E0000003A0044004100
      540041005F004600450053005400490056004900540041000C00000000000000
      000000001C0000003A00460049004C00540052004F005F0041004E0041004700
      52004100050000000000000000000000}
    Left = 32
    Top = 72
  end
  object selDettIndFesta: TOracleDataSet
    SQL.Strings = (
      'select CSI010.*, CSI010.rowid'
      'from CSI010_FESTIVITA_PARTICOLARI CSI010'
      'where TIPO_FESTIVITA = :TIPO_FESTIVITA'
      'and DATA_FESTIVITA = NVL(:DATA_FESTIVITA,DATA_FESTIVITA)'
      'and TIPO_RECORD = NVL(:TIPO_RECORD,TIPO_RECORD)'
      'and PROGRESSIVO <> -1'
      'and PROGRESSIVO = NVL(:PROGRESSIVO,PROGRESSIVO)'
      ':CONDIZIONE'
      'order by DATA_FESTIVITA, PROGRESSIVO, TIPO_RECORD')
    Optimize = False
    Variables.Data = {
      04000000050000001E0000003A005400490050004F005F004600450053005400
      490056004900540041000500000000000000000000001E0000003A0044004100
      540041005F004600450053005400490056004900540041000C00000000000000
      00000000180000003A005400490050004F005F005200450043004F0052004400
      050000000000000000000000180000003A00500052004F004700520045005300
      5300490056004F00030000000000000000000000160000003A0043004F004E00
      440049005A0049004F004E004500010000000000000000000000}
    Left = 32
    Top = 128
  end
  object selaV430: TOracleDataSet
    SQL.Strings = (
      'select T030.PROGRESSIVO, T430TGESTIONE'
      'from :QVistaOracle'
      'and :filtro')
    ReadBuffer = 5000
    Optimize = False
    Variables.Data = {
      04000000030000000E0000003A00460049004C00540052004F00010000000000
      0000000000001A0000003A005100560049005300540041004F00520041004300
      4C004500010000000000000000000000160000003A0044004100540041004C00
      410056004F0052004F000C0000000000000000000000}
    QBEDefinition.QBEFieldDefs = {
      050000000500000016000000500052004F004700520045005300530049005600
      4F00010000000000120000004D00410054005200490043004F004C0041000100
      000000000E00000043004F0047004E004F004D00450001000000000008000000
      4E004F004D004500010000000000140000004700470053004500520056004900
      5A0049004F00010000000000}
    Left = 160
    Top = 16
  end
  object insaCSI010: TOracleQuery
    SQL.Strings = (
      'insert into CSI010_FESTIVITA_PARTICOLARI'
      
        '(progressivo, data_festivita, tipo_festivita, filtro_anagra, tip' +
        'o_record, condizione_applic, inizio_scelta, fine_scelta, '
      ' flag_scelta, scelte_possibili, scelta_effettuata, data_scelta, '
      
        ' comp_noscelta, caus_insert, caus_incomp, caus_sostit, comp_caus' +
        'sost, scelta_definitiva)'
      
        'select :PROGRESSIVO_INS, data_festivita, tipo_festivita, filtro_' +
        'anagra, :TIPO_RECORD, condizione_applic, inizio_scelta, fine_sce' +
        'lta, '
      
        ' DECODE(:APP,'#39'S'#39',flag_scelta,:FLAG_SCELTA), DECODE(:APP,'#39'S'#39',scel' +
        'te_possibili,:SCELTE_POSSIBILI), scelta_effettuata, data_scelta,' +
        ' '
      
        ' DECODE(:APP,'#39'S'#39',comp_noscelta,:COMP_NOSCELTA), caus_insert, cau' +
        's_incomp, caus_sostit, comp_caussost, scelta_definitiva'
      'from CSI010_FESTIVITA_PARTICOLARI CSI010'
      'where TIPO_FESTIVITA = :TIPO_FESTIVITA'
      'and DATA_FESTIVITA = :DATA_FESTIVITA'
      'and TIPO_RECORD = '#39'A'#39
      'and PROGRESSIVO = :PROGRESSIVO_BASE'
      'and FILTRO_ANAGRA = :FILTRO_ANAGRA')
    Optimize = False
    Variables.Data = {
      040000000A0000001E0000003A005400490050004F005F004600450053005400
      490056004900540041000500000000000000000000001E0000003A0044004100
      540041005F004600450053005400490056004900540041000C00000000000000
      00000000200000003A00500052004F0047005200450053005300490056004F00
      5F0049004E005300030000000000000000000000080000003A00410050005000
      050000000000000000000000220000003A00500052004F004700520045005300
      5300490056004F005F0042004100530045000300000000000000000000001800
      00003A005400490050004F005F005200450043004F0052004400050000000000
      0000000000001C0000003A00460049004C00540052004F005F0041004E004100
      470052004100050000000000000000000000180000003A0046004C0041004700
      5F005300430045004C0054004100050000000000000000000000220000003A00
      5300430045004C00540045005F0050004F00530053004900420049004C004900
      0500000000000000000000001C0000003A0043004F004D0050005F004E004F00
      5300430045004C0054004100050000000000000000000000}
    Left = 96
    Top = 184
  end
  object insbCSI010: TOracleQuery
    SQL.Strings = (
      'insert into CSI010_FESTIVITA_PARTICOLARI'
      
        '(progressivo, data_festivita, tipo_festivita, filtro_anagra, tip' +
        'o_record, condizione_applic, inizio_scelta, fine_scelta, '
      
        ' flag_scelta, scelte_possibili, scelta_effettuata, data_scelta, ' +
        'comp_noscelta, caus_insert, caus_incomp, caus_sostit, comp_causs' +
        'ost, scelta_definitiva)'
      
        'select progressivo, data_festivita, tipo_festivita, filtro_anagr' +
        'a, '#39'M'#39' /*tipo_record*/, condizione_applic, inizio_scelta, fine_s' +
        'celta, '
      
        ' flag_scelta, scelte_possibili, scelta_effettuata, data_scelta, ' +
        'comp_noscelta, caus_insert, caus_incomp, caus_sostit, comp_causs' +
        'ost, scelta_definitiva'
      'from CSI010_FESTIVITA_PARTICOLARI CSI010'
      'where TIPO_FESTIVITA = :TIPO_FESTIVITA'
      'and DATA_FESTIVITA = :DATA_FESTIVITA'
      'and TIPO_RECORD = '#39'A'#39
      'and PROGRESSIVO <> -1'
      'and not exists (select 1 '
      '                from CSI010_FESTIVITA_PARTICOLARI'
      '                where TIPO_FESTIVITA = CSI010.TIPO_FESTIVITA'
      '                and DATA_FESTIVITA = CSI010.DATA_FESTIVITA'
      '                and TIPO_RECORD <> CSI010.TIPO_RECORD'
      '                and PROGRESSIVO = CSI010.PROGRESSIVO)')
    Optimize = False
    Variables.Data = {
      04000000020000001E0000003A005400490050004F005F004600450053005400
      490056004900540041000500000000000000000000001E0000003A0044004100
      540041005F004600450053005400490056004900540041000C00000000000000
      00000000}
    Left = 96
    Top = 240
  end
  object delbCSI010: TOracleQuery
    SQL.Strings = (
      'delete CSI010_FESTIVITA_PARTICOLARI CSI010'
      'where TIPO_FESTIVITA = :TIPO_FESTIVITA'
      'and DATA_FESTIVITA = :DATA_FESTIVITA'
      'and TIPO_RECORD = '#39'M'#39
      'and PROGRESSIVO <> -1'
      'and not exists (select 1 '
      '                from CSI010_FESTIVITA_PARTICOLARI'
      '                where TIPO_FESTIVITA = CSI010.TIPO_FESTIVITA'
      '                and DATA_FESTIVITA = CSI010.DATA_FESTIVITA'
      '                and TIPO_RECORD <> CSI010.TIPO_RECORD'
      '                and PROGRESSIVO = CSI010.PROGRESSIVO)')
    Optimize = False
    Variables.Data = {
      04000000020000001E0000003A005400490050004F005F004600450053005400
      490056004900540041000500000000000000000000001E0000003A0044004100
      540041005F004600450053005400490056004900540041000C00000000000000
      00000000}
    Left = 32
    Top = 240
  end
  object selGgLav: TOracleQuery
    SQL.Strings = (
      'begin'
      '  :GgLav:=T010F_GGLAVORATIVO(:Progressivo,:Data);'
      'end;')
    Optimize = False
    Variables.Data = {
      0400000003000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000C0000003A00470047004C0041005600
      0500000000000000000000000A0000003A0044004100540041000C0000000000
      000000000000}
    Left = 120
    Top = 72
  end
  object updaCSI010: TOracleQuery
    SQL.Strings = (
      'update CSI010_FESTIVITA_PARTICOLARI CSI010a'
      'set filtro_anagra = (select filtro_anagra '
      '                     from CSI010_FESTIVITA_PARTICOLARI CSI010b'
      
        '                     where CSI010b.PROGRESSIVO = CSI010a.PROGRES' +
        'SIVO'
      
        '                     and CSI010b.TIPO_FESTIVITA = CSI010a.TIPO_F' +
        'ESTIVITA'
      
        '                     and CSI010b.DATA_FESTIVITA = CSI010a.DATA_F' +
        'ESTIVITA'
      
        '                     and CSI010b.TIPO_RECORD <> CSI010a.TIPO_REC' +
        'ORD)'
      'where TIPO_FESTIVITA = :TIPO_FESTIVITA'
      'and DATA_FESTIVITA = :DATA_FESTIVITA'
      'and TIPO_RECORD = '#39'M'#39
      'and PROGRESSIVO <> -1')
    Optimize = False
    Variables.Data = {
      04000000020000001E0000003A005400490050004F005F004600450053005400
      490056004900540041000500000000000000000000001E0000003A0044004100
      540041005F004600450053005400490056004900540041000C00000000000000
      00000000}
    Left = 160
    Top = 184
  end
  object selT100: TOracleDataSet
    SQL.Strings = (
      'SELECT T100.PROGRESSIVO,COUNT(*) N_TIMB'
      'FROM T100_TIMBRATURE T100,'
      '    (SELECT PROGRESSIVO,COUNT(*) N_TIMB'
      '    FROM T100_TIMBRATURE '
      '    WHERE PROGRESSIVO IN (SELECT PROGRESSIVO '
      '                          FROM CSI010_FESTIVITA_PARTICOLARI'
      '                          WHERE DATA_FESTIVITA = :DATA_FESTIVITA'
      '                          AND TIPO_FESTIVITA = :TIPO_FESTIVITA'
      '                          AND TIPO_RECORD = '#39'M'#39')'
      '    AND DATA = :DATA_FESTIVITA'
      '    AND FLAG IN ('#39'O'#39','#39'I'#39')'
      '    GROUP BY PROGRESSIVO) A'
      'WHERE T100.PROGRESSIVO = A.PROGRESSIVO'
      'AND T100.DATA = :DATA_FESTIVITA'
      'AND T100.FLAG IN ('#39'O'#39','#39'I'#39')'
      'AND (A.N_TIMB > 1 '
      '     OR T100.VERSO = '#39'E'#39
      '     OR NOT EXISTS (SELECT 1 FROM T100_TIMBRATURE B'
      '                    WHERE B.PROGRESSIVO = T100.PROGRESSIVO'
      '                    AND B.DATA = T100.DATA - 1'
      '                    AND B.FLAG IN ('#39'O'#39','#39'I'#39')'
      '                    AND B.ORA = (SELECT MAX(ORA)'
      '                                 FROM T100_TIMBRATURE C'
      
        '                                 WHERE C.PROGRESSIVO = B.PROGRES' +
        'SIVO'
      '                                 AND C.DATA = B.DATA'
      '                                 AND C.FLAG IN ('#39'O'#39','#39'I'#39'))'
      '                    AND B.VERSO = '#39'E'#39'))'
      'GROUP BY T100.PROGRESSIVO'
      'ORDER BY T100.PROGRESSIVO')
    ReadBuffer = 100
    Optimize = False
    Variables.Data = {
      04000000020000001E0000003A0044004100540041005F004600450053005400
      490056004900540041000C00000000000000000000001E0000003A0054004900
      50004F005F004600450053005400490056004900540041000500000000000000
      00000000}
    Left = 288
    Top = 16
  end
  object selT040: TOracleDataSet
    SQL.Strings = (
      
        'SELECT PROGRESSIVO, DATA, CAUSALE, TIPOGIUST, TO_CHAR(DAORE,'#39'HH2' +
        '4.MI'#39') DAORE, TO_CHAR(AORE,'#39'HH24.MI'#39') AORE, T265.ESCLUSIONE, T26' +
        '0.CODINTERNO'
      
        'FROM T040_GIUSTIFICATIVI T040, T265_CAUASSENZE T265, T260_RAGGRA' +
        'SSENZE T260'
      'WHERE PROGRESSIVO IN (SELECT PROGRESSIVO '
      '                      FROM CSI010_FESTIVITA_PARTICOLARI'
      '                      WHERE DATA_FESTIVITA = :DATA_FESTIVITA'
      '                      AND TIPO_FESTIVITA = :TIPO_FESTIVITA'
      '                      AND TIPO_RECORD = '#39'M'#39')'
      'AND DATA = :DATA_FESTIVITA'
      'AND T265.CODICE (+) = T040.CAUSALE'
      'AND T260.CODICE (+) = T265.CODRAGGR'
      
        'ORDER BY PROGRESSIVO, DECODE(TIPOGIUST,'#39'I'#39',1,'#39'M'#39',2,'#39'N'#39',3,'#39'D'#39',4),' +
        ' DAORE, AORE, CAUSALE')
    ReadBuffer = 33
    Optimize = False
    Variables.Data = {
      04000000020000001E0000003A0044004100540041005F004600450053005400
      490056004900540041000C00000000000000000000001E0000003A0054004900
      50004F005F004600450053005400490056004900540041000500000000000000
      00000000}
    QBEDefinition.QBEFieldDefs = {
      050000000B00000016000000500052004F004700520045005300530049005600
      4F000100000000000800000044004100540041000100000000000E0000004300
      41005500530041004C00450001000000000018000000500052004F0047005200
      430041005500530041004C004500010000000000120000005400490050004F00
      470049005500530054000100000000000A000000440041004F00520045000100
      000000000800000041004F00520045000100000000000C000000530043004800
      4500440041000100000000000C0000005300540041004D005000410001000000
      00000E00000044004100540041004E0041005300010000000000160000004400
      450053004300520049005A0049004F004E004500010000000000}
    OnFilterRecord = selT040FilterRecord
    Left = 224
    Top = 16
  end
  object D010: TDataSource
    Left = 289
    Top = 128
  end
  object cdsDipObblTimb: TClientDataSet
    Aggregates = <>
    FieldDefs = <
      item
        Name = 'DATO_DIP_OBBL_TIMB'
        DataType = ftString
        Size = 50
      end>
    IndexDefs = <>
    Params = <>
    StoreDefs = True
    Left = 288
    Top = 184
  end
  object dsrDipObblTimb: TDataSource
    DataSet = cdsDipObblTimb
    Left = 289
    Top = 240
  end
  object selDettIndFestaSP: TOracleDataSet
    SQL.Strings = (
      'select CSI010.*, CSI010.rowid'
      'from CSI010_FESTIVITA_PARTICOLARI CSI010'
      'where TIPO_FESTIVITA = :TIPO_FESTIVITA'
      'and DATA_FESTIVITA = NVL(:DATA_FESTIVITA,DATA_FESTIVITA)'
      'and TIPO_RECORD = NVL(:TIPO_RECORD,TIPO_RECORD)'
      'and PROGRESSIVO <> -1'
      'and PROGRESSIVO = NVL(:PROGRESSIVO,PROGRESSIVO)'
      ':CONDIZIONE'
      'order by DATA_FESTIVITA, PROGRESSIVO, TIPO_RECORD')
    Optimize = False
    Variables.Data = {
      04000000050000001E0000003A005400490050004F005F004600450053005400
      490056004900540041000500000000000000000000001E0000003A0044004100
      540041005F004600450053005400490056004900540041000C00000000000000
      00000000180000003A005400490050004F005F005200450043004F0052004400
      050000000000000000000000180000003A00500052004F004700520045005300
      5300490056004F00030000000000000000000000160000003A0043004F004E00
      440049005A0049004F004E004500010000000000000000000000}
    Left = 120
    Top = 128
  end
  object updbCSI010: TOracleQuery
    SQL.Strings = (
      'update CSI010_FESTIVITA_PARTICOLARI'
      'set FLAG_SCELTA = :FLAG_SCELTA,'
      '    SCELTE_POSSIBILI = :SCELTE_POSSIBILI,'
      '    COMP_NOSCELTA = :COMP_NOSCELTA'
      'where DATA_FESTIVITA = :DATA_FESTIVITA'
      'and TIPO_FESTIVITA = :TIPO_FESTIVITA'
      'and PROGRESSIVO = :PROGRESSIVO'
      'and TIPO_RECORD = '#39'A'#39)
    Optimize = False
    Variables.Data = {
      04000000060000001E0000003A005400490050004F005F004600450053005400
      490056004900540041000500000000000000000000001E0000003A0044004100
      540041005F004600450053005400490056004900540041000C00000000000000
      00000000180000003A00500052004F0047005200450053005300490056004F00
      030000000000000000000000180000003A0046004C00410047005F0053004300
      45004C0054004100050000000000000000000000220000003A00530043004500
      4C00540045005F0050004F00530053004900420049004C004900050000000000
      0000000000001C0000003A0043004F004D0050005F004E004F00530043004500
      4C0054004100050000000000000000000000}
    Left = 160
    Top = 239
  end
end
