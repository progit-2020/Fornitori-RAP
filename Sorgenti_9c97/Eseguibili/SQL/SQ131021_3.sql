create table SG210_TRASP_ESPERIENZE (
  PROGRESSIVO           number(8)     not null,
  DECORRENZA            date          not null,
  DECORRENZA_FINE       date,
  ORDINE                number(3)     not null,
  INCARICO_ATTUALE      varchar2(1)   default 'N',
  QUALIFICA             varchar2(200),
  TIPO_AMMINISTRAZIONE  varchar2(200),
  AMMINISTRAZIONE       varchar2(500),
  COMUNE                varchar2(6),
  RUOLO                 varchar2(200),
  UNITA_ORGANIZZATIVA   varchar2(200),
  TESTO                 varchar2(1000),
  TEL_UFFICIO           varchar2(40),
  FAX_UFFICIO           varchar2(40),
  EMAIL_UFFICIO         varchar2(100),
  SITO_WEB              varchar2(100)
) tablespace LAVORO storage (initial 256K next 256K pctincrease 0);

alter table SG210_TRASP_ESPERIENZE
add constraint SG210_PK primary key (PROGRESSIVO,DECORRENZA,ORDINE)
using index tablespace INDICI storage (initial 256K next 256K pctincrease 0);


create table SG211_TRASP_ISTRUZIONE (
  TIPO                  varchar2(1)   not null,
  PROGRESSIVO           number(8)     not null,
  ORDINE                number(3)     not null,
  DATA                  date,
  TITOLO_STUDIO         varchar2(200),
  TESTO                 varchar2(1000)
) tablespace LAVORO storage (initial 256K next 256K pctincrease 0);

alter table SG211_TRASP_ISTRUZIONE
add constraint SG211_PK primary key (TIPO,PROGRESSIVO,ORDINE)
using index tablespace INDICI storage (initial 256K next 256K pctincrease 0);


create table SG212_TRASP_LINGUE (
  PROGRESSIVO           number(8)     not null,
  LINGUA                varchar2(100) not null,
  LIVELLO_PARLATO       varchar2(100),
  LIVELLO_SCRITTO       varchar2(100)
) tablespace LAVORO storage (initial 256K next 256K pctincrease 0);

alter table SG212_TRASP_LINGUE
add constraint SG212_PK primary key (PROGRESSIVO,LINGUA)
using index tablespace INDICI storage (initial 256K next 256K pctincrease 0);


create table SG213_TRASP_DICHIARAZIONI (
  PROGRESSIVO            number(8)     not null,
  DATA_VALIDITA          date          not null,
  DATA_COMPILAZIONE      date,
  SENTENZA_CONDANNA      varchar2(1)   default 'S',
  INCONFERIBILITA        varchar2(1)   default 'S',
  INCOMPATIBILITA        varchar2(1)   default 'S',
  INCONF_AMMINISTRAZIONE varchar2(500),
  INCONF_RUOLO           varchar2(200)
) tablespace LAVORO storage (initial 256K next 256K pctincrease 0);

alter table SG213_TRASP_DICHIARAZIONI
add constraint SG213_PK primary key (PROGRESSIVO,DATA_VALIDITA)
using index tablespace INDICI storage (initial 256K next 256K pctincrease 0);


create table SG215_TRASP_ABBINA_CAMPI (
  NOME_LOGICO           varchar2(40)   not null,
  NOME_CAMPO            varchar2(40),
  VAL_DEFAULT           varchar2(1000),
  CTRL_VALORE_DA_ELENCO varchar2(1)    default 'N'
) tablespace LAVORO storage (initial 256K next 256K pctincrease 0);

alter table SG215_TRASP_ABBINA_CAMPI
add constraint SG215_PK primary key (NOME_LOGICO)
using index tablespace INDICI storage (initial 256K next 256K pctincrease 0);


create table SG216_TRASP_ELENCO_VALORI (
  NOME_LOGICO           varchar2(40)   not null,
  VALORE                varchar2(500),
  ORDINE                number(3)
) tablespace LAVORO storage (initial 256K next 256K pctincrease 0);

alter table SG216_TRASP_ELENCO_VALORI
add constraint SG216_PK primary key (NOME_LOGICO,VALORE)
using index tablespace INDICI storage (initial 256K next 256K pctincrease 0);

alter table SG216_TRASP_ELENCO_VALORI
add constraint SG216_FK_SG215 foreign key (NOME_LOGICO)
references SG215_TRASP_ABBINA_CAMPI (NOME_LOGICO) on delete cascade;

INSERT INTO P452_DATIMENSILIDESC
SELECT 'CPAAP', 'Conguaglio CPDEL/CPS anno precedente', 'T', 0, 'S,N', 'A' FROM DUAL
WHERE NOT EXISTS 
  (SELECT 'X' FROM P452_DATIMENSILIDESC T WHERE T.COD_CAMPO='CPAAP');

-- Correzione data cedolini RP 

CREATE TABLE AGG_91_P268 AS SELECT * FROM P268_RAPPORTIPRECEDENTI;
CREATE TABLE AGG_91_P269 AS SELECT * FROM P269_RAPPORTIPRECEDENTIVOCI;
CREATE TABLE AGG_91_P441 AS SELECT * FROM P441_CEDOLINO;
CREATE TABLE AGG_91_P450 AS SELECT * FROM P450_DATIMENSILI;

UPDATE P441_CEDOLINO P441
SET DATA_CEDOLINO = LAST_DAY(DATA_CEDOLINO), DATA_RETRIBUZIONE = LAST_DAY(DATA_RETRIBUZIONE)
WHERE P441.TIPO_CEDOLINO = 'RP'
  AND DATA_CEDOLINO <> LAST_DAY(DATA_CEDOLINO);

UPDATE P450_DATIMENSILI P450
SET DATA_RETRIBUZIONE = LAST_DAY(DATA_RETRIBUZIONE)
WHERE DATA_RETRIBUZIONE <> LAST_DAY(DATA_RETRIBUZIONE);

ALTER TABLE P269_RAPPORTIPRECEDENTIVOCI DISABLE CONSTRAINT P269_FK_P268;
UPDATE P268_RAPPORTIPRECEDENTI P268
SET DATA_CEDOLINO_RP = LAST_DAY(DATA_CEDOLINO_RP)
WHERE DATA_CEDOLINO_RP <> LAST_DAY(DATA_CEDOLINO_RP);
UPDATE P269_RAPPORTIPRECEDENTIVOCI P269
SET DATA_CEDOLINO_RP = LAST_DAY(DATA_CEDOLINO_RP)
WHERE DATA_CEDOLINO_RP <> LAST_DAY(DATA_CEDOLINO_RP);
ALTER TABLE P269_RAPPORTIPRECEDENTIVOCI ENABLE CONSTRAINT P269_FK_P268;

---------------------------
-- Inizio regole CUD - 2013
---------------------------
declare
  i integer;
begin
  select COUNT(*) into i from P502_CUDREGOLE;
  if i > 0 then
     DELETE P502_CUDREGOLE t WHERE t.anno=2013;

insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '023', 'Totale imponibile pensionistico', 'S', 'P1', 'M=S,D=2,0=N', 'S', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F310''' || chr(10) || 'UNION ALL' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H310''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F310''' || chr(10) || 'UNION ALL' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H310''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '025', 'Totale imponibili TFS', 'S', 'P1', 'M=S,D=2,0=N', 'S', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F520''' || chr(10) || 'UNION ALL' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H520''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F520''' || chr(10) || 'UNION ALL' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H520''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C11', '001', 'Matricola azienda', 'N', null, null, 'S', 'SELECT P430.MATR_PENSIONISTICA DATO FROM P430_ANAGRAFICO P430' || chr(10) || '  WHERE P430.PROGRESSIVO = :Progressivo AND P430.DECORRENZA =' || chr(10) || '     (SELECT MAX(P430A.DECORRENZA) FROM P430_ANAGRAFICO P430A WHERE P430A.PROGRESSIVO = P430.PROGRESSIVO AND' || chr(10) || '      TO_DATE(''3112''||:Anno,''ddmmyyyy'') >= P430A.DECORRENZA AND TO_DATE(''0101''||:Anno,''ddmmyyyy'') <= P430A.DECORRENZA_FINE AND' || chr(10) || '      P430A.MATR_PENSIONISTICA IS NOT NULL)' || chr(10) || 'UNION' || chr(10) || 'SELECT MATRICOLA_INPS DATO FROM P500_CUDSETUP' || chr(10) || '  WHERE ANNO = (SELECT MAX(ANNO) FROM P500_CUDSETUP WHERE ANNO <= :Anno)' || chr(10) || '  AND NOT EXISTS' || chr(10) || '    (SELECT ''X'' FROM P430_ANAGRAFICO P430' || chr(10) || '    WHERE P430.PROGRESSIVO = :Progressivo AND P430.MATR_PENSIONISTICA IS NOT NULL AND' || chr(10) || '    TO_DATE(''3112''||:Anno,''ddmmyyyy'') >= P430.DECORRENZA AND TO_DATE(''0101''||:Anno,''ddmmyyyy'') <= P430.DECORRENZA_FINE)', 'SELECT P430.MATR_PENSIONISTICA DATO FROM P430_ANAGRAFICO P430' || chr(10) || '  WHERE P430.PROGRESSIVO = :Progressivo AND P430.DECORRENZA =' || chr(10) || '     (SELECT MAX(P430A.DECORRENZA) FROM P430_ANAGRAFICO P430A WHERE P430A.PROGRESSIVO = P430.PROGRESSIVO AND' || chr(10) || '      TO_DATE(''3112''||:Anno,''ddmmyyyy'') >= P430A.DECORRENZA AND TO_DATE(''0101''||:Anno,''ddmmyyyy'') <= P430A.DECORRENZA_FINE AND' || chr(10) || '      P430A.MATR_PENSIONISTICA IS NOT NULL)' || chr(10) || 'UNION' || chr(10) || 'SELECT MATRICOLA_INPS DATO FROM P500_CUDSETUP' || chr(10) || '  WHERE ANNO = (SELECT MAX(ANNO) FROM P500_CUDSETUP WHERE ANNO <= :Anno)' || chr(10) || '  AND NOT EXISTS' || chr(10) || '    (SELECT ''X'' FROM P430_ANAGRAFICO P430' || chr(10) || '    WHERE P430.PROGRESSIVO = :Progressivo AND P430.MATR_PENSIONISTICA IS NOT NULL AND' || chr(10) || '    TO_DATE(''3112''||:Anno,''ddmmyyyy'') >= P430.DECORRENZA AND TO_DATE(''0101''||:Anno,''ddmmyyyy'') <= P430.DECORRENZA_FINE)', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '013', 'Domicilio fiscale all'' 1/1/2013 - Provincia (sigla)', 'N', null, null, 'S', 'SELECT T480.PROVINCIA DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))', 'SELECT T480.PROVINCIA DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '014', 'Domicilio fiscale all'' 1/1/2013 - Codice comune', 'N', null, null, 'S', 'SELECT T480.CODCATASTALE DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))', 'SELECT T480.CODCATASTALE DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '031', 'Totale imponibile ENPDEP/ENAM', 'S', 'P1', 'M=S,D=2,0=N', 'S', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F710''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H710''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F710''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H710''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C11', '002', 'INPS', 'N', null, null, 'S', 'SELECT ''X'' DATO FROM P430_ANAGRAFICO P430, P090_CODICIINPS P090' || chr(10) || '  WHERE P430.PROGRESSIVO = :Progressivo AND P430.DECORRENZA =' || chr(10) || '     (SELECT MAX(P430A.DECORRENZA) FROM P430_ANAGRAFICO P430A WHERE P430A.PROGRESSIVO = P430.PROGRESSIVO AND' || chr(10) || '      TO_DATE(''3112''||:Anno,''ddmmyyyy'') >= P430A.DECORRENZA AND TO_DATE(''0101''||:Anno,''ddmmyyyy'') <= P430A.DECORRENZA_FINE AND' || chr(10) || '      P430A.COD_CODICEINPS IS NOT NULL)' || chr(10) || '  AND P430.COD_CODICEINPS = P090.COD_CODICEINPS AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P090.DECORRENZA AND P090.DECORRENZA_FINE' || chr(10) || '  AND P090.COD_FORMEASSIC LIKE ''%IVS%''', 'SELECT ''X'' DATO FROM P430_ANAGRAFICO P430, P090_CODICIINPS P090' || chr(10) || '  WHERE P430.PROGRESSIVO = :Progressivo AND P430.DECORRENZA =' || chr(10) || '     (SELECT MAX(P430A.DECORRENZA) FROM P430_ANAGRAFICO P430A WHERE P430A.PROGRESSIVO = P430.PROGRESSIVO AND' || chr(10) || '      TO_DATE(''3112''||:Anno,''ddmmyyyy'') >= P430A.DECORRENZA AND TO_DATE(''0101''||:Anno,''ddmmyyyy'') <= P430A.DECORRENZA_FINE AND' || chr(10) || '      P430A.COD_CODICEINPS IS NOT NULL)' || chr(10) || '  AND P430.COD_CODICEINPS = P090.COD_CODICEINPS AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P090.DECORRENZA AND P090.DECORRENZA_FINE' || chr(10) || '  AND P090.COD_FORMEASSIC LIKE ''%IVS%''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '011', 'Addizionale comunale all''Irpef - Saldo 2013', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(DATO) DATO FROM' || chr(10) || '(SELECT NVL(SUM(DECODE(TIPO_VERSAMENTO,''S'',IMPORTO_TOTALE,-IMPORTO_PAGATO + IMPORTO_RESTITUITO)),0) DATO ' || chr(10) || 'FROM P258_ADDIZIONALIIRPEF P258, T430_STORICO T430' || chr(10) || 'WHERE P258.PROGRESSIVO = :Progressivo AND T430.PROGRESSIVO = P258.PROGRESSIVO' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''DDMMYYYY'') BETWEEN T430.DATADECORRENZA AND T430.DATAFINE' || chr(10) || 'AND ANNO = :Anno AND TIPO_ADDIZIONALE = ''C''' || chr(10) || 'AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY'')) > TO_DATE(''3112''||:Anno,''DDMMYYYY'')' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT IMPORTO_PAGATO - IMPORTO_RESTITUITO DATO' || chr(10) || 'FROM P258_ADDIZIONALIIRPEF P258, T430_STORICO T430' || chr(10) || 'WHERE P258.PROGRESSIVO = :Progressivo AND T430.PROGRESSIVO = P258.PROGRESSIVO' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''DDMMYYYY'') BETWEEN T430.DATADECORRENZA AND T430.DATAFINE' || chr(10) || 'AND TIPO_VERSAMENTO=''S'' AND ANNO = :Anno AND TIPO_ADDIZIONALE = ''C''' || chr(10) || 'AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY'')) <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))', 'SELECT SUM(DATO) DATO FROM' || chr(10) || '(SELECT NVL(SUM(DECODE(TIPO_VERSAMENTO,''S'',IMPORTO_TOTALE,-IMPORTO_PAGATO + IMPORTO_RESTITUITO)),0) DATO ' || chr(10) || 'FROM P258_ADDIZIONALIIRPEF P258, T430_STORICO T430' || chr(10) || 'WHERE P258.PROGRESSIVO = :Progressivo AND T430.PROGRESSIVO = P258.PROGRESSIVO' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''DDMMYYYY'') BETWEEN T430.DATADECORRENZA AND T430.DATAFINE' || chr(10) || 'AND ANNO = :Anno AND TIPO_ADDIZIONALE = ''C''' || chr(10) || 'AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY'')) > TO_DATE(''3112''||:Anno,''DDMMYYYY'')' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT IMPORTO_PAGATO - IMPORTO_RESTITUITO DATO' || chr(10) || 'FROM P258_ADDIZIONALIIRPEF P258, T430_STORICO T430' || chr(10) || 'WHERE P258.PROGRESSIVO = :Progressivo AND T430.PROGRESSIVO = P258.PROGRESSIVO' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''DDMMYYYY'') BETWEEN T430.DATADECORRENZA AND T430.DATAFINE' || chr(10) || 'AND TIPO_VERSAMENTO=''S'' AND ANNO = :Anno AND TIPO_ADDIZIONALE = ''C''' || chr(10) || 'AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY'')) <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '026', 'Totale contributi TFS', 'S', 'P1', 'M=S,D=2,0=N', 'S', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F525''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H525''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F525''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H525''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C11', '004', 'Imponibile previdenziale', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(P673.VALORE) DATO FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || 'WHERE P672.NOME_FLUSSO = ''UNIEMENS'' AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || 'AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || 'AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || 'AND P673.NUMERO=''D090''', 'SELECT SUM(P673.VALORE) DATO FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || 'WHERE P672.NOME_FLUSSO = ''UNIEMENS'' AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || 'AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || 'AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || 'AND P673.NUMERO=''D090''', 'S', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C11', '005', 'Imponibile ai fini IVS', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '013', 'Addizionale comunale all''Irpef - Acconto 2014', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT IMPORTO_TOTALE DATO FROM P258_ADDIZIONALIIRPEF WHERE PROGRESSIVO = :Progressivo' || chr(10) || 'AND TIPO_VERSAMENTO=''A'' AND ANNO = :Anno + 1 AND TIPO_ADDIZIONALE = ''C''' || chr(10) || '', 'SELECT IMPORTO_TOTALE DATO FROM P258_ADDIZIONALIIRPEF WHERE PROGRESSIVO = :Progressivo' || chr(10) || 'AND TIPO_VERSAMENTO=''A'' AND ANNO = :Anno + 1 AND TIPO_ADDIZIONALE = ''C''' || chr(10) || '', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '014', 'Ritenute Irpef sospese', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '015', 'Addizionale regionale all''Irpef sospesa', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '017', 'Addizionale comunale all''Irpef sospesa - Acconto 2013', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '018', 'Addizionale comunale all''Irpef sospesa - Saldo 2013', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '021', 'Primo acconto Irpef trattenuto nell''anno', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO_CONG_POS + IMPORTO_CONG_NEG) DATO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''1ID'',''1IC'')', 'SELECT SUM(IMPORTO_CONG_POS + IMPORTO_CONG_NEG) DATO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''1ID'',''1IC'')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '022', 'Secondo o unico acconto Irpef trattenuto nell''anno', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO_CONG_POS + IMPORTO_CONG_NEG) DATO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''2ID'',''2IC'')', 'SELECT SUM(IMPORTO_CONG_POS + IMPORTO_CONG_NEG) DATO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''2ID'',''2IC'')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '023', 'Acconti Irpef sospesi', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '103', 'Detrazioni per famiglie numerose', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT GREATEST(DETR_FAM_NUM_TEO - NVL(DETR_NO_CAPIENZA_PIU_RICONOSC,0), 0) DATO FROM' || chr(10) || '(SELECT IMPORTO DETR_FAM_NUM_TEO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''13152'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''),' || chr(10) || '(SELECT SUM(IMPORTO) DETR_NO_CAPIENZA_PIU_RICONOSC FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno' || chr(10) || 'AND COD_VOCE IN (''10003'',''13154'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M'')', 'SELECT GREATEST(DETR_FAM_NUM_TEO - NVL(DETR_NO_CAPIENZA_PIU_RICONOSC,0), 0) DATO FROM' || chr(10) || '(SELECT IMPORTO DETR_FAM_NUM_TEO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''13152'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''),' || chr(10) || '(SELECT SUM(IMPORTO) DETR_NO_CAPIENZA_PIU_RICONOSC FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno' || chr(10) || 'AND COD_VOCE IN (''10003'',''13154'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M'')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '104', 'Credito riconosciuto per famiglie numerose', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT IMPORTO DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''13154'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'SELECT IMPORTO DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''13154'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '105', 'Credito non riconosciuto per famiglie numerose', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM ' || chr(10) || '(SELECT SUM(DECODE(COD_VOCE,''13152'',IMPORTO,-IMPORTO)) IMPORTO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''13152'',''13154'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT -GREATEST(DETR_FAM_NUM_TEO - NVL(DETR_NO_CAPIENZA_PIU_RICONOSC,0), 0) IMPORTO FROM' || chr(10) || '(SELECT IMPORTO DETR_FAM_NUM_TEO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''13152'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''),' || chr(10) || '(SELECT SUM(IMPORTO) DETR_NO_CAPIENZA_PIU_RICONOSC FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno' || chr(10) || 'AND COD_VOCE IN (''10003'',''13154'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''))', 'SELECT SUM(IMPORTO) DATO FROM ' || chr(10) || '(SELECT SUM(DECODE(COD_VOCE,''13152'',IMPORTO,-IMPORTO)) IMPORTO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''13152'',''13154'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT -GREATEST(DETR_FAM_NUM_TEO - NVL(DETR_NO_CAPIENZA_PIU_RICONOSC,0), 0) IMPORTO FROM' || chr(10) || '(SELECT IMPORTO DETR_FAM_NUM_TEO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''13152'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''),' || chr(10) || '(SELECT SUM(IMPORTO) DETR_NO_CAPIENZA_PIU_RICONOSC FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno' || chr(10) || 'AND COD_VOCE IN (''10003'',''13154'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''))', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '403', 'Detrazione', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '405', 'Ritenute sospese', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '406', 'Ritenute operate in anni precedenti', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '407', 'Ritenute di anni precedenti sospese', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '404', 'Ritenuta operata nell''anno', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM ' || chr(10) || '(SELECT DATOBASE*PERC/100 IMPORTO FROM' || chr(10) || '(SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) DATOBASE' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND :TipoDipendente = ''ER'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''06004 BASE'') AND TIPO_RECORD = ''M''),' || chr(10) || '(SELECT P430.PERC_IRPEF_TFR PERC FROM P430_ANAGRAFICO P430 WHERE ' || chr(10) || 'P430.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''ER'' ' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE)' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT SUM(IMPORTO) IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND :TipoDipendente <> ''ER'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''11230'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'')', 
        'SELECT SUM(IMPORTO) DATO FROM ' || chr(10) || '(SELECT DATOBASE*PERC/100 IMPORTO FROM' || chr(10) || '(SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) DATOBASE' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND :TipoDipendente = ''ER'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''06004 BASE'') AND TIPO_RECORD = ''M''),' || chr(10) || '(SELECT P430.PERC_IRPEF_TFR PERC FROM P430_ANAGRAFICO P430 WHERE ' || chr(10) || 'P430.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''ER'' ' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE)' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT SUM(IMPORTO) IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND :TipoDipendente <> ''ER'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''11230'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'')', 'S', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C11', '006', 'Contributi a carico del lavoratore trattenuti', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441' || chr(10) || 'WHERE P441.PROGRESSIVO = :Progressivo AND ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO <> ''RP''' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno' || chr(10) || 'AND RPAD(P442.COD_CONTRATTO,6,'' '')||RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''EDP   11160 BASE'',''EDP   11170 BASE'')' || chr(10) || 'AND TIPO_RECORD = ''M''', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441' || chr(10) || 'WHERE P441.PROGRESSIVO = :Progressivo AND ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO <> ''RP''' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno' || chr(10) || 'AND RPAD(P442.COD_CONTRATTO,6,'' '')||RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''EDP   11160 BASE'',''EDP   11170 BASE'')' || chr(10) || 'AND TIPO_RECORD = ''M''', 'S', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C11', '007', 'MESI PER I QUALI E'' STATA PRESENTATA LA DENUNCIA Uniemens -Tutti', 'N', null, null, 'S', 'SELECT DECODE(COUNT(*),12,''X'','''') DATO from P672_XMLTESTATE P672, P673_XMLDATIINDIVIDUALI P673' || chr(10) || 'WHERE P672.ID_FLUSSO = P673.ID_FLUSSO AND P672.NOME_FLUSSO = ''UNIEMENS'' AND P672.CHIUSO = ''S''' || chr(10) || 'AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno AND P673.NUMERO = ''A350'' AND P673.TIPO_RECORD = ''M'' AND P673.PROGRESSIVO_NUMERO = 1' || chr(10) || 'AND P673.PROGRESSIVO = :Progressivo', 'SELECT DECODE(COUNT(*),12,''X'','''') DATO from P672_XMLTESTATE P672, P673_XMLDATIINDIVIDUALI P673' || chr(10) || 'WHERE P672.ID_FLUSSO = P673.ID_FLUSSO AND P672.NOME_FLUSSO = ''UNIEMENS'' AND P672.CHIUSO = ''S''' || chr(10) || 'AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno AND P673.NUMERO = ''A350'' AND P673.TIPO_RECORD = ''M'' AND P673.PROGRESSIVO_NUMERO = 1' || chr(10) || 'AND P673.PROGRESSIVO = :Progressivo', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '028', 'Totale contributi TFR', 'S', 'P1', 'M=S,D=2,0=N', 'S', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F515''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H515''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F515''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H515''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C11', '008', 'MESI PER I QUALI E'' STATA PRESENTATA LA DENUNCIA Uniemens - Tutti con l''esclusione di', 'N', null, null, 'S', 'SELECT NVL(PEMENS.DATO,''X'') DATO FROM' || chr(10) || '(SELECT TO_CHAR(P672.DATA_FINE_PERIODO,''MM'') MESE, '' '' DATO from P672_XMLTESTATE P672, P673_XMLDATIINDIVIDUALI P673' || chr(10) || 'WHERE P672.ID_FLUSSO = P673.ID_FLUSSO AND P672.NOME_FLUSSO = ''UNIEMENS'' AND P672.CHIUSO = ''S''' || chr(10) || 'AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno AND P673.NUMERO = ''A350'' AND P673.TIPO_RECORD = ''M'' AND P673.PROGRESSIVO_NUMERO = 1' || chr(10) || 'AND P673.PROGRESSIVO = :Progressivo) PEMENS,' || chr(10) || '(SELECT ''01'' MESE FROM DUAL UNION SELECT ''02'' MESE FROM DUAL UNION SELECT ''03'' MESE FROM DUAL ' || chr(10) || 'UNION SELECT ''04'' MESE FROM DUAL UNION SELECT ''05'' MESE FROM DUAL UNION SELECT ''06'' MESE FROM DUAL ' || chr(10) || 'UNION SELECT ''07'' MESE FROM DUAL UNION SELECT ''08'' MESE FROM DUAL UNION SELECT ''09'' MESE FROM DUAL ' || chr(10) || 'UNION SELECT ''10'' MESE FROM DUAL UNION SELECT ''11'' MESE FROM DUAL UNION SELECT ''12'' MESE FROM DUAL) PMESI' || chr(10) || 'WHERE PMESI.MESE = PEMENS.MESE(+)' || chr(10) || 'ORDER BY PMESI.MESE', 'SELECT NVL(PEMENS.DATO,''X'') DATO FROM' || chr(10) || '(SELECT TO_CHAR(P672.DATA_FINE_PERIODO,''MM'') MESE, '' '' DATO from P672_XMLTESTATE P672, P673_XMLDATIINDIVIDUALI P673' || chr(10) || 'WHERE P672.ID_FLUSSO = P673.ID_FLUSSO AND P672.NOME_FLUSSO = ''UNIEMENS'' AND P672.CHIUSO = ''S''' || chr(10) || 'AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno AND P673.NUMERO = ''A350'' AND P673.TIPO_RECORD = ''M'' AND P673.PROGRESSIVO_NUMERO = 1' || chr(10) || 'AND P673.PROGRESSIVO = :Progressivo) PEMENS,' || chr(10) || '(SELECT ''01'' MESE FROM DUAL UNION SELECT ''02'' MESE FROM DUAL UNION SELECT ''03'' MESE FROM DUAL ' || chr(10) || 'UNION SELECT ''04'' MESE FROM DUAL UNION SELECT ''05'' MESE FROM DUAL UNION SELECT ''06'' MESE FROM DUAL ' || chr(10) || 'UNION SELECT ''07'' MESE FROM DUAL UNION SELECT ''08'' MESE FROM DUAL UNION SELECT ''09'' MESE FROM DUAL ' || chr(10) || 'UNION SELECT ''10'' MESE FROM DUAL UNION SELECT ''11'' MESE FROM DUAL UNION SELECT ''12'' MESE FROM DUAL) PMESI' || chr(10) || 'WHERE PMESI.MESE = PEMENS.MESE(+)' || chr(10) || 'ORDER BY PMESI.MESE', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '029', 'Totale imponibile Gestione Credito', 'S', 'P1', 'M=S,D=2,0=N', 'S', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F615''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H615''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F615''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H615''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '037', 'Credito di addizionale regionale all''Irpef non rimborsato', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT SUM(GREATEST(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG,0)) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN (''RRD'',''RRC'',''IRC'',''IRD'')' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT SUM(GREATEST(-(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG),0)) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN (''TRD'',''TRC''))', 'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT SUM(GREATEST(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG,0)) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN (''RRD'',''RRC'',''IRC'',''IRD'')' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT SUM(GREATEST(-(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG),0)) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN (''TRD'',''TRC''))', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '030', 'Totale contributo Gestione Credito', 'S', 'P1', 'M=S,D=2,0=N', 'S', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F620''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H620''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F620''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H620''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '018', 'Gestione Pens.', 'N', null, null, 'N', 'SELECT DECODE(INSTR(P094.COD_GESTASSIC,''2''),0,'''',''2'') || DECODE(INSTR(P094.COD_GESTASSIC,''5''),0,'''',''5'') DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P094_INQUADRINPDAP P094 WHERE P430.COD_INQUADRINPDAP = P094.COD_INQUADRINPDAP' || chr(10) || 'AND P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P094.DECORRENZA AND P094.DECORRENZA_FINE', 'SELECT DECODE(INSTR(P094.COD_GESTASSIC,''2''),0,'''',''2'') || DECODE(INSTR(P094.COD_GESTASSIC,''5''),0,'''',''5'') DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P094_INQUADRINPDAP P094 WHERE P430.COD_INQUADRINPDAP = P094.COD_INQUADRINPDAP' || chr(10) || 'AND P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P094.DECORRENZA AND P094.DECORRENZA_FINE', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C11', '003', 'Altro', 'N', null, null, 'S', 'SELECT ''X'' DATO FROM P430_ANAGRAFICO P430, P090_CODICIINPS P090' || chr(10) || '  WHERE P430.PROGRESSIVO = :Progressivo AND P430.DECORRENZA =' || chr(10) || '     (SELECT MAX(P430A.DECORRENZA) FROM P430_ANAGRAFICO P430A WHERE P430A.PROGRESSIVO = P430.PROGRESSIVO AND' || chr(10) || '      TO_DATE(''3112''||:Anno,''ddmmyyyy'') >= P430A.DECORRENZA AND TO_DATE(''0101''||:Anno,''ddmmyyyy'') <= P430A.DECORRENZA_FINE AND' || chr(10) || '      P430A.COD_CODICEINPS IS NOT NULL)' || chr(10) || '  AND P430.COD_CODICEINPS = P090.COD_CODICEINPS AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P090.DECORRENZA AND P090.DECORRENZA_FINE' || chr(10) || '  AND P090.COD_FORMEASSIC NOT LIKE ''%IVS%''', 'SELECT ''X'' DATO FROM P430_ANAGRAFICO P430, P090_CODICIINPS P090' || chr(10) || '  WHERE P430.PROGRESSIVO = :Progressivo AND P430.DECORRENZA =' || chr(10) || '     (SELECT MAX(P430A.DECORRENZA) FROM P430_ANAGRAFICO P430A WHERE P430A.PROGRESSIVO = P430.PROGRESSIVO AND' || chr(10) || '      TO_DATE(''3112''||:Anno,''ddmmyyyy'') >= P430A.DECORRENZA AND TO_DATE(''0101''||:Anno,''ddmmyyyy'') <= P430A.DECORRENZA_FINE AND' || chr(10) || '      P430A.COD_CODICEINPS IS NOT NULL)' || chr(10) || '  AND P430.COD_CODICEINPS = P090.COD_CODICEINPS AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P090.DECORRENZA AND P090.DECORRENZA_FINE' || chr(10) || '  AND P090.COD_FORMEASSIC NOT LIKE ''%IVS%''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C12', '012', 'Contributi versati', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441' || chr(10) || 'WHERE P441.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''CO'' AND ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO <> ''RP''' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_CONTRATTO = ''EDP''' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''11110 BASE'',''11115 BASE'',''11120 BASE'',''11125 BASE'',''11130 BASE'',''11135 BASE'')' || chr(10) || 'AND TIPO_RECORD = ''M''', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441' || chr(10) || 'WHERE P441.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''CO'' AND ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO <> ''RP''' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_CONTRATTO = ''EDP''' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''11110 BASE'',''11115 BASE'',''11120 BASE'',''11125 BASE'',''11130 BASE'',''11135 BASE'')' || chr(10) || 'AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '015', 'Domicilio fiscale al 31/12/2013 o alla data di cessazione del rapporto di lavoro se precedente - Comune', 'N', null, null, 'S', 'SELECT RTRIM(T480.CITTA) DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''3112''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || '-- Solo se domicilio non variato rispetto al primo Gennaio' || chr(10) || 'AND T480.CODCATASTALE <>' || chr(10) || '(' || chr(10) || 'SELECT T480A.CODCATASTALE DATO FROM T430_STORICO T430A, T480_COMUNI T480A' || chr(10) || 'WHERE T430A.PROGRESSIVO = :Progressivo AND T430A.COMUNE = T480A.CODICE AND' || chr(10) || 'T430A.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ')', 'SELECT RTRIM(T480.CITTA) DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''3112''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || '-- Solo se domicilio non variato rispetto al primo Gennaio' || chr(10) || 'AND T480.CODCATASTALE <>' || chr(10) || '(' || chr(10) || 'SELECT T480A.CODCATASTALE DATO FROM T430_STORICO T430A, T480_COMUNI T480A' || chr(10) || 'WHERE T430A.PROGRESSIVO = :Progressivo AND T430A.COMUNE = T480A.CODICE AND' || chr(10) || 'T430A.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '018', 'Domicilio fiscale all'' 1/1/2014 - Provincia (sigla)', 'N', null, null, 'S', 'SELECT T480.PROVINCIA DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY''))' || chr(10) || 'AND EXISTS' || chr(10) || '  (SELECT ''X'' FROM T430_STORICO' || chr(10) || '  WHERE PROGRESSIVO = :Progressivo' || chr(10) || '  AND TO_DATE(''0101''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY'')' || chr(10) || '  BETWEEN INIZIO AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY''))) ' || chr(10) || '-- Solo se domicilio non variato rispetto al primo Gennaio' || chr(10) || 'AND T480.CODCATASTALE <>' || chr(10) || '(' || chr(10) || 'SELECT T480A.CODCATASTALE DATO FROM T430_STORICO T430A, T480_COMUNI T480A' || chr(10) || 'WHERE T430A.PROGRESSIVO = :Progressivo AND T430A.COMUNE = T480A.CODICE AND' || chr(10) || 'T430A.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ') ', 
        'SELECT T480.PROVINCIA DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY''))' || chr(10) || 'AND EXISTS' || chr(10) || '  (SELECT ''X'' FROM T430_STORICO' || chr(10) || '  WHERE PROGRESSIVO = :Progressivo' || chr(10) || '  AND TO_DATE(''0101''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY'')' || chr(10) || '  BETWEEN INIZIO AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY''))) ' || chr(10) || '-- Solo se domicilio non variato rispetto al primo Gennaio' || chr(10) || 'AND T480.CODCATASTALE <>' || chr(10) || '(' || chr(10) || 'SELECT T480A.CODCATASTALE DATO FROM T430_STORICO T430A, T480_COMUNI T480A' || chr(10) || 'WHERE T430A.PROGRESSIVO = :Progressivo AND T430A.COMUNE = T480A.CODICE AND' || chr(10) || 'T430A.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ') ', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '005', 'Ritenute Irpef', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT IMPORTO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || ':TipoDipendente <> ''ER'' AND TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''11240'',''13154'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT -IMPORTO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || ':TipoDipendente <> ''ER'' AND TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''10002'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT SUM(IMPORTO) IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_VOCE = ''11210'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'' AND' || chr(10) || ':TipoDipendente = ''ER'')', 'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT IMPORTO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || ':TipoDipendente <> ''ER'' AND TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''11240'',''13154'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT -IMPORTO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || ':TipoDipendente <> ''ER'' AND TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''10002'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT SUM(IMPORTO) IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_VOCE = ''11210'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'' AND' || chr(10) || ':TipoDipendente = ''ER'')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '024', 'Totale contributi pensionistici', 'S', 'P1', 'M=S,D=2,0=N', 'S', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO IN(''F315'',''F320'')' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO IN(''H315'',''H320'')' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO IN(''F315'',''F320'')' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO IN(''H315'',''H320'')' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '136', 'Casi particolari', 'N', null, null, 'S', 'SELECT ''B'' DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P442_CEDOLINOVOCI P442 WHERE P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND P430.DETRAZ_REDDITI_MIN_DET = ''S''' || chr(10) || 'AND P442.ID_CEDOLINO = :IdCedCongIRPEF AND TO_CHAR(P442.DATA_COMPETENZA_A,''YYYY'') = :Anno ' || chr(10) || 'AND P442.COD_VOCE = ''13012'' AND P442.COD_VOCE_SPECIALE = ''CONG'' AND P442.TIPO_RECORD = ''M''' || chr(10) || 'AND P442.IMPORTO=1380', 'SELECT ''B'' DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P442_CEDOLINOVOCI P442 WHERE P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND P430.DETRAZ_REDDITI_MIN_DET = ''S''' || chr(10) || 'AND P442.ID_CEDOLINO = :IdCedCongIRPEF AND TO_CHAR(P442.DATA_COMPETENZA_A,''YYYY'') = :Anno ' || chr(10) || 'AND P442.COD_VOCE = ''13012'' AND P442.COD_VOCE_SPECIALE = ''CONG'' AND P442.TIPO_RECORD = ''M''' || chr(10) || 'AND P442.IMPORTO=1380', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '138', 'Contributo di solidarieta'' sospeso', 'S', 'P1', 'M=S,D=2,0=N', 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '201', 'Irpef da trattenere dal sostituto successivamente al 28 febbraio', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '203', 'Irpef da versare all''erario da parte del dipendente', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '130', 'Totale oneri sostenuti non esclusi dai redditi indicati nei punti 1 e 2', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT - NVL(LEAST(SUM(IMPORTO),0),0) DATO FROM' || chr(10) || '(' || chr(10) || '(SELECT DECODE(COD_VOCE,''10240'',IMPORTO,-IMPORTO) IMPORTO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || ':TipoDipendente <> ''ER'' AND TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''10240'',''10245'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M'')' || chr(10) || 'UNION ALL' || chr(10) || '(SELECT -SUM(IMPORTO) FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo AND' || chr(10) || ':TipoDipendente <> ''ER'' AND' || chr(10) || 'TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_VOCE = ''14010'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'HAVING SUM(IMPORTO) > 0)' || chr(10) || 'UNION ALL' || chr(10) || '(SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_VOCE = ''11200'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'' AND' || chr(10) || ':TipoDipendente = ''ER'')' || chr(10) || ')', 
        'SELECT - NVL(LEAST(SUM(IMPORTO),0),0) DATO FROM' || chr(10) || '(' || chr(10) || '(SELECT DECODE(COD_VOCE,''10240'',IMPORTO,-IMPORTO) IMPORTO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || ':TipoDipendente <> ''ER'' AND TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''10240'',''10245'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M'')' || chr(10) || 'UNION ALL' || chr(10) || '(SELECT -SUM(IMPORTO) FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo AND' || chr(10) || ':TipoDipendente <> ''ER'' AND' || chr(10) || 'TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_VOCE = ''14010'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'HAVING SUM(IMPORTO) > 0)' || chr(10) || 'UNION ALL' || chr(10) || '(SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_VOCE = ''11200'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'' AND' || chr(10) || ':TipoDipendente = ''ER'')' || chr(10) || ')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '038', 'Credito di addizionale comunale all''Irpef non rimborsato', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT SUM(GREATEST(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG,0)) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN (''RCD'',''RCC'',''ICC'',''ICD'')' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT SUM(GREATEST(-(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG),0)) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN (''TCD'',''TCC''))', 'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT SUM(GREATEST(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG,0)) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN (''RCD'',''RCC'',''ICC'',''ICD'')' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT SUM(GREATEST(-(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG),0)) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN (''TCD'',''TCC''))', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '039', 'Credito cedolare secca non rimborsato', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT GREATEST(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG,0) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''RLD'',''RLC'',''ILD'')' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT GREATEST(-(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG),0) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''TLD'',''TLC''))', 'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT GREATEST(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG,0) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''RLD'',''RLC'',''ILD'')' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT GREATEST(-(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG),0) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''TLD'',''TLC''))', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '101', 'Imposta lorda', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT IMPORTO DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''11240'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'SELECT IMPORTO DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''11240'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '102', 'Detrazioni per carichi di famiglia', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''13022'',''13042'',''13072'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''13022'',''13042'',''13072'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '026', 'Prima rata di acconto cedolare secca', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO_CONG_POS + IMPORTO_CONG_NEG) DATO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''1LD'',''1LC'')', 'SELECT SUM(IMPORTO_CONG_POS + IMPORTO_CONG_NEG) DATO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''1LD'',''1LC'')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C12', '009', 'Compensi corrisposti al collaboratore', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT LEAST(IMPORTO,' || chr(10) || '-- Massimale INPS' || chr(10) || '(' || chr(10) || 'SELECT P233.IMPORTO_A FROM P232_SCAGLIONI P232,P233_SCAGLIONIFASCE P233' || chr(10) || 'WHERE P232.ID_SCAGLIONE=P233.ID_SCAGLIONE AND P233.IMPORTO_DA=0' || chr(10) || 'AND P232.COD_CONTRATTO=''EDP'' AND P232.COD_VOCE=''11110'' AND P232.COD_VOCE_SPECIALE=''BASE''' || chr(10) || 'AND P232.DECORRENZA=' || chr(10) || '  (SELECT MAX(DECORRENZA) FROM P232_SCAGLIONI WHERE COD_CONTRATTO=P232.COD_CONTRATTO' || chr(10) || '   AND COD_VOCE=P232.COD_VOCE AND COD_VOCE_SPECIALE=P232.COD_VOCE_SPECIALE' || chr(10) || '   AND DECORRENZA<=TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ')' || chr(10) || '--   ' || chr(10) || ') DATO FROM' || chr(10) || '(SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 ' || chr(10) || 'WHERE P441.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''CO'' AND ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO <> ''RP''' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_CONTRATTO = ''EDP''' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''11110 BASE'',''11120 BASE'',''11130 BASE'')' || chr(10) || 'AND TIPO_RECORD = ''M'')', 
        'SELECT LEAST(IMPORTO,' || chr(10) || '-- Massimale INPS' || chr(10) || '(' || chr(10) || 'SELECT P233.IMPORTO_A FROM P232_SCAGLIONI P232,P233_SCAGLIONIFASCE P233' || chr(10) || 'WHERE P232.ID_SCAGLIONE=P233.ID_SCAGLIONE AND P233.IMPORTO_DA=0' || chr(10) || 'AND P232.COD_CONTRATTO=''EDP'' AND P232.COD_VOCE=''11110'' AND P232.COD_VOCE_SPECIALE=''BASE''' || chr(10) || 'AND P232.DECORRENZA=' || chr(10) || '  (SELECT MAX(DECORRENZA) FROM P232_SCAGLIONI WHERE COD_CONTRATTO=P232.COD_CONTRATTO' || chr(10) || '   AND COD_VOCE=P232.COD_VOCE AND COD_VOCE_SPECIALE=P232.COD_VOCE_SPECIALE' || chr(10) || '   AND DECORRENZA<=TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ')' || chr(10) || '--   ' || chr(10) || ') DATO FROM' || chr(10) || '(SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 ' || chr(10) || 'WHERE P441.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''CO'' AND ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO <> ''RP''' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_CONTRATTO = ''EDP''' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''11110 BASE'',''11120 BASE'',''11130 BASE'')' || chr(10) || 'AND TIPO_RECORD = ''M'')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '036', 'Credito Irpef non rimborsato', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT GREATEST(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG,0) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''RID'',''RIC'',''IID'',''IIC'',''ITD'',''ITC'')' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT GREATEST(-(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG),0) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''TID'',''TIC''))', 'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT GREATEST(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG,0) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''RID'',''RIC'',''IID'',''IIC'',''ITD'',''ITC'')' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT GREATEST(-(IMPORTO_DOVUTO - IMPORTO_CONG_POS - IMPORTO_CONG_NEG),0) IMPORTO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''TID'',''TIC''))', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '027', 'Seconda o unica rata di acconto cedolare secca', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO_CONG_POS + IMPORTO_CONG_NEG) DATO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''2LD'',''2LC'')', 'SELECT SUM(IMPORTO_CONG_POS + IMPORTO_CONG_NEG) DATO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''2LD'',''2LC'')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '028', 'Acconti cedolare secca sospesi', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '032', 'Totale contributi ENPDEP/ENAM', 'S', 'P1', 'M=S,D=2,0=N', 'S', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F715''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H715''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F715''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H715''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C12', '011', 'Contributi a carico del collaboratore trattenuti', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441' || chr(10) || 'WHERE P441.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''CO'' AND ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO <> ''RP''' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_CONTRATTO = ''EDP''' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''11110 BASE'',''11120 BASE'',''11130 BASE'')' || chr(10) || 'AND TIPO_RECORD = ''M''', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441' || chr(10) || 'WHERE P441.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''CO'' AND ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO <> ''RP''' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_CONTRATTO = ''EDP''' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''11110 BASE'',''11120 BASE'',''11130 BASE'')' || chr(10) || 'AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C12', '014', 'MESI PER I QUALI E'' STATA PRESENTATA LA DENUNCIA Uniemens - Tutti con l''esclusione di', 'N', null, null, 'S', 'SELECT NVL(PEMENS.DATO,''X'') DATO FROM' || chr(10) || '(SELECT TO_CHAR(P672.DATA_FINE_PERIODO,''MM'') MESE, '' '' DATO from P672_XMLTESTATE P672, P673_XMLDATIINDIVIDUALI P673' || chr(10) || 'WHERE P672.ID_FLUSSO = P673.ID_FLUSSO AND P672.NOME_FLUSSO = ''UNIEMENS'' AND P672.CHIUSO = ''S''' || chr(10) || 'AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno AND P673.NUMERO = ''A450'' AND P673.TIPO_RECORD = ''M'' AND P673.PROGRESSIVO_NUMERO = 1' || chr(10) || 'AND P673.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''CO'') PEMENS,' || chr(10) || '(SELECT ''01'' MESE FROM DUAL UNION SELECT ''02'' MESE FROM DUAL UNION SELECT ''03'' MESE FROM DUAL ' || chr(10) || 'UNION SELECT ''04'' MESE FROM DUAL UNION SELECT ''05'' MESE FROM DUAL UNION SELECT ''06'' MESE FROM DUAL ' || chr(10) || 'UNION SELECT ''07'' MESE FROM DUAL UNION SELECT ''08'' MESE FROM DUAL UNION SELECT ''09'' MESE FROM DUAL ' || chr(10) || 'UNION SELECT ''10'' MESE FROM DUAL UNION SELECT ''11'' MESE FROM DUAL UNION SELECT ''12'' MESE FROM DUAL) PMESI' || chr(10) || 'WHERE PMESI.MESE = PEMENS.MESE(+)' || chr(10) || 'ORDER BY PMESI.MESE', 'SELECT NVL(PEMENS.DATO,''X'') DATO FROM' || chr(10) || '(SELECT TO_CHAR(P672.DATA_FINE_PERIODO,''MM'') MESE, '' '' DATO from P672_XMLTESTATE P672, P673_XMLDATIINDIVIDUALI P673' || chr(10) || 'WHERE P672.ID_FLUSSO = P673.ID_FLUSSO AND P672.NOME_FLUSSO = ''UNIEMENS'' AND P672.CHIUSO = ''S''' || chr(10) || 'AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno AND P673.NUMERO = ''A450'' AND P673.TIPO_RECORD = ''M'' AND P673.PROGRESSIVO_NUMERO = 1' || chr(10) || 'AND P673.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''CO'') PEMENS,' || chr(10) || '(SELECT ''01'' MESE FROM DUAL UNION SELECT ''02'' MESE FROM DUAL UNION SELECT ''03'' MESE FROM DUAL ' || chr(10) || 'UNION SELECT ''04'' MESE FROM DUAL UNION SELECT ''05'' MESE FROM DUAL UNION SELECT ''06'' MESE FROM DUAL ' || chr(10) || 'UNION SELECT ''07'' MESE FROM DUAL UNION SELECT ''08'' MESE FROM DUAL UNION SELECT ''09'' MESE FROM DUAL ' || chr(10) || 'UNION SELECT ''10'' MESE FROM DUAL UNION SELECT ''11'' MESE FROM DUAL UNION SELECT ''12'' MESE FROM DUAL) PMESI' || chr(10) || 'WHERE PMESI.MESE = PEMENS.MESE(+)' || chr(10) || 'ORDER BY PMESI.MESE', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '015', 'Codice fiscale Amministrazione', 'N', null, null, 'S', 'SELECT COD_FISCALE DATO FROM P500_CUDSETUP' || chr(10) || '  WHERE ANNO = (SELECT MAX(ANNO) FROM P500_CUDSETUP WHERE ANNO <= :Anno)', 'SELECT COD_FISCALE DATO FROM P500_CUDSETUP' || chr(10) || '  WHERE ANNO = (SELECT MAX(ANNO) FROM P500_CUDSETUP WHERE ANNO <= :Anno)', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '016', 'Progressivo Azienda', 'N', null, null, 'S', 'SELECT CODICE_INPDAP_DMA DATO FROM P500_CUDSETUP' || chr(10) || '  WHERE ANNO = (SELECT MAX(ANNO) FROM P500_CUDSETUP WHERE ANNO <= :Anno)', 'SELECT CODICE_INPDAP_DMA DATO FROM P500_CUDSETUP' || chr(10) || '  WHERE ANNO = (SELECT MAX(ANNO) FROM P500_CUDSETUP WHERE ANNO <= :Anno)', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '017', 'Codice identificativo attribuito da SPT del MEF', 'N', null, null, 'S', 'SELECT CODICE_MEF_DMA DATO FROM P500_CUDSETUP' || chr(10) || '  WHERE ANNO = (SELECT MAX(ANNO) FROM P500_CUDSETUP WHERE ANNO <= :Anno)', 'SELECT CODICE_MEF_DMA DATO FROM P500_CUDSETUP' || chr(10) || '  WHERE ANNO = (SELECT MAX(ANNO) FROM P500_CUDSETUP WHERE ANNO <= :Anno)', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C12', '010', 'Contributi dovuti', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441' || chr(10) || 'WHERE P441.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''CO'' AND ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO <> ''RP''' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_CONTRATTO = ''EDP''' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''11110 BASE'',''11115 BASE'',''11120 BASE'',''11125 BASE'',''11130 BASE'',''11135 BASE'')' || chr(10) || 'AND TIPO_RECORD = ''M''', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441' || chr(10) || 'WHERE P441.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''CO'' AND ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO <> ''RP''' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_CONTRATTO = ''EDP''' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''11110 BASE'',''11115 BASE'',''11120 BASE'',''11125 BASE'',''11130 BASE'',''11135 BASE'')' || chr(10) || 'AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C12', '013', 'MESI PER I QUALI E'' STATA PRESENTATA LA DENUNCIA Uniemens -Tutti', 'N', null, null, 'S', 'SELECT DECODE(COUNT(*),12,''X'','''') DATO from P672_XMLTESTATE P672, P673_XMLDATIINDIVIDUALI P673' || chr(10) || 'WHERE P672.ID_FLUSSO = P673.ID_FLUSSO AND P672.NOME_FLUSSO = ''UNIEMENS'' AND P672.CHIUSO = ''S''' || chr(10) || 'AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno AND P673.NUMERO = ''A450'' AND P673.TIPO_RECORD = ''M'' AND P673.PROGRESSIVO_NUMERO = 1' || chr(10) || 'AND P673.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''CO''', 'SELECT DECODE(COUNT(*),12,''X'','''') DATO from P672_XMLTESTATE P672, P673_XMLDATIINDIVIDUALI P673' || chr(10) || 'WHERE P672.ID_FLUSSO = P673.ID_FLUSSO AND P672.NOME_FLUSSO = ''UNIEMENS'' AND P672.CHIUSO = ''S''' || chr(10) || 'AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno AND P673.NUMERO = ''A450'' AND P673.TIPO_RECORD = ''M'' AND P673.PROGRESSIVO_NUMERO = 1' || chr(10) || 'AND P673.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''CO''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '019', 'Gestione Prev.', 'N', null, null, 'N', 'SELECT DECODE(INSTR(P094.COD_GESTASSIC,''6''),0,DECODE(INSTR(P094.COD_GESTASSIC,''7''),0,'''',''7''),''6'')' || chr(10) || '       || DECODE(P026.COD_INPDAPREGIMEFINESERV,'''',' || chr(10) || '                    DECODE(NVL(P240.TFR,''N''),''S'',''001'',''003''),' || chr(10) || '                    LPAD(P026.COD_INPDAPREGIMEFINESERV,3,''0'')) DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P094_INQUADRINPDAP P094, P240_TIPIASSOGGETTAMENTI P240, P026_FONDIPREVCOMPL P026' || chr(10) || 'WHERE P430.COD_INQUADRINPDAP = P094.COD_INQUADRINPDAP' || chr(10) || 'AND P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P094.DECORRENZA AND P094.DECORRENZA_FINE' || chr(10) || 'AND P430.COD_TIPOASSOGGETTAMENTO = P240.COD_TIPOASSOGGETTAMENTO(+)' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P240.DECORRENZA(+) AND P240.DECORRENZA_FINE(+)' || chr(10) || 'AND P430.COD_FPC = P026.COD_FPC(+)' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P026.DECORRENZA(+) AND P026.DECORRENZA_FINE(+)', 
        'SELECT DECODE(INSTR(P094.COD_GESTASSIC,''6''),0,DECODE(INSTR(P094.COD_GESTASSIC,''7''),0,'''',''7''),''6'')' || chr(10) || '       || DECODE(P026.COD_INPDAPREGIMEFINESERV,'''',' || chr(10) || '                    DECODE(NVL(P240.TFR,''N''),''S'',''001'',''003''),' || chr(10) || '                    LPAD(P026.COD_INPDAPREGIMEFINESERV,3,''0'')) DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P094_INQUADRINPDAP P094, P240_TIPIASSOGGETTAMENTI P240, P026_FONDIPREVCOMPL P026' || chr(10) || 'WHERE P430.COD_INQUADRINPDAP = P094.COD_INQUADRINPDAP' || chr(10) || 'AND P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P094.DECORRENZA AND P094.DECORRENZA_FINE' || chr(10) || 'AND P430.COD_TIPOASSOGGETTAMENTO = P240.COD_TIPOASSOGGETTAMENTO(+)' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P240.DECORRENZA(+) AND P240.DECORRENZA_FINE(+)' || chr(10) || 'AND P430.COD_FPC = P026.COD_FPC(+)' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P026.DECORRENZA(+) AND P026.DECORRENZA_FINE(+)', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '019', 'Domicilio fiscale all'' 1/1/2014 - Codice comune', 'N', null, null, 'S', 'SELECT T480.CODCATASTALE DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY''))' || chr(10) || 'AND EXISTS' || chr(10) || '  (SELECT ''X'' FROM T430_STORICO' || chr(10) || '  WHERE PROGRESSIVO = :Progressivo' || chr(10) || '  AND TO_DATE(''0101''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY'')' || chr(10) || '  BETWEEN INIZIO AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY'')))' || chr(10) || '-- Solo se domicilio non variato rispetto al primo Gennaio' || chr(10) || 'AND T480.CODCATASTALE <>' || chr(10) || '(' || chr(10) || 'SELECT T480A.CODCATASTALE DATO FROM T430_STORICO T430A, T480_COMUNI T480A' || chr(10) || 'WHERE T430A.PROGRESSIVO = :Progressivo AND T430A.COMUNE = T480A.CODICE AND' || chr(10) || 'T430A.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ')', 
        'SELECT T480.CODCATASTALE DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY''))' || chr(10) || 'AND EXISTS' || chr(10) || '  (SELECT ''X'' FROM T430_STORICO' || chr(10) || '  WHERE PROGRESSIVO = :Progressivo' || chr(10) || '  AND TO_DATE(''0101''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY'')' || chr(10) || '  BETWEEN INIZIO AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY'')))' || chr(10) || '-- Solo se domicilio non variato rispetto al primo Gennaio' || chr(10) || 'AND T480.CODCATASTALE <>' || chr(10) || '(' || chr(10) || 'SELECT T480A.CODCATASTALE DATO FROM T430_STORICO T430A, T480_COMUNI T480A' || chr(10) || 'WHERE T430A.PROGRESSIVO = :Progressivo AND T430A.COMUNE = T480A.CODICE AND' || chr(10) || 'T430A.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '002', 'Redditi per i quali e'' possibile fruire della detrazione di cui all''art.13, commi 5 e 5-bis del Tuir', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT NVL(GREATEST(SUM(IMPORTO),0),0) DATO FROM' || chr(10) || 'P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_VOCE = ''14010'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''', 'SELECT NVL(GREATEST(SUM(IMPORTO),0),0) DATO FROM' || chr(10) || 'P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_VOCE = ''14010'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '008', 'Previdenza complementare', 'N', null, null, 'S', 'SELECT ''4'' DATO FROM' || chr(10) || '(SELECT SUM(IMPORTO) IMPORTO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P430.PROGRESSIVO = P441.PROGRESSIVO AND P442.DATA_COMPETENZA_A BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND P430.COD_FPC IS NOT NULL' || chr(10) || 'AND P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE IN (''11080'',''11085'') AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'')' || chr(10) || 'WHERE IMPORTO > 0', 'SELECT ''4'' DATO FROM' || chr(10) || '(SELECT SUM(IMPORTO) IMPORTO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P430.PROGRESSIVO = P441.PROGRESSIVO AND P442.DATA_COMPETENZA_A BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND P430.COD_FPC IS NOT NULL' || chr(10) || 'AND P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE IN (''11080'',''11085'') AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'')' || chr(10) || 'WHERE IMPORTO > 0', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '009', 'Data iscrizione al fondo', 'N', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '011', 'Eventi eccezionali', 'N', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '016', 'Domicilio fiscale al 31/12/2013 o alla data di cessazione del rapporto di lavoro se precedente - Provincia (sigla)', 'N', null, null, 'S', 'SELECT T480.PROVINCIA DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''3112''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || '-- Solo se domicilio non variato rispetto al primo Gennaio' || chr(10) || 'AND T480.CODCATASTALE <>' || chr(10) || '(' || chr(10) || 'SELECT T480A.CODCATASTALE DATO FROM T430_STORICO T430A, T480_COMUNI T480A' || chr(10) || 'WHERE T430A.PROGRESSIVO = :Progressivo AND T430A.COMUNE = T480A.CODICE AND' || chr(10) || 'T430A.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ')', 'SELECT T480.PROVINCIA DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''3112''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || '-- Solo se domicilio non variato rispetto al primo Gennaio' || chr(10) || 'AND T480.CODCATASTALE <>' || chr(10) || '(' || chr(10) || 'SELECT T480A.CODCATASTALE DATO FROM T430_STORICO T430A, T480_COMUNI T480A' || chr(10) || 'WHERE T430A.PROGRESSIVO = :Progressivo AND T430A.COMUNE = T480A.CODICE AND' || chr(10) || 'T430A.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '001', 'Codice fiscale', 'N', null, null, 'N', 'SELECT CODFISCALE DATO FROM T030_ANAGRAFICO T030' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo', 'SELECT CODFISCALE DATO FROM T030_ANAGRAFICO T030' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '106', 'Credito per famiglie numerose recuperato', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT GREATEST(CRED_FAM_NUM_BASE - CRED_FAM_NUM_CONG, 0) DATO FROM' || chr(10) || '(SELECT NVL(SUM(IMPORTO),0) CRED_FAM_NUM_CONG FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''13154'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''),' || chr(10) || '(SELECT NVL(SUM(IMPORTO),0) CRED_FAM_NUM_BASE FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.ID_CEDOLINO <> :IdCedCongIRPEF' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''13151'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'')', 'SELECT GREATEST(CRED_FAM_NUM_BASE - CRED_FAM_NUM_CONG, 0) DATO FROM' || chr(10) || '(SELECT NVL(SUM(IMPORTO),0) CRED_FAM_NUM_CONG FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''13154'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''),' || chr(10) || '(SELECT NVL(SUM(IMPORTO),0) CRED_FAM_NUM_BASE FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.ID_CEDOLINO <> :IdCedCongIRPEF' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''13151'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '012', 'Domicilio fiscale all'' 1/1/2013 - Comune', 'N', null, null, 'S', 'SELECT RTRIM(T480.CITTA) DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))', 'SELECT RTRIM(T480.CITTA) DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '402', 'Acconti ed anticipazioni erogati in anni precedenti', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '027', 'Totale imponibile TFR', 'S', 'P1', 'M=S,D=2,0=N', 'S', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F510''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H510''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'SELECT DATIDMA.ANNO, SUM(DATIDMA.IMPORTO) DATO FROM' || chr(10) || '(' || chr(10) || '-- Query per impostare l''anno di riferimento' || chr(10) || 'SELECT DECODE(CAUSALE_VAR,' || chr(10) || '              ''7'',DECODE(MOTIVOUTIL,''3'',ANNO,''4'',ANNO,''5'',ANNO,:Anno),' || chr(10) || '              ANNO) ANNO,' || chr(10) || '       CAUSALE_VAR, MOTIVOUTIL, IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- Query di dettaglio quadri E0' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''F010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  ''E0'' CAUSALE_VAR, ''0'' MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F510''' || chr(10) || 'UNION ALL   ' || chr(10) || '-- Query di dettaglio quadri V1 con CausaleVariazione 1 o 7' || chr(10) || 'SELECT ' || chr(10) || '  (SELECT SUBSTR(VALORE,LENGTH(VALORE)-3,4) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''H010'' ' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) ANNO,' || chr(10) || '  (SELECT SUBSTR(ATTRIBUTO,19,1) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) CAUSALE_VAR,' || chr(10) || '  (SELECT DECODE(INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO''),0,''0'',SUBSTR(ATTRIBUTO,INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO'') + 18,1)) FROM P673_XMLDATIINDIVIDUALI' || chr(10) || '    WHERE ID_FLUSSO = P673.ID_FLUSSO AND PROGRESSIVO = P673.PROGRESSIVO AND NUMERO = ''E600''' || chr(10) || '      AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND TIPO_RECORD = P673.TIPO_RECORD) MOTIVOUTIL,' || chr(10) || '  VALORE IMPORTO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H510''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7'')' || chr(10) || '       AND INSTR(UPPER(ATTRIBUTO),''CODMOTIVOUTILIZZO=2'') = 0)' || chr(10) || ')' || chr(10) || ') DATIDMA' || chr(10) || 'GROUP BY ANNO', 
        'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '408', 'Quota spettante per indennita'' erogate ai sensi art. 2122 c.c.', 'S', null, 'M=S,D=3,0=N', 'S', 'SELECT DATO FROM' || chr(10) || '(SELECT P430.PERC_EREDITA DATO FROM P430_ANAGRAFICO P430 WHERE ' || chr(10) || 'P430.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''ER'' ' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE),' || chr(10) || '(SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) DATOBASE' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND :TipoDipendente = ''ER'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''06004 BASE'') AND TIPO_RECORD = ''M'')' || chr(10) || 'WHERE DATOBASE > 0', 'SELECT DATO FROM' || chr(10) || '(SELECT P430.PERC_EREDITA DATO FROM P430_ANAGRAFICO P430 WHERE ' || chr(10) || 'P430.PROGRESSIVO = :Progressivo AND :TipoDipendente = ''ER'' ' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE),' || chr(10) || '(SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) DATOBASE' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND :TipoDipendente = ''ER'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''06004 BASE'') AND TIPO_RECORD = ''M'')' || chr(10) || 'WHERE DATOBASE > 0', 'S', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '409', 'TFR maturato fino al 31/12/2000 e rimasto in azienda', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '410', 'TFR maturato dall'' 1/1/2001 e rimasto in azienda', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '411', 'TFR maturato fino al 31/12/2000 e versato al fondo', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '412', 'TFR maturato dall'' 1/1/2001 al 31/12/2006 e versato al fondo', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '413', 'TFR maturato dall'' 1/1/2007 e versato al fondo', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '107', 'Detrazioni per lavoro dipendente, pensioni e redditi assimilati', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT IMPORTO DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''13012'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'SELECT IMPORTO DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''13012'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '108', 'Detrazioni per oneri', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT IMPORTO DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''13090'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'SELECT IMPORTO DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''13090'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '109', 'Detrazioni per canoni di locazione', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '110', 'Credito riconosciuto per canoni di locazione', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '111', 'Credito non riconosciuto per canoni di locazione', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '112', 'Credito per canoni di locazione recuperato', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '113', 'Totale detrazioni', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(DECODE(COD_VOCE,''10002'',IMPORTO,-IMPORTO)) DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''10002'',''13154'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'SELECT SUM(DECODE(COD_VOCE,''10002'',IMPORTO,-IMPORTO)) DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''10002'',''13154'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '114', 'Credito d''imposta per le imposte pagate all''estero', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '120', 'Contributi previdenza complementare esclusi dai redditi di cui ai punti 1 e 2', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''10245'',''10246'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''10245'',''10246'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '129', 'Totale oneri sostenuti esclusi dai redditi indicati nei punti 1 e 2', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT P442.IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno' || chr(10) || 'AND RPAD(P442.COD_CONTRATTO,6,'' '')||RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN ('''')' || chr(10) || 'AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || '-- Riscatti e ricongiunzioni' || chr(10) || 'SELECT P442.IMPORTO * P216.PERCENTUALE / 100 IMPORTO' || chr(10) || 'FROM P441_CEDOLINO P441, P442_CEDOLINOVOCI P442, P216_ACCORPAMENTOVOCI P216' || chr(10) || 'WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno' || chr(10) || 'AND P442.COD_CONTRATTO = P216.COD_CONTRATTO AND P442.COD_VOCE = P216.COD_VOCE AND P442.COD_VOCE_SPECIALE = P216.COD_VOCE_SPECIALE' || chr(10) || 'AND P442.DATA_COMPETENZA_A BETWEEN P216.DECORRENZA AND P216.DECORRENZA_FINE' || chr(10) || 'AND P216.COD_TIPOACCORPAMENTOVOCI = ''DMAF1'' AND P216.COD_CODICIACCORPAMENTOVOCI = ''01''' || chr(10) || 'AND TIPO_RECORD = ''M'')', 
        'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT P442.IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno' || chr(10) || 'AND RPAD(P442.COD_CONTRATTO,6,'' '')||RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN ('''')' || chr(10) || 'AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || '-- Riscatti e ricongiunzioni' || chr(10) || 'SELECT P442.IMPORTO * P216.PERCENTUALE / 100 IMPORTO' || chr(10) || 'FROM P441_CEDOLINO P441, P442_CEDOLINOVOCI P442, P216_ACCORPAMENTOVOCI P216' || chr(10) || 'WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno' || chr(10) || 'AND P442.COD_CONTRATTO = P216.COD_CONTRATTO AND P442.COD_VOCE = P216.COD_VOCE AND P442.COD_VOCE_SPECIALE = P216.COD_VOCE_SPECIALE' || chr(10) || 'AND P442.DATA_COMPETENZA_A BETWEEN P216.DECORRENZA AND P216.DECORRENZA_FINE' || chr(10) || 'AND P216.COD_TIPOACCORPAMENTOVOCI = ''DMAF1'' AND P216.COD_CODICIACCORPAMENTOVOCI = ''01''' || chr(10) || 'AND TIPO_RECORD = ''M'')', 'S', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '002', 'Cognome', 'N', null, null, 'N', 'SELECT COGNOME DATO FROM T030_ANAGRAFICO T030' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo', 'SELECT COGNOME DATO FROM T030_ANAGRAFICO T030' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '003', 'Nome', 'N', null, null, 'N', 'SELECT NOME DATO FROM T030_ANAGRAFICO T030' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo', 'SELECT NOME DATO FROM T030_ANAGRAFICO T030' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '004', 'Sesso (M o F)', 'N', null, null, 'N', 'SELECT SESSO DATO FROM T030_ANAGRAFICO T030' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo', 'SELECT SESSO DATO FROM T030_ANAGRAFICO T030' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '005', 'Data di nascita', 'N', null, null, 'N', 'SELECT TO_CHAR(DATANAS,''DD/MM/YYYY'') DATO FROM T030_ANAGRAFICO T030' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo', 'SELECT TO_CHAR(DATANAS,''DD/MM/YYYY'') DATO FROM T030_ANAGRAFICO T030' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '131', 'Totale oneri per i quali e'' prevista la detrazione d''imposta', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT GREATEST(IMPORTO_ASSIC,0) DATO FROM' || chr(10) || '(' || chr(10) || 'SELECT LEAST(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.''''''),' || chr(10) || '-- Massimale detrazioni assicurazioni' || chr(10) || '(' || chr(10) || 'SELECT P233.IMPORTO_A FROM P232_SCAGLIONI P232,P233_SCAGLIONIFASCE P233' || chr(10) || 'WHERE P232.ID_SCAGLIONE=P233.ID_SCAGLIONE AND P233.IMPORTO_DA=0' || chr(10) || 'AND P232.COD_CONTRATTO=''EDP'' AND P232.COD_VOCE=''11402'' AND P232.COD_VOCE_SPECIALE=''BASE''' || chr(10) || 'AND P232.DECORRENZA=' || chr(10) || '  (SELECT MAX(DECORRENZA) FROM P232_SCAGLIONI WHERE COD_CONTRATTO=P232.COD_CONTRATTO' || chr(10) || '   AND COD_VOCE=P232.COD_VOCE AND COD_VOCE_SPECIALE=P232.COD_VOCE_SPECIALE' || chr(10) || '   AND DECORRENZA<=TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ')' || chr(10) || ') IMPORTO_ASSIC FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''11402'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || ')', 'SELECT GREATEST(IMPORTO_ASSIC,0) DATO FROM' || chr(10) || '(' || chr(10) || 'SELECT LEAST(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.''''''),' || chr(10) || '-- Massimale detrazioni assicurazioni' || chr(10) || '(' || chr(10) || 'SELECT P233.IMPORTO_A FROM P232_SCAGLIONI P232,P233_SCAGLIONIFASCE P233' || chr(10) || 'WHERE P232.ID_SCAGLIONE=P233.ID_SCAGLIONE AND P233.IMPORTO_DA=0' || chr(10) || 'AND P232.COD_CONTRATTO=''EDP'' AND P232.COD_VOCE=''11402'' AND P232.COD_VOCE_SPECIALE=''BASE''' || chr(10) || 'AND P232.DECORRENZA=' || chr(10) || '  (SELECT MAX(DECORRENZA) FROM P232_SCAGLIONI WHERE COD_CONTRATTO=P232.COD_CONTRATTO' || chr(10) || '   AND COD_VOCE=P232.COD_VOCE AND COD_VOCE_SPECIALE=P232.COD_VOCE_SPECIALE' || chr(10) || '   AND DECORRENZA<=TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ')' || chr(10) || ') IMPORTO_ASSIC FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''11402'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || ')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '132', 'Contributi versati a enti e casse aventi esclusivamente fini assistenziali', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '121', 'Contributi previdenza complementare non esclusi dai redditi di cui ai punti 1 e 2', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT GREATEST(SUM(IMPORTO),0) DATO FROM' || chr(10) || '(SELECT SUM(IMPORTO) IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno' || chr(10) || 'AND COD_VOCE = ''11080'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT -IMPORTO IMPORTO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''10245'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M'')', 'SELECT GREATEST(SUM(IMPORTO),0) DATO FROM' || chr(10) || '(SELECT SUM(IMPORTO) IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno' || chr(10) || 'AND COD_VOCE = ''11080'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT -IMPORTO IMPORTO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE = ''10245'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M'')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '122', 'Contributi previdenza complementare lavoratori di prima occupazione - Versati nell''anno', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '123', 'Contributi previdenza complementare lavoratori di prima occupazione - Importi eccedenti esclusi dai redditi di cui ai punti 1 e 2', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '124', 'Contributi previdenza complementare lavoratori di prima occupazione - Importo totale', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '125', 'Contributi previdenza complementare lavoratori di prima occupazione - Differenziale', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '126', 'Contributi previdenza complementare lavoratori di prima occupazione - Anni residui', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '127', 'Previdenza complementare per familiari a carico', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '134', 'Assicurazioni sanitarie', 'N', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '135', 'Applicazione maggiore ritenuta', 'N', null, null, 'S', 'SELECT NVL(MAX(DATO),'''') DATO FROM (' || chr(10) || 'SELECT ''X'' DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P441_CEDOLINO P441 WHERE P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND P430.PERC_IRPEF_MANUALE > 0' || chr(10) || 'AND P441.ID_CEDOLINO = :IdCedCongIRPEF AND (P441.TIPO_CEDOLINO = ''NR'' OR P441.TIPO_CEDOLINO = ''TR'')' || chr(10) || 'UNION' || chr(10) || 'SELECT ''X'' DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P441_CEDOLINO P441 WHERE P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND P430.PERC_IRPEF_EXTRA27 > 0' || chr(10) || 'AND P441.ID_CEDOLINO = :IdCedCongIRPEF AND P441.TIPO_CEDOLINO = ''EX''' || chr(10) || ')', 'SELECT NVL(MAX(DATO),'''') DATO FROM (' || chr(10) || 'SELECT ''X'' DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P441_CEDOLINO P441 WHERE P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND P430.PERC_IRPEF_MANUALE > 0' || chr(10) || 'AND P441.ID_CEDOLINO = :IdCedCongIRPEF AND (P441.TIPO_CEDOLINO = ''NR'' OR P441.TIPO_CEDOLINO = ''TR'')' || chr(10) || 'UNION' || chr(10) || 'SELECT ''X'' DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P441_CEDOLINO P441 WHERE P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''ddmmyyyy'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND P430.PERC_IRPEF_EXTRA27 > 0' || chr(10) || 'AND P441.ID_CEDOLINO = :IdCedCongIRPEF AND P441.TIPO_CEDOLINO = ''EX''' || chr(10) || ')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '006', 'Addizionale regionale all''Irpef', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT IMPORTO_TOTALE DATO' || chr(10) || 'FROM P258_ADDIZIONALIIRPEF P258, T430_STORICO T430' || chr(10) || 'WHERE P258.PROGRESSIVO = :Progressivo AND T430.PROGRESSIVO = P258.PROGRESSIVO' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''DDMMYYYY'') BETWEEN T430.DATADECORRENZA AND T430.DATAFINE' || chr(10) || 'AND TIPO_VERSAMENTO=''S'' AND ANNO = :Anno AND TIPO_ADDIZIONALE = ''R''' || chr(10) || 'AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY'')) > TO_DATE(''3112''||:Anno,''DDMMYYYY'')' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT IMPORTO_PAGATO - IMPORTO_RESTITUITO DATO' || chr(10) || 'FROM P258_ADDIZIONALIIRPEF P258, T430_STORICO T430' || chr(10) || 'WHERE P258.PROGRESSIVO = :Progressivo AND T430.PROGRESSIVO = P258.PROGRESSIVO' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''DDMMYYYY'') BETWEEN T430.DATADECORRENZA AND T430.DATAFINE' || chr(10) || 'AND TIPO_VERSAMENTO=''S'' AND ANNO = :Anno AND TIPO_ADDIZIONALE = ''R''' || chr(10) || 'AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY'')) <= TO_DATE(''3112''||:Anno,''DDMMYYYY'')', 'SELECT IMPORTO_TOTALE DATO' || chr(10) || 'FROM P258_ADDIZIONALIIRPEF P258, T430_STORICO T430' || chr(10) || 'WHERE P258.PROGRESSIVO = :Progressivo AND T430.PROGRESSIVO = P258.PROGRESSIVO' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''DDMMYYYY'') BETWEEN T430.DATADECORRENZA AND T430.DATAFINE' || chr(10) || 'AND TIPO_VERSAMENTO=''S'' AND ANNO = :Anno AND TIPO_ADDIZIONALE = ''R''' || chr(10) || 'AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY'')) > TO_DATE(''3112''||:Anno,''DDMMYYYY'')' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT IMPORTO_PAGATO - IMPORTO_RESTITUITO DATO' || chr(10) || 'FROM P258_ADDIZIONALIIRPEF P258, T430_STORICO T430' || chr(10) || 'WHERE P258.PROGRESSIVO = :Progressivo AND T430.PROGRESSIVO = P258.PROGRESSIVO' || chr(10) || 'AND TO_DATE(''3112''||:Anno,''DDMMYYYY'') BETWEEN T430.DATADECORRENZA AND T430.DATAFINE' || chr(10) || 'AND TIPO_VERSAMENTO=''S'' AND ANNO = :Anno AND TIPO_ADDIZIONALE = ''R''' || chr(10) || 'AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY'')) <= TO_DATE(''3112''||:Anno,''DDMMYYYY'')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '006', 'Comune (o Stato estero) di nascita', 'N', null, null, 'N', 'SELECT RTRIM(T480.CITTA) DATO FROM T030_ANAGRAFICO T030, T480_COMUNI T480' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo AND T030.COMUNENAS = T480.CODICE', 'SELECT RTRIM(T480.CITTA) DATO FROM T030_ANAGRAFICO T030, T480_COMUNI T480' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo AND T030.COMUNENAS = T480.CODICE', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '022', 'Anno di riferimento', 'S', null, 'M=N,D=0,0=N', 'N', 'SELECT DISTINCT DATO FROM (' || chr(10) || 'SELECT :Anno DATO' || chr(10) || '  FROM DUAL' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT DISTINCT SUBSTR(VALORE,LENGTH(VALORE)-3,4) DATO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F010''' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT DISTINCT SUBSTR(VALORE,LENGTH(VALORE)-3,4) DATO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H010''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7''))' || chr(10) || ')' || chr(10) || 'ORDER BY DATO DESC', 
        'SELECT DISTINCT DATO FROM (' || chr(10) || 'SELECT :Anno DATO' || chr(10) || '  FROM DUAL' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT DISTINCT SUBSTR(VALORE,LENGTH(VALORE)-3,4) DATO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''F010''' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT DISTINCT SUBSTR(VALORE,LENGTH(VALORE)-3,4) DATO' || chr(10) || '  FROM P673_XMLDATIINDIVIDUALI P673, P672_XMLTESTATE P672' || chr(10) || ' WHERE P672.NOME_FLUSSO = ''UNIEMENS''' || chr(10) || '   AND TO_CHAR(P672.DATA_FINE_PERIODO,''YYYY'') = :Anno ' || chr(10) || '   AND P672.CHIUSO = ''S'' AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '   AND P673.PROGRESSIVO = :Progressivo AND P673.TIPO_RECORD=''M'' ' || chr(10) || '   AND P673.NUMERO = ''H010''' || chr(10) || '   AND EXISTS ' || chr(10) || '   (SELECT ''X'' ' || chr(10) || '      FROM P673_XMLDATIINDIVIDUALI ' || chr(10) || '     WHERE ID_FLUSSO = P673.ID_FLUSSO ' || chr(10) || '       AND PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '       AND NUMERO = ''E600'' ' || chr(10) || '       AND PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO ' || chr(10) || '       AND TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '       AND SUBSTR(UPPER(ATTRIBUTO),1,19) IN (''CAUSALEVARIAZIONE=1'',''CAUSALEVARIAZIONE=7''))' || chr(10) || ')' || chr(10) || 'ORDER BY DATO DESC', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '020', 'Gestione Cred.', 'N', null, null, 'N', 'SELECT DECODE(INSTR(P094.COD_GESTASSIC,''9''),0,'''',''9'') DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P094_INQUADRINPDAP P094 WHERE P430.COD_INQUADRINPDAP = P094.COD_INQUADRINPDAP' || chr(10) || 'AND P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P094.DECORRENZA AND P094.DECORRENZA_FINE', 'SELECT DECODE(INSTR(P094.COD_GESTASSIC,''9''),0,'''',''9'') DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P094_INQUADRINPDAP P094 WHERE P430.COD_INQUADRINPDAP = P094.COD_INQUADRINPDAP' || chr(10) || 'AND P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P094.DECORRENZA AND P094.DECORRENZA_FINE', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'C21', '021', 'Gestione Enpdep/Enam', 'N', null, null, 'S', 'SELECT DECODE(INSTR(P094.COD_GESTASSIC,''8''),0,'''',''8'') DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P094_INQUADRINPDAP P094 WHERE P430.COD_INQUADRINPDAP = P094.COD_INQUADRINPDAP' || chr(10) || 'AND P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P094.DECORRENZA AND P094.DECORRENZA_FINE', 'SELECT DECODE(INSTR(P094.COD_GESTASSIC,''8''),0,'''',''8'') DATO' || chr(10) || 'FROM P430_ANAGRAFICO P430, P094_INQUADRINPDAP P094 WHERE P430.COD_INQUADRINPDAP = P094.COD_INQUADRINPDAP' || chr(10) || 'AND P430.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND TO_DATE(''3112''||:AA_Inpdap,''DDMMYYYY'') BETWEEN P094.DECORRENZA AND P094.DECORRENZA_FINE', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '010', 'Addizionale comunale all''Irpef - Acconto 2013', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT (IMPORTO_PAGATO - IMPORTO_RESTITUITO) DATO FROM P258_ADDIZIONALIIRPEF WHERE PROGRESSIVO = :Progressivo' || chr(10) || 'AND TIPO_VERSAMENTO=''A'' AND ANNO = :Anno AND TIPO_ADDIZIONALE = ''C''', 'SELECT (IMPORTO_PAGATO - IMPORTO_RESTITUITO) DATO FROM P258_ADDIZIONALIIRPEF WHERE PROGRESSIVO = :Progressivo' || chr(10) || 'AND TIPO_VERSAMENTO=''A'' AND ANNO = :Anno AND TIPO_ADDIZIONALE = ''C''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '204', 'Totale redditi conguagliato gia'' compreso nel punto 1', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM ' || chr(10) || '(SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) IMPORTO ' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441, P268_RAPPORTIPRECEDENTI P268 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND P268.PROGRESSIVO = P441.PROGRESSIVO ' || chr(10) || 'AND P268.DATA_CEDOLINO_RP = P441.DATA_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO = ''RP''' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(P441.DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''11200'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'AND P268.COD_FISCALE IS NOT NULL' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT -SUM(IMPORTO) ' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441, P268_RAPPORTIPRECEDENTI P268 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND P268.PROGRESSIVO = P441.PROGRESSIVO ' || chr(10) || 'AND P268.DATA_CEDOLINO_RP = P441.DATA_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO = ''RP''' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(P441.DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''14010'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'AND P268.COD_FISCALE IS NOT NULL' || chr(10) || ')', 
        'SELECT SUM(IMPORTO) DATO FROM ' || chr(10) || '(SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) IMPORTO ' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441, P268_RAPPORTIPRECEDENTI P268 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND P268.PROGRESSIVO = P441.PROGRESSIVO ' || chr(10) || 'AND P268.DATA_CEDOLINO_RP = P441.DATA_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO = ''RP''' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(P441.DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''11200'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'AND P268.COD_FISCALE IS NOT NULL' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT -SUM(IMPORTO) ' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441, P268_RAPPORTIPRECEDENTI P268 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND P268.PROGRESSIVO = P441.PROGRESSIVO ' || chr(10) || 'AND P268.DATA_CEDOLINO_RP = P441.DATA_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO = ''RP''' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(P441.DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''14010'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'AND P268.COD_FISCALE IS NOT NULL' || chr(10) || ')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '205', 'Totale redditi conguagliato gia'' compreso nel punto 2', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO ' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441, P268_RAPPORTIPRECEDENTI P268 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND P268.PROGRESSIVO = P441.PROGRESSIVO ' || chr(10) || 'AND P268.DATA_CEDOLINO_RP = P441.DATA_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO = ''RP''' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''14010'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'AND P268.COD_FISCALE IS NOT NULL', 'SELECT SUM(IMPORTO) DATO ' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441, P268_RAPPORTIPRECEDENTI P268 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND P268.PROGRESSIVO = P441.PROGRESSIVO ' || chr(10) || 'AND P268.DATA_CEDOLINO_RP = P441.DATA_CEDOLINO AND CHIUSO = ''S'' AND TIPO_CEDOLINO = ''RP''' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''14010'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'AND P268.COD_FISCALE IS NOT NULL', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '001', 'Redditi per i quali e'' possibile fruire della detrazione di cui all''art.13, commi 1, 2, 3 e 4 del Tuir', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT NVL(GREATEST(SUM(IMPORTO),0),0) DATO FROM' || chr(10) || '(' || chr(10) || '(SELECT DECODE(COD_VOCE,''10240'',IMPORTO,-IMPORTO) IMPORTO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || ':TipoDipendente <> ''ER'' AND TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''10240'',''10245'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M'')' || chr(10) || 'UNION ALL' || chr(10) || '(SELECT -SUM(IMPORTO) FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo AND' || chr(10) || ':TipoDipendente <> ''ER'' AND' || chr(10) || 'TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_VOCE = ''14010'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'HAVING SUM(IMPORTO) > 0)' || chr(10) || 'UNION ALL' || chr(10) || '(SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_VOCE = ''11200'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'' AND' || chr(10) || ':TipoDipendente = ''ER'')' || chr(10) || ')', 
        'SELECT NVL(GREATEST(SUM(IMPORTO),0),0) DATO FROM' || chr(10) || '(' || chr(10) || '(SELECT DECODE(COD_VOCE,''10240'',IMPORTO,-IMPORTO) IMPORTO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || ':TipoDipendente <> ''ER'' AND TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND' || chr(10) || 'COD_VOCE IN (''10240'',''10245'') AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M'')' || chr(10) || 'UNION ALL' || chr(10) || '(SELECT -SUM(IMPORTO) FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo AND' || chr(10) || ':TipoDipendente <> ''ER'' AND' || chr(10) || 'TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_VOCE = ''14010'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'HAVING SUM(IMPORTO) > 0)' || chr(10) || 'UNION ALL' || chr(10) || '(SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) IMPORTO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno AND COD_VOCE = ''11200'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'' AND' || chr(10) || ':TipoDipendente = ''ER'')' || chr(10) || ')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '003', 'Numero di giorni per i quali spettano le detrazioni di cui all''art.13, commi 1, 2, 3 e 4 del Tuir (Lavoro dipendente)', 'S', null, 'M=S,D=0,0=N', 'S', 'SELECT NVL(MAX(QUANTITA),0) DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND ' || chr(10) || 'COD_VOCE = ''13012'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'SELECT NVL(MAX(QUANTITA),0) DATO FROM P442_CEDOLINOVOCI WHERE ID_CEDOLINO = :IdCedCongIRPEF AND' || chr(10) || 'TO_CHAR(DATA_COMPETENZA_A,''YYYY'') = :Anno AND ' || chr(10) || 'COD_VOCE = ''13012'' AND COD_VOCE_SPECIALE = ''CONG'' AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '004', 'Numero di giorni per i quali spettano le detrazioni di cui all''art.13, commi 1, 2, 3 e 4 del Tuir (Pensione)', 'S', null, 'M=S,D=0,0=N', 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '401', 'Indennita'', acconti, anticipazioni e somme erogate nell''anno', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT SUM(NVL(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.''''''),0)) IMPORTO' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND :TipoDipendente = ''ER'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''06004 BASE'') AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) IMPORTO' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND :TipoDipendente <> ''ER'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''11230'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || '-- Somma dell''eventuale premio di operosita'' esente corrisposto nell''anno' || chr(10) || 'SELECT SUM(IMPORTO) IMPORTO' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND :TipoDipendente <> ''ER'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_CONTRATTO = ''EDPSC'' AND COD_VOCE = ''01205'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'')', 
        'SELECT SUM(IMPORTO) DATO FROM' || chr(10) || '(SELECT SUM(NVL(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.''''''),0)) IMPORTO' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND :TipoDipendente = ''ER'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND RPAD(COD_VOCE,6,'' '')||COD_VOCE_SPECIALE IN (''06004 BASE'') AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || 'SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) IMPORTO' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND :TipoDipendente <> ''ER'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''11230'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || '-- Somma dell''eventuale premio di operosita'' esente corrisposto nell''anno' || chr(10) || 'SELECT SUM(IMPORTO) IMPORTO' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND :TipoDipendente <> ''ER'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_CONTRATTO = ''EDPSC'' AND COD_VOCE = ''01205'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'')', 'S', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '024', 'Acconto addizionale comunale all''Irpef', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO_CONG_POS + IMPORTO_CONG_NEG) DATO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''ACD'',''ACC'')', 'SELECT SUM(IMPORTO_CONG_POS + IMPORTO_CONG_NEG) DATO FROM P264_MOD730IMPORTI WHERE PROGRESSIVO = :Progressivo AND' || chr(10) || 'ANNO = :Anno AND COD_TIPOIMPORTO IN(''ACD'',''ACC'')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '025', 'Acconto addizionale comunale all''Irpef sospeso', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '017', 'Domicilio fiscale all'' 1/1/2014 - Comune', 'N', null, null, 'S', 'SELECT RTRIM(T480.CITTA) DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY''))' || chr(10) || 'AND EXISTS' || chr(10) || '  (SELECT ''X'' FROM T430_STORICO' || chr(10) || '  WHERE PROGRESSIVO = :Progressivo' || chr(10) || '  AND TO_DATE(''0101''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY'')' || chr(10) || '  BETWEEN INIZIO AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY'')))' || chr(10) || '-- Solo se domicilio non variato rispetto al primo Gennaio' || chr(10) || 'AND T480.CODCATASTALE <>' || chr(10) || '(' || chr(10) || 'SELECT T480A.CODCATASTALE DATO FROM T430_STORICO T430A, T480_COMUNI T480A' || chr(10) || 'WHERE T430A.PROGRESSIVO = :Progressivo AND T430A.COMUNE = T480A.CODICE AND' || chr(10) || 'T430A.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ')', 
        'SELECT RTRIM(T480.CITTA) DATO FROM T430_STORICO T430, T480_COMUNI T480' || chr(10) || 'WHERE T430.PROGRESSIVO = :Progressivo AND T430.COMUNE = T480.CODICE AND' || chr(10) || 'T430.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY''))' || chr(10) || 'AND EXISTS' || chr(10) || '  (SELECT ''X'' FROM T430_STORICO' || chr(10) || '  WHERE PROGRESSIVO = :Progressivo' || chr(10) || '  AND TO_DATE(''0101''||TO_CHAR(TO_NUMBER(:Anno) + 1),''DDMMYYYY'')' || chr(10) || '  BETWEEN INIZIO AND NVL(FINE,TO_DATE(''31123999'',''DDMMYYYY'')))' || chr(10) || '-- Solo se domicilio non variato rispetto al primo Gennaio' || chr(10) || 'AND T480.CODCATASTALE <>' || chr(10) || '(' || chr(10) || 'SELECT T480A.CODCATASTALE DATO FROM T430_STORICO T430A, T480_COMUNI T480A' || chr(10) || 'WHERE T430A.PROGRESSIVO = :Progressivo AND T430A.COMUNE = T480A.CODICE AND' || chr(10) || 'T430A.DATADECORRENZA = ' || chr(10) || '  (SELECT MIN(DATADECORRENZA) FROM T430_STORICO ' || chr(10) || '   WHERE PROGRESSIVO = :Progressivo AND DATAFINE >= (TO_DATE(''0101''||:Anno,''DDMMYYYY'') - :GiorniDecorrVarDom)' || chr(10) || '   AND DATADECORRENZA <= TO_DATE(''3112''||:Anno,''DDMMYYYY''))' || chr(10) || ')', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'A', '007', 'Prov.nasc. (sigla)', 'N', null, null, 'N', 'SELECT T480.PROVINCIA DATO FROM T030_ANAGRAFICO T030, T480_COMUNI T480' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo AND T030.COMUNENAS = T480.CODICE', 'SELECT T480.PROVINCIA DATO FROM T030_ANAGRAFICO T030, T480_COMUNI T480' || chr(10) || 'WHERE T030.PROGRESSIVO = :Progressivo AND T030.COMUNENAS = T480.CODICE', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '251', 'Totale redditi 2013', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '252', 'Totale ritenute operate', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '253', 'Ritenute sospese', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '254', 'Vedere istruzioni', 'N', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '255', 'Redditi non imponibili art.51, comma 6 del Tuir', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '301', 'Totale redditi', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '351', 'Totale compensi arretrati per i quali e'' possibile fruire delle detrazioni', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) DATO' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''11220'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'' AND TO_NUMBER(QUANTITA,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')<>0' || chr(10) || '', 'SELECT SUM(TO_NUMBER(DATOBASE,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')) DATO' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''11220'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M'' AND TO_NUMBER(QUANTITA,''9G999G999G999D99999'',''nls_numeric_characters='''',.'''''')<>0' || chr(10) || '', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '352', 'Totale compensi arretrati per i quali non e'' possibile fruire delle detrazioni', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '353', 'Totale ritenute operate', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''11220'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || '', 'SELECT SUM(IMPORTO) DATO FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' ' || chr(10) || 'AND P441.PROGRESSIVO = :Progressivo AND TO_CHAR(DATA_CEDOLINO,''YYYY'') = :Anno ' || chr(10) || 'AND COD_VOCE = ''11220'' AND COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''' || chr(10) || '', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '354', 'Totale ritenute sospese', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '137', 'Contributo di solidarieta''', 'S', 'P1', 'M=S,D=2,0=N', 'S', 'SELECT SUM(IMPORTO) DATO' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(P442.DATA_COMPETENZA_A,''YYYY'') = :Anno AND COD_VOCE = ''11525'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''', 'SELECT SUM(IMPORTO) DATO' || chr(10) || 'FROM P442_CEDOLINOVOCI P442, P441_CEDOLINO P441 WHERE ' || chr(10) || 'P442.ID_CEDOLINO = P441.ID_CEDOLINO AND CHIUSO = ''S'' AND P441.PROGRESSIVO = :Progressivo' || chr(10) || 'AND TO_CHAR(P442.DATA_COMPETENZA_A,''YYYY'') = :Anno AND COD_VOCE = ''11525'' AND' || chr(10) || 'COD_VOCE_SPECIALE = ''BASE'' AND TIPO_RECORD = ''M''', 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '302', 'Totale ritenute Irpef', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '303', 'Totale addizionale regionale all''Irpef', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '304', 'Totale ritenute Irpef sospese', 'S', null, null, 'S', null, null, 'N', null);
insert into P502_CUDREGOLE (anno, parte, numero, descrizione, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento)
values (2013, 'B', '305', 'Totale addizionale regionale all''Irpef sospesa', 'S', null, null, 'S', null, null, 'N', null);

  end if;
end;
/

---------------------------
-- Fine regole CUD - 2013
---------------------------

-----
-- Inizio creazione voce EDP 00050 15070
-----

declare 
  i integer;
  ID_P200 integer;
  DesVoceCopia varchar2(40);
  DesVoceCopiaSt varchar2(40);

begin
DesVoceCopia:='Riduzione per distacco sindacale';
DesVoceCopiaSt:='Riduzione per distacco sindacale';

select COUNT(*) into i from P441_CEDOLINO;
if i > 0 then
  select COUNT(*) into i from P200_VOCI t 
    where T.COD_CONTRATTO ='EDP' and T.COD_VOCE='00050' and T.COD_VOCE_SPECIALE='BASE'
    and not exists
    (select 'X' from P200_VOCI v where v.cod_contratto=t.cod_contratto and v.cod_voce=t.cod_voce
       and v.cod_voce_speciale='15070');
  if i > 0 then

  
SELECT P200_ID_VOCE.NEXTVAL INTO ID_P200 FROM DUAL;
  
insert into p200_voci
select cod_contratto, cod_voce, '15070', decorrenza, ID_P200, DesVoceCopia, cod_voce_stampa, DesVoceCopiaSt, protetta, tipo, rid_mese_ass_cess, cassa_competenza, voce_importo, importo_automatico, importo_automatico_tipo, importo, importo_colonna, voce_quantita, cod_misuraquantita, ritenuta_massimali_scaglioni, ritenuta_perc, imponibile_minimali, cod_arrotondamento, perc_matura13a, mostra_video, confronto_mensile, stampa_cedolino, stampa_competenza, stampa_competenza_quote, cod_causaleirpef, ridotta_parttime_vert, ridotta_parttime_orizz, no_cedolino_normale, forza_ggcalcolo_quote, abbatte_ggminimali, abbatte_ggdetraz_caricofam, abbatte_ggdetraz_lavdip, abbatte_gganf, cumulo_annuale_cedolone, cod_raggruppamento, perc_abbatte13a, note, cumulo_in_calcolo, cod_voce_link_assog, cod_voce_speciale_link_assog, divisore_quote, abbatte_gginp, abbatte_ggina, programmata, oneri_detrazioni, eccezioni_sensibili, cod_raggruppamento_assogg, retribuzione_contrattuale, ritenuta_anagrafica, decorrenza_fine, cod_beneficiario, importo_massimo from p200_voci T
WHERE T.COD_CONTRATTO='EDP' AND T.COD_VOCE='00050' AND T.COD_VOCE_SPECIALE='15030';

INSERT INTO P201_ASSOGGETTAMENTI
select cod_contratto, cod_voce_padre, '15070', cod_voce_figlio, cod_voce_speciale_figlio, decorrenza, assoggettamento, assoggettamento13a, decorrenza_fine from p201_assoggettamenti t
where T.COD_CONTRATTO='EDP' and t.cod_voce_padre='00050' and t.cod_voce_speciale_padre='15030';

insert into p201_assoggettamenti
  (cod_contratto, cod_voce_padre, cod_voce_speciale_padre, cod_voce_figlio, cod_voce_speciale_figlio, decorrenza, assoggettamento, assoggettamento13a, decorrenza_fine)
values
  ('EDP', '00050', '15070', '14100', 'BASE', TO_DATE('01011900','DDMMYYYY'), 100, 100, TO_DATE('31123999','DDMMYYYY'));

INSERT INTO P216_ACCORPAMENTOVOCI
select cod_contratto, cod_voce, '15070', cod_tipoaccorpamentovoci, cod_codiciaccorpamentovoci, decorrenza, percentuale, importo_colonna, decorrenza_fine from p216_accorpamentovoci T
where T.COD_CONTRATTO='EDP' and t.cod_voce='00050' and t.cod_voce_speciale='15030';

INSERT INTO P205_QUOTE
select cod_contratto, cod_voce_da_quotare, cod_voce_speciale_da_quotare, '00050', cod_voce_speciale_in_quota, decorrenza, accumulo, accumulo_rateo, cod_voce_speciale_dettaglio, cod_voce_speciale_dettaglio13a
from p205_quote t 
where t.cod_contratto='EDP' and t.cod_voce_speciale_da_quotare='BASE' and t.cod_voce_in_quota='00110'
and t.cod_voce_speciale_in_quota='BASE' and t.cod_voce_speciale_dettaglio='15070';

  end if;

end if;
end;

/

-----
-- Fine creazione voce EDP 00050 15070
-----

---------------------------
-- INIZIO NUOVE REGOLE UNIEMENS per completamento nodo DescrMotivoUtilizzo
---------------------------
declare
  i integer;
begin
  select COUNT(*) into i from P670_XMLREGOLE t where t.Nome_Flusso='UNIEMENS';
  if i > 0 then
     DELETE P670_XMLREGOLE t WHERE t.NOME_FLUSSO='UNIEMENS' AND t.NUMERO IN('H052','H055','H057');

insert into P670_XMLREGOLE (nome_flusso, decorrenza, numero, elemento, descrizione, numero_padre, formato_file, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento, attributo, tipo_importo, dato_riepilogativo, decorrenza_fine)
values ('UNIEMENS', to_date('01-10-2012', 'dd-mm-yyyy'), 'H052', 'NumeroRegistro', 'Numero di registro generale relativo alla sentenza', 'H045', null, 'N', null, null, 'S', null, null, 'N', null, null, null, 'N', to_date('31-12-3999', 'dd-mm-yyyy'));
insert into P670_XMLREGOLE (nome_flusso, decorrenza, numero, elemento, descrizione, numero_padre, formato_file, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento, attributo, tipo_importo, dato_riepilogativo, decorrenza_fine)
values ('UNIEMENS', to_date('01-10-2012', 'dd-mm-yyyy'), 'H057', 'SedeGeograficaOrgano', 'Luogo dove risiede l''organo indicato o dove e'' avvenuta la transazione', 'H045', null, 'N', null, null, 'S', null, null, 'N', null, null, null, 'N', to_date('31-12-3999', 'dd-mm-yyyy'));
insert into P670_XMLREGOLE (nome_flusso, decorrenza, numero, elemento, descrizione, numero_padre, formato_file, numerico, cod_arrotondamento, formato, ometti_vuoto, regola_calcolo_automatica, regola_calcolo_manuale, regola_modificabile, commento, attributo, tipo_importo, dato_riepilogativo, decorrenza_fine)
values ('UNIEMENS', to_date('01-10-2012', 'dd-mm-yyyy'), 'H055', 'CodOrgano', 'Codice organo', 'H045', null, 'N', null, null, 'S', null, null, 'N', null, null, null, 'N', to_date('31-12-3999', 'dd-mm-yyyy'));

  end if;
end;
/
