object R350FCalcoloBuoniDtM: TR350FCalcoloBuoniDtM
  OldCreateOrder = True
  OnCreate = R350FCalcoloBuoniDtMCreate
  OnDestroy = R350FCalcoloBuoniDtMDestroy
  Height = 221
  Width = 425
  object Q670: TOracleDataSet
    SQL.Strings = (
      'SELECT * FROM T670_REGOLEBUONI')
    Optimize = False
    QBEDefinition.QBEFieldDefs = {
      05000000150000000C00000043004F0044004900430045000100000000001800
      000050004100530054004F005F005400490043004B0045005400010000000000
      0E00000041005300530045004E005A0041000100000000001000000050005200
      4500530045004E005A004100010000000000120000004F00520045004D004900
      4E0049004D0045000100000000001A0000004E004F004E004C00410056004F00
      520041005400490056004F000100000000001600000043004100550053005F00
      5400490043004B00450054000100000000000600000044004100310001000000
      0000040000004100310001000000000006000000440041003200010000000000
      04000000410032000100000000002000000046004F0052005A0041004D004100
      54005500520041005A0049004F004E0045000100000000001E00000049004E00
      490042004D00410054005500520041005A0049004F004E004500010000000000
      1A0000004F0052004100520049005300500045005A005A004100540049000100
      000000001A00000049004E00540045005200560041004C004C004F004D004900
      4E000100000000001A00000049004E00540045005200560041004C004C004F00
      4D0041005800010000000000180000005400490050004F005F00430041004C00
      43004F004C004F00010000000000180000004D004500530045005F0041005300
      530045004E005A0045000100000000001E0000004C0049004D00490054004900
      5F0053004500500041005200410054004900010000000000160000004F005200
      45005F004D0041005400540049004E0041000100000000001C0000004F005200
      45005F0050004F004D004500520049004700470049004F00010000000000}
    Left = 8
    Top = 4
  end
  object Q100: TOracleDataSet
    SQL.Strings = (
      'SELECT DISTINCT CAUSALE FROM T100_TIMBRATURE WHERE'
      
        'PROGRESSIVO = :PROGRESSIVO AND DATA = :DATA AND FLAG IN ('#39'O'#39','#39'I'#39 +
        ')')
    ReadBuffer = 100
    Optimize = False
    Variables.Data = {
      0400000002000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000A0000003A0044004100540041000C00
      00000000000000000000}
    Left = 44
    Top = 4
  end
  object Q680: TOracleDataSet
    SQL.Strings = (
      'SELECT VARBUONIPASTO,VARTICKET FROM T680_BUONIMENSILI'
      'WHERE PROGRESSIVO = :PROGRESSIVO AND '
      'ANNO = :ANNO AND MESE = :MESE')
    ReadBuffer = 100
    Optimize = False
    Variables.Data = {
      0400000003000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000A0000003A0041004E004E004F000300
      000000000000000000000A0000003A004D004500530045000300000000000000
      00000000}
    Left = 80
    Top = 4
  end
  object Q692: TOracleDataSet
    SQL.Strings = (
      'SELECT BUONIPASTO,TICKET FROM T692_RESIDUOBUONI'
      'WHERE '
      'PROGRESSIVO = :PROGRESSIVO AND ANNO = TO_CHAR(:DATA,'#39'YYYY'#39') AND'
      'ANNO > '
      '(SELECT TO_CHAR(INIZIO,'#39'YYYY'#39') FROM'
      '  ('
      '  SELECT MIN(INIZIO) INIZIO FROM '
      '  T030_ANAGRAFICO T030,T430_STORICO T430 WHERE'
      '  T030.PROGRESSIVO = :PROGRESSIVO AND '
      '  T030.RAPPORTI_UNITI = '#39'S'#39' AND'
      '  T430.PROGRESSIVO = T030.PROGRESSIVO'
      '  UNION'
      '  SELECT INIZIO FROM '
      '  T030_ANAGRAFICO T030,T430_STORICO T430 WHERE'
      '  T030.PROGRESSIVO = :PROGRESSIVO AND '
      '  T030.RAPPORTI_UNITI = '#39'N'#39' AND'
      '  T430.PROGRESSIVO = T030.PROGRESSIVO AND'
      
        '  :DATA BETWEEN INIZIO AND NVL(FINE,TO_DATE(31123999,'#39'DDMMYYYY'#39')' +
        ') '
      '  )'
      'WHERE INIZIO IS NOT NULL)'
      '')
    Optimize = False
    Variables.Data = {
      0400000002000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000A0000003A0044004100540041000C00
      00000000000000000000}
    Left = 212
    Top = 4
  end
  object selT040: TOracleDataSet
    SQL.Strings = (
      'SELECT COUNT(*) TOTALE FROM T040_GIUSTIFICATIVI T040'
      'WHERE'
      'PROGRESSIVO = :PROGRESSIVO AND'
      
        'DATA BETWEEN ADD_MONTHS(:DATA1,:OFFSET) AND ADD_MONTHS(:DATA2,:O' +
        'FFSET) AND'
      'TIPOGIUST = '#39'I'#39' AND'
      '--CAUSALE NOT IN ('#39#39')'
      '('
      'EXISTS('
      'SELECT '#39'X'#39' FROM T011_CALENDARI T011'
      '  WHERE '
      '  DATA = T040.DATA AND '
      '  CODICE = '
      '    (SELECT CALENDARIO FROM T430_STORICO WHERE '
      
        '     PROGRESSIVO = :PROGRESSIVO AND T040.DATA BETWEEN DATADECORR' +
        'ENZA AND DATAFINE) AND'
      '  LAVORATIVO = '#39'S'#39' AND '
      '  FESTIVO = '#39'N'#39' AND'
      '  NOT EXISTS '
      '    (SELECT '#39'X'#39' FROM T012_CALENDINDIVID WHERE'
      '       PROGRESSIVO = :PROGRESSIVO AND DATA = T011.DATA)'
      ')'
      'OR '
      'EXISTS ('
      'SELECT '#39'X'#39' GG FROM T012_CALENDINDIVID'
      '  WHERE '
      '  DATA = T040.DATA AND '
      '  PROGRESSIVO = :PROGRESSIVO AND'
      '  LAVORATIVO = '#39'S'#39' AND '
      '  FESTIVO = '#39'N'#39
      ')'
      ')')
    Optimize = False
    Variables.Data = {
      0400000004000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000C0000003A0044004100540041003100
      0C00000000000000000000000C0000003A00440041005400410032000C000000
      00000000000000000E0000003A004F0046004600530045005400030000000000
      000000000000}
    Left = 8
    Top = 52
  end
  object selGGLav: TOracleQuery
    SQL.Strings = (
      'SELECT COUNT(*) FROM '
      '('
      '  SELECT T011.DATA'
      '  FROM T011_CALENDARI T011,T430_STORICO T430'
      '  WHERE PROGRESSIVO = :PROGRESSIVO '
      '  AND T011.CODICE = CALENDARIO '
      '  AND DATA BETWEEN DATADECORRENZA AND DATAFINE '
      '  AND DATA BETWEEN :DADATA AND :ADATA '
      
        '  and T010F_GGLAVORATIVO(:PROGRESSIVO,DATA,:SEMPRE_CALENDARIO,:N' +
        'OPIANIF_CALENDARIO) = '#39'S'#39
      ') CAL, '
      'T020_ORARI T020'
      
        'WHERE EXISTS (SELECT '#39'X'#39' FROM T430_STORICO WHERE PROGRESSIVO = :' +
        'PROGRESSIVO AND DATA BETWEEN NVL(INIZIO,DATA + 1) AND NVL(FINE,D' +
        'ATA)) '
      
        '--considero anche le mezze giornate e verifico che la somma non ' +
        'dia una giornata intera'
      
        'AND 1 > (SELECT nvl(SUM(decode(TIPOGIUST,'#39'I'#39',1,'#39'M'#39',0.5)),0) FROM' +
        ' T040_GIUSTIFICATIVI T040 WHERE PROGRESSIVO = :PROGRESSIVO AND D' +
        'ATA = CAL.DATA AND TIPOGIUST in ('#39'I'#39','#39'M'#39') AND CAUSALE NOT IN (:C' +
        'AUSALI)) '
      'AND T020.CODICE = T020F_GETORARIODELGG(:PROGRESSIVO,DATA)'
      'AND INTERSEZ_LISTE(T020.CODICE,:ORARI_INIBITI) is null'
      
        'AND OREMINUTI(DECODE(T020.TIPOORA,'#39'E'#39',T020F_GETORETEOTUR(:PROGRE' +
        'SSIVO, DATA, T020.CODICE),T020.ORETEOR)) >= :MINIMO'
      
        'AND ((DECODE(T020.TIPOMENSA,'#39'Z'#39',:TIPOMENSA,T020.TIPOMENSA) <> '#39'Z' +
        #39') OR (T020.PERLAV = '#39'S'#39' AND :PERLAV = '#39'S'#39')) '
      
        'AND T020.DECORRENZA = (SELECT MAX(DECORRENZA) FROM T020_ORARI WH' +
        'ERE CODICE = T020.CODICE AND DECORRENZA <= DATA)')
    Optimize = False
    Variables.Data = {
      040000000A000000180000003A00500052004F00470052004500530053004900
      56004F00030000000400000004000000000000000E0000003A00440041004400
      4100540041000C0000000700000078650201010101000000000C0000003A0041
      0044004100540041000C000000070000007865021C010101000000000E000000
      3A004D0049004E0049004D004F00030000000000000000000000100000003A00
      430041005500530041004C004900010000000300000027270000000000140000
      003A005400490050004F004D0045004E00530041000500000000000000000000
      000E0000003A005000450052004C004100560005000000000000000000000024
      0000003A00530045004D005000520045005F00430041004C0045004E00440041
      00520049004F00050000000000000000000000280000003A004E004F00500049
      0041004E00490046005F00430041004C0045004E0044004100520049004F0005
      00000000000000000000001C0000003A004F0052004100520049005F0049004E
      0049004200490054004900050000000000000000000000}
    Left = 60
    Top = 52
  end
  object selResiduo: TOracleDataSet
    SQL.Strings = (
      'select sum(buonipasto) buoni,sum(ticket) ticket from '
      '  ('
      '    --Residui anno precedente'
      '    select '
      '      nvl(buonipasto,0) buonipasto,'
      '      nvl(ticket,0) ticket '
      '      from t692_residuobuoni where '
      '      progressivo = :progressivo and '
      '      anno = :anno and '
      '      anno > to_char(:inizio,'#39'yyyy'#39')'
      '    union all'
      '    --Acquistati'
      '    select '
      '      nvl(sum(nvl(buonipasto,0) + nvl(buoni_auto,0)),0),'
      '      nvl(sum(nvl(ticket,0) + nvl(ticket_auto,0)),0) '
      '      from t690_acquistobuoni where '
      '      progressivo = :progressivo and '
      '      data between :acquisto1 and last_day(:acquisto2) and'
      '      data between :inizio and :fine'
      '    union all'
      '    --Maturati'
      '    select '
      '      -1 * nvl(sum(nvl(buonipasto,0) + nvl(varbuonipasto,0)),0),'
      '      -1 * nvl(sum(nvl(ticket,0) + nvl(varticket,0)),0) '
      '      from t680_buonimensili where '
      '      progressivo = :progressivo and '
      
        '      to_date('#39'01'#39' || lpad(mese,2,'#39'0'#39') || lpad(anno,4,'#39'0'#39'),'#39'ddmm' +
        'yyyy'#39') between :acquisto1 and :acquisto2 and'
      
        '      to_date('#39'01'#39' || lpad(mese,2,'#39'0'#39') || lpad(anno,4,'#39'0'#39'),'#39'ddmm' +
        'yyyy'#39') between :inizio and :fine'
      '    union all'
      '    --Gi'#224' recuperati'
      '    select '
      '      -1 * nvl(sum(nvl(buoni_recuperati,0)),0),'
      '      -1 * nvl(sum(nvl(ticket_recuperati,0)),0)'
      '      from t690_acquistobuoni where'
      '      progressivo = :progressivo and '
      '      data between :recupero1 and last_day(:recupero2) and'
      '      data between add_months(:inizio,:mese_assenze) and :fine'
      '  )'
      '')
    Optimize = False
    Variables.Data = {
      0400000009000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000A0000003A0041004E004E004F000300
      00000000000000000000140000003A0041004300510055004900530054004F00
      31000C0000000000000000000000140000003A00410043005100550049005300
      54004F0032000C0000000000000000000000140000003A005200450043005500
      5000450052004F0031000C0000000000000000000000140000003A0052004500
      430055005000450052004F0032000C00000000000000000000000E0000003A00
      49004E0049005A0049004F000C00000000000000000000000A0000003A004600
      49004E0045000C00000000000000000000001A0000003A004D00450053004500
      5F0041005300530045004E005A004500030000000000000000000000}
    Left = 60
    Top = 104
  end
  object selPeriodoAcquisto: TOracleDataSet
    SQL.Strings = (
      
        'SELECT NVL(SUM(NVL(BUONI_AUTO,0)),0) BUONI,NVL(SUM(NVL(TICKET_AU' +
        'TO,0)),0) TICKET FROM '
      'T690_ACQUISTOBUONI WHERE'
      'PROGRESSIVO = :PROGRESSIVO AND '
      'DATA BETWEEN :DATA1 AND :DATA2 AND'
      'DATA <> :DATARIF')
    Optimize = False
    Variables.Data = {
      0400000004000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000C0000003A0044004100540041003100
      0C00000000000000000000000C0000003A00440041005400410032000C000000
      0000000000000000100000003A0044004100540041005200490046000C000000
      0000000000000000}
    Left = 300
    Top = 52
  end
  object selMediaT680: TOracleDataSet
    SQL.Strings = (
      'SELECT '
      '  SUM(NVL(BUONIPASTO,0) + NVL(VARBUONIPASTO,0)) BUONI,'
      '  SUM(NVL(TICKET,0) + NVL(VARTICKET,0)) TICKET,'
      '  COUNT(*) MESI'
      'FROM T680_BUONIMENSILI WHERE'
      '  PROGRESSIVO = :PROGRESSIVO AND '
      
        '  TO_DATE('#39'01'#39'||LPAD(MESE,2,'#39'0'#39')||LPAD(ANNO,4,'#39'0'#39'),'#39'DDMMYYYY'#39') B' +
        'ETWEEN :DATA1 AND :DATA2 AND'
      
        '  TO_DATE('#39'01'#39'||LPAD(MESE,2,'#39'0'#39')||LPAD(ANNO,4,'#39'0'#39'),'#39'DDMMYYYY'#39') B' +
        'ETWEEN :INIZIO AND :FINE ')
    Optimize = False
    Variables.Data = {
      0400000005000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000C0000003A0044004100540041003100
      0C00000000000000000000000C0000003A00440041005400410032000C000000
      00000000000000000E0000003A0049004E0049005A0049004F000C0000000000
      0000000000000A0000003A00460049004E0045000C0000000000000000000000}
    Left = 124
    Top = 52
  end
  object selPeriodoServizio: TOracleDataSet
    SQL.Strings = (
      'SELECT LAST_DAY(ADD_MONTHS(INIZIO,-1)) + 1 INIZIO,FINE FROM'
      '('
      
        'SELECT MIN(INIZIO) INIZIO,MAX(NVL(FINE,TO_DATE(31123999,'#39'DDMMYYY' +
        'Y'#39'))) FINE FROM '
      'T030_ANAGRAFICO T030,T430_STORICO T430 WHERE'
      'T030.PROGRESSIVO = :PROGRESSIVO AND '
      'T030.RAPPORTI_UNITI = '#39'S'#39' AND'
      'T430.PROGRESSIVO = T030.PROGRESSIVO'
      'UNION'
      'SELECT INIZIO,NVL(FINE,TO_DATE(31123999,'#39'DDMMYYYY'#39')) FINE FROM '
      'T030_ANAGRAFICO T030,T430_STORICO T430 WHERE'
      'T030.PROGRESSIVO = :PROGRESSIVO AND '
      'T030.RAPPORTI_UNITI = '#39'N'#39' AND'
      'T430.PROGRESSIVO = T030.PROGRESSIVO AND'
      
        '(:DATAINIZIO BETWEEN INIZIO AND NVL(FINE,TO_DATE(31123999,'#39'DDMMY' +
        'YYY'#39')) OR'
      
        ' :DATAFINE BETWEEN INIZIO AND NVL(FINE,TO_DATE(31123999,'#39'DDMMYYY' +
        'Y'#39')))'
      ')'
      'WHERE INIZIO IS NOT NULL')
    Optimize = False
    Variables.Data = {
      0400000003000000180000003A00500052004F00470052004500530053004900
      56004F00030000000000000000000000160000003A0044004100540041004900
      4E0049005A0049004F000C0000000000000000000000120000003A0044004100
      54004100460049004E0045000C0000000000000000000000}
    Left = 208
    Top = 52
  end
  object Q690: TOracleQuery
    SQL.Strings = (
      'DECLARE'
      '  CURSOR C1 IS'
      
        '    SELECT MIN(INIZIO) INIZIO,MAX(NVL(FINE,TO_DATE(31123999,'#39'DDM' +
        'MYYYY'#39'))) FINE FROM '
      '    T030_ANAGRAFICO T030,T430_STORICO T430 WHERE'
      '    T030.PROGRESSIVO = :PROGRESSIVO AND '
      '    T030.RAPPORTI_UNITI = '#39'S'#39' AND'
      '    T430.PROGRESSIVO = T030.PROGRESSIVO'
      '    UNION'
      
        '    SELECT INIZIO,NVL(FINE,TO_DATE(31123999,'#39'DDMMYYYY'#39')) FINE FR' +
        'OM '
      '    T030_ANAGRAFICO T030,T430_STORICO T430 WHERE'
      '    T030.PROGRESSIVO = :PROGRESSIVO AND '
      '    T030.RAPPORTI_UNITI = '#39'N'#39' AND'
      '    T430.PROGRESSIVO = T030.PROGRESSIVO AND'
      
        '    :DATA2 BETWEEN INIZIO AND NVL(FINE,TO_DATE(31123999,'#39'DDMMYYY' +
        'Y'#39'));'
      ''
      '  INIZIO DATE;'
      '  FINE DATE;'
      'BEGIN'
      '  :BUONI:=0;'
      '  :TICKET:=0;'
      '  INIZIO:=NULL;'
      '  FINE:=NULL;'
      '  FOR T1 IN C1 LOOP'
      '    IF T1.INIZIO IS NOT NULL THEN'
      '      INIZIO:=LAST_DAY(ADD_MONTHS(T1.INIZIO,-1)) + 1;'
      '      FINE:=T1.FINE;'
      '    END IF;'
      '  END LOOP;'
      '  IF INIZIO IS NULL THEN'
      '    RAISE NO_DATA_FOUND;'
      '  END IF;'
      '  SELECT SUM(NVL(TICKET,0) + NVL(TICKET_AUTO,0)),'
      '         SUM(NVL(BUONIPASTO,0) + NVL(BUONI_AUTO,0))'
      '  INTO :TICKET,:BUONI'
      '  FROM T690_ACQUISTOBUONI T690'
      '  WHERE '
      '  PROGRESSIVO = :PROGRESSIVO AND'
      '  DATA BETWEEN :DATA1 AND :DATA2 AND'
      '  DATA BETWEEN INIZIO AND FINE;'
      'EXCEPTION'
      '  WHEN NO_DATA_FOUND THEN'
      '    :BUONI:=0;'
      '    :TICKET:=0;'
      'END;'
      '')
    Optimize = False
    Variables.Data = {
      0400000005000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000C0000003A0044004100540041003200
      0C00000000000000000000000E0000003A005400490043004B00450054000300
      00000400000000000000000000000C0000003A00420055004F004E0049000300
      00000400000000000000000000000C0000003A00440041005400410031000C00
      00000000000000000000}
    Left = 164
    Top = 4
  end
  object selT375: TOracleDataSet
    SQL.Strings = (
      'SELECT DISTINCT DATA FROM T375_ACCESSIMENSA'
      
        'WHERE PROGRESSIVO = :PROGRESSIVO AND DATA BETWEEN :DATA1 AND :DA' +
        'TA2')
    Optimize = False
    Variables.Data = {
      0400000003000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000C0000003A0044004100540041003100
      0C00000000000000000000000C0000003A00440041005400410032000C000000
      0000000000000000}
    Left = 264
    Top = 4
  end
  object selRimborsiMissioni: TOracleDataSet
    SQL.Strings = (
      'SELECT COUNT(*) NUM FROM '
      'M040_MISSIONI M040, M050_RIMBORSI M050 WHERE'
      'M040.PROGRESSIVO = M050.PROGRESSIVO AND'
      'M040.MESESCARICO = M050.MESESCARICO AND'
      'M040.MESECOMPETENZA = M050.MESECOMPETENZA AND'
      'M040.DATADA = M050.DATADA AND '
      'M040.ORADA = M050.ORADA AND'
      'M040.PROGRESSIVO = :PROGRESSIVO AND'
      ':DATA BETWEEN M040.DATADA AND M040.DATAA AND'
      'M050.CODICERIMBORSOSPESE IN '
      
        '  (SELECT DISTINCT CODICERIMBORSO FROM M030_TARIFFAORARIA M030 W' +
        'HERE '
      '   CODICE ='
      
        '     (SELECT :COLONNA FROM T430_STORICO WHERE PROGRESSIVO = :PRO' +
        'GRESSIVO AND :DATA BETWEEN DATADECORRENZA AND DATAFINE)'
      '   AND DECORRENZA = '
      
        '     (SELECT MAX(DECORRENZA) FROM M030_TARIFFAORARIA WHERE CODIC' +
        'E = M030.CODICE AND DECORRENZA <= :DATA))'
      '')
    Optimize = False
    Variables.Data = {
      0400000003000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000A0000003A0044004100540041000C00
      00000000000000000000100000003A0043004F004C004F004E004E0041000100
      00000000000000000000}
    Left = 336
    Top = 4
  end
  object selRecuperoPrec: TOracleDataSet
    SQL.Strings = (
      'select '
      '  sum(nvl(buoni_recuperati_prec,0)) buoni,'
      '  sum(nvl(ticket_recuperati_prec,0)) ticket'
      '  from t690_acquistobuoni where'
      '  progressivo = :progressivo and '
      '  data between :recupero_prec1 and :recupero_prec2 and'
      '  data between :inizio and :fine')
    Optimize = False
    Variables.Data = {
      0400000005000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000001E0000003A0052004500430055005000
      450052004F005F00500052004500430031000C00000000000000000000001E00
      00003A0052004500430055005000450052004F005F0050005200450043003200
      0C00000000000000000000000E0000003A0049004E0049005A0049004F000C00
      000000000000000000000A0000003A00460049004E0045000C00000000000000
      00000000}
    Left = 136
    Top = 104
  end
  object selT690: TOracleDataSet
    SQL.Strings = (
      
        'SELECT BUONI_AUTO,BUONIPASTO,TICKET_AUTO,TICKET FROM T690_ACQUIS' +
        'TOBUONI'
      'WHERE PROGRESSIVO = :PROGRESSIVO AND DATA = :DATA')
    Optimize = False
    Variables.Data = {
      0400000002000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000A0000003A0044004100540041000C00
      00000000000000000000}
    Left = 120
    Top = 4
  end
  object insT680: TOracleQuery
    SQL.Strings = (
      'begin'
      '  if :esisteregolaperiodo <> '#39'S'#39' then'
      '    if :buonipasto = 0 and :ticket = 0 then'
      
        '      delete from t680_buonimensili where progressivo = :progres' +
        'sivo and anno = :anno and mese = :mese;'
      '    end if;'
      '  end if;'
      '  update t680_buonimensili set'
      '    buonipasto = :buonipasto,'
      '    ticket = :ticket'
      
        '  where progressivo = :progressivo and anno = :anno and mese = :' +
        'mese;'
      '  if sql%rowcount = 0 then'
      '    if :esisteregolaperiodo = '#39'S'#39' then'
      '      insert into t680_buonimensili '
      '        (progressivo,anno,mese,buonipasto,ticket)'
      '      values'
      '        (:progressivo,:anno,:mese,:buonipasto,:ticket);'
      '    end if;'
      '  end if;'
      'end;'
      '')
    Optimize = False
    Variables.Data = {
      0400000006000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000000A0000003A0041004E004E004F000300
      000000000000000000000A0000003A004D004500530045000300000000000000
      00000000160000003A00420055004F004E00490050004100530054004F000300
      000000000000000000000E0000003A005400490043004B004500540003000000
      0000000000000000280000003A00450053004900530054004500520045004700
      4F004C00410050004500520049004F0044004F00050000000000000000000000}
    Left = 14
    Top = 154
  end
  object TabellaStampa: TClientDataSet
    Aggregates = <>
    Params = <>
    Left = 220
    Top = 152
  end
  object insT690: TOracleQuery
    SQL.Strings = (
      'begin'
      '  if :esisteregolaperiodo <> '#39'S'#39' then'
      
        '    if :buoni_auto = 0 and :buoni_recuperati = 0 and :ticket_aut' +
        'o = 0 and :ticket_recuperati = 0 then'
      
        '      delete from t690_acquistobuoni where progressivo = :progre' +
        'ssivo and data = :data;'
      '    end if;'
      '  end if;'
      '  update t690_acquistobuoni set '
      '    buoni_auto = :buoni_auto,'
      '    buoni_recuperati = :buoni_recuperati,'
      '    buoni_recuperati_prec = :buoni_recuperati_prec,'
      '    ticket_auto = :ticket_auto,'
      '    ticket_recuperati = :ticket_recuperati,'
      '    ticket_recuperati_prec = :ticket_recuperati_prec'
      '  where'
      '    progressivo = :progressivo and data = :data;'
      '  if sql%rowcount = 0 then'
      '    if :esisteregolaperiodo = '#39'S'#39' then'
      '      insert into t690_acquistobuoni '
      
        '        (progressivo,data,buoni_auto,buoni_recuperati,buoni_recu' +
        'perati_prec,ticket_auto,ticket_recuperati,ticket_recuperati_prec' +
        ')'
      '        values'
      
        '        (:progressivo,:data,:buoni_auto,:buoni_recuperati,:buoni' +
        '_recuperati_prec,:ticket_auto,:ticket_recuperati,:ticket_recuper' +
        'ati_prec);'
      '    end if;'
      '  end if;'
      'end;')
    Optimize = False
    Variables.Data = {
      0400000009000000160000003A00420055004F004E0049005F00410055005400
      4F0003000000040000000000000000000000220000003A00420055004F004E00
      49005F0052004500430055005000450052004100540049000300000004000000
      0000000000000000180000003A005400490043004B00450054005F0041005500
      54004F0003000000040000000000000000000000240000003A00540049004300
      4B00450054005F00520045004300550050004500520041005400490003000000
      040000000000000000000000180000003A00500052004F004700520045005300
      5300490056004F00030000000400000004000000000000000A0000003A004400
      4100540041000C00000000000000000000002C0000003A00420055004F004E00
      49005F0052004500430055005000450052004100540049005F00500052004500
      43000300000000000000000000002E0000003A005400490043004B0045005400
      5F0052004500430055005000450052004100540049005F005000520045004300
      030000000000000000000000280000003A004500530049005300540045005200
      450047004F004C00410050004500520049004F0044004F000500000000000000
      00000000}
    Left = 69
    Top = 154
  end
  object insCSI008: TOracleQuery
    SQL.Strings = (
      'begin'
      
        '  delete from csi008_buonigiornalieri where progressivo = :progr' +
        'essivo and data = :data;'
      ' '
      '  if :buonipasto > 0 or :ticket > 0 then'
      
        '    insert into csi008_buonigiornalieri (progressivo,data,buonip' +
        'asto,ticket)'
      '    values (:progressivo,:data,:buonipasto,:ticket);'
      '  end if;'
      'end;'
      '')
    Optimize = False
    Variables.Data = {
      0400000004000000180000003A00500052004F00470052004500530053004900
      56004F00030000000000000000000000160000003A00420055004F004E004900
      50004100530054004F000300000000000000000000000E0000003A0054004900
      43004B00450054000300000000000000000000000A0000003A00440041005400
      41000C0000000000000000000000}
    Left = 126
    Top = 154
  end
end
