declare
  i integer;
begin
  select COUNT(*) into i from P441_CEDOLINO;
  if i > 0 then
    select COUNT(*) into i from P250_VOCIAGGIUNTIVE t where T.COD_CONTRATTO ='EDP' AND T.NOME_VOCEAGGIUNTIVA = 'INCARICO';
    if i > 0 then

      EXECUTE IMMEDIATE 'INSERT INTO I501INCARICO SELECT ''DR015-006-2010-S2002'',''Dirigente ruolo sanitario incarico lett. c) con struttura complessa (dec. 2010-2012) - semplice (dec. 2002)'' FROM DUAL WHERE NOT EXISTS (SELECT ''X'' FROM I501INCARICO T WHERE T.CODICE=''DR015-006-2010-S2002'')';
      INSERT INTO P252_VOCIAGGIUNTIVEIMPORTI
      SELECT COD_CONTRATTO, NOME_VOCEAGGIUNTIVA, 'DR015-006-2010-S2002', DECORRENZA, 'Dir. ruolo sanitario lett. c) con S.C. (dec. 2010-2012) - S.S. (dec. 2002)', COD_VOCE, COD_VOCE_SPECIALE,
             DECODE(P252.COD_VOCE,'00212',590.77,
                    DECODE(TO_CHAR(P252.DECORRENZA,'YYYY'),'2010',72.78)) IMPORTO,
             EROGAZIONE_MESI, DECORRENZA_FINE, COD_VALUTA_INIZ
      FROM P252_VOCIAGGIUNTIVEIMPORTI P252
      WHERE P252.COD_CONTRATTO='EDP' AND P252.NOME_VOCEAGGIUNTIVA='INCARICO'
      AND P252.CODICE='MV030-011-2010-S2002' AND NOT EXISTS
                  (SELECT 'X' FROM P252_VOCIAGGIUNTIVEIMPORTI T WHERE T.COD_CONTRATTO='EDP'
                  AND T.NOME_VOCEAGGIUNTIVA='INCARICO' AND T.CODICE='DR015-006-2010-S2002');

    end if;
  end if;
end;
/

insert into p080_causaliirpef
select '1045','Ritenute su contributi corrisposti ad imprese da Regioni, Province, Comuni ed altri enti pubblici' from dual
where not exists
(select 'x' from p080_causaliirpef t where t.cod_causaleirpef='1045')
and exists
(select 'x' from p080_causaliirpef t where t.cod_causaleirpef='1001');

insert into p080_causaliirpef
select 'F24106E','Ritenute sui contributi corrisposti alle imprese - articolo 28 D.P.R. 600/73' from dual
where not exists
(select 'x' from p080_causaliirpef t where t.cod_causaleirpef='F24106E')
and exists
(select 'x' from p080_causaliirpef t where t.cod_causaleirpef='1001');

declare
  ID_P242 integer;
  i integer;
begin
  select COUNT(*) into i from P240_TIPIASSOGGETTAMENTI t where t.cod_contratto='EDP'
         and t.cod_tipoassoggettamento='IRAP';
  if i > 0 then
    select COUNT(*) into i from P240_TIPIASSOGGETTAMENTI t where t.cod_contratto='EDP'
           and t.cod_tipoassoggettamento='IRPEF';
    if i = 0 then

      SELECT P242_ID_TIPOASSOGGETTAMENTO.NEXTVAL INTO ID_P242 FROM DUAL;

      INSERT INTO P240_TIPIASSOGGETTAMENTI
        (COD_TIPOASSOGGETTAMENTO, COD_CONTRATTO, DECORRENZA, ID_TIPOASSOGGETTAMENTO,
         DESCRIZIONE, DECORRENZA_FINE, TFR)
      VALUES
        ('IRPEF', 'EDP', TO_DATE('01011900','DDMMYYYY'), ID_P242,
         'IRPEF', TO_DATE('31123999','DDMMYYYY'), 'N');

      INSERT INTO P242_TIPIASSOGGETTAMENTIVOCI
        (ID_TIPOASSOGGETTAMENTO, COD_VOCE, COD_VOCE_SPECIALE)
      VALUES
        (ID_P242, '10200', 'BASE');
      INSERT INTO P242_TIPIASSOGGETTAMENTIVOCI
        (ID_TIPOASSOGGETTAMENTO, COD_VOCE, COD_VOCE_SPECIALE)
      VALUES
        (ID_P242, '10500', 'BASE');

    end if;
  end if;
end;
/

declare
  i integer;
begin
  select COUNT(*) into i from P660_FLUSSIREGOLE t where t.Nome_Flusso='F24EP';
  if i > 0 then
     DELETE P660_FLUSSIREGOLE t where t.Nome_Flusso='F24EP';

insert into P660_FLUSSIREGOLE (NOME_FLUSSO, DECORRENZA, PARTE, NUMERO, DESCRIZIONE, TIPO_RECORD, SEZIONE_FILE, NUMERO_FILE, FORMATO_FILE, LUNGHEZZA_FILE, FORMATO_ANNOMESE, NUMERICO, COD_ARROTONDAMENTO, FORMATO, OMETTI_VUOTO, TIPO_DATO, REGOLA_CALCOLO_AUTOMATICA, REGOLA_CALCOLO_MANUALE, REGOLA_MODIFICABILE, COMMENTO, FL_NUMERO_TREDICESIMA, FL_NUMERO_ARRCORR, FL_NUMERO_ARRPREC, NOME_DATO, CODICI_CAUSALI, FL_NUMERO_TREDPREC)
values ('F24EP', to_date('01-01-2008', 'dd-mm-yyyy'), 'E', '001', 'IRPEF', null, null, null, null, null, 'N', 'N', null, null, 'S', 'R', 'SELECT TIPO_RIGA, COD_TRIBUTO, COD_ENTE CODICE, '''' ESTREMI_IDENT,' || chr(10) || '       MESE RIFERIMENTO_A, ANNO RIFERIMENTO_B, SUM(IMPORTO) IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- IRPEF da competenze del mese' || chr(10) || 'SELECT ''F'' TIPO_RIGA,' || chr(10) || 'DECODE(P442.COD_VOCE||P442.COD_VOCE_SPECIALE,''11210BASE'',''100E'',''11220BASE'',''102E'',''11230BASE'',''110E'',''11520BASE'',''112E'',' || chr(10) || '       ''11500BASE'',DECODE(P430.COD_CAUSALEIRPEF,''1045'',''106E'',''104E''),' || chr(10) || '       ''11210CONG'',DECODE(SIGN(TO_CHAR(P441.DATA_CEDOLINO,''YYYY'') - TO_CHAR(P442.DATA_COMPETENZA_A,''YYYY'')),1,''111E'',''100E'')) COD_TRIBUTO,' || chr(10) || ''''' COD_ENTE, ''00'' || TO_CHAR(P441.DATA_CEDOLINO,''MM'') MESE,' || chr(10) || 'DECODE(P442.COD_VOCE||P442.COD_VOCE_SPECIALE,''11210CONG'',' || chr(10) || '       DECODE(SIGN(TO_CHAR(P441.DATA_CEDOLINO,''YYYY'') - TO_CHAR(P442.DATA_COMPETENZA_A,''YYYY'')),' || chr(10) || '              1,TO_NUMBER(TO_CHAR(P441.DATA_CEDOLINO,''YYYY'')) - 1,TO_NUMBER(TO_CHAR(P441.DATA_CEDOLINO,''YYYY''))),' || chr(10) || '       TO_NUMBER(TO_CHAR(P441.DATA_CEDOLINO,''YYYY''))) ANNO,' || chr(10) || 'P442.IMPORTO' || chr(10) || 'FROM P441_CEDOLINO P441, P442_CEDOLINOVOCI P442, P430_ANAGRAFICO P430' || chr(10) || 'WHERE P441.ID_CEDOLINO = P442.ID_CEDOLINO' || chr(10) || 'AND P441.PROGRESSIVO = P430.PROGRESSIVO AND P441.DATA_CEDOLINO BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND P441.DATA_CEDOLINO = :DataElaborazione AND P441.CHIUSO IN (:StatoCedolini)' || chr(10) || 'AND P442.COD_VOCE||P442.COD_VOCE_SPECIALE IN (''11210BASE'',''11220BASE'',''11230BASE'',''11500BASE'',''11520BASE'',''11210CONG'')' || chr(10) || 'AND P442.TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || '-- Addizionali saldo e acconto' || chr(10) || 'SELECT DECODE(P258.TIPO_ADDIZIONALE,''R'',''R'',''C'',''S'') TIPO_RIGA,' || chr(10) || 'DECODE(P442.COD_VOCE,''11250'',''384E'',''11255'',''385E'',''11270'',''381E'') COD_TRIBUTO,' || chr(10) || 'P258.COD_ENTE, ''00'' || TO_CHAR(P441.DATA_CEDOLINO,''MM'') MESE, P258.ANNO, P442.IMPORTO' || chr(10) || 'FROM P441_CEDOLINO P441, P442_CEDOLINOVOCI P442, P258_ADDIZIONALIIRPEF P258' || chr(10) || 'WHERE P441.ID_CEDOLINO = P442.ID_CEDOLINO AND P441.PROGRESSIVO = P258.PROGRESSIVO' || chr(10) || 'AND P441.DATA_CEDOLINO = :DataElaborazione AND P441.CHIUSO IN (:StatoCedolini)' || chr(10) || 'AND P258.ANNO = TO_CHAR(P442.DATA_COMPETENZA_A,''YYYY'')' || chr(10) || 'AND P258.TIPO_ADDIZIONALE = DECODE(P442.COD_VOCE,''11250'',''C'',''11255'',''C'',''11270'',''R'')' || chr(10) || 'AND P258.TIPO_VERSAMENTO = DECODE(P442.COD_VOCE,''11250'',''S'',''11255'',''A'',''11270'',''S'')' || chr(10) || 'AND P442.COD_VOCE IN (''11250'',''11255'',''11270'')' || chr(10) || 'AND P442.COD_VOCE_SPECIALE = ''BASE'' AND P442.TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || '-- Modello 730' || chr(10) || 'SELECT DECODE(P260.TIPO_ENTE,''N'',''F'',''R'',''R'',''C'',''S'') TIPO_RIGA,' || chr(10) || 'SUBSTR(P200.COD_CAUSALEIRPEF,4) COD_TRIBUTO,' || chr(10) || 'P264.COD_ENTE, ''00'' || TO_CHAR(P441.DATA_CEDOLINO,''MM'') MESE,' || chr(10) || 'P260.ANNO + P260.ANNO_IMPOSTA ANNO,' || chr(10) || 'P442.IMPORTO * DECODE(P200.IMPORTO_COLONNA,''C'',-1,''R'',1) IMPORTO' || chr(10) || 'FROM P441_CEDOLINO P441, P442_CEDOLINOVOCI P442, P200_VOCI P200,' || chr(10) || '     P260_MOD730TIPOIMPORTI P260, P264_MOD730IMPORTI P264,' || chr(10) || '     T480_COMUNI T480, T482_REGIONI T482' || chr(10) || 'WHERE P441.ID_CEDOLINO = P442.ID_CEDOLINO' || chr(10) || 'AND P441.DATA_CEDOLINO = :DataElaborazione AND P441.CHIUSO IN (:StatoCedolini)' || chr(10) || 'AND P442.TIPO_RECORD = ''M'' AND P200.ID_VOCE = P442.ID_VOCE AND' || chr(10) || '(' || chr(10) || '(P442.COD_VOCE = P260.COD_VOCE AND' || chr(10) || 'P442.COD_VOCE_SPECIALE = P260.COD_VOCE_SPECIALE) OR' || chr(10) || '(P442.COD_VOCE = P260.COD_VOCE_INT_RATE AND' || chr(10) || 'P442.COD_VOCE_SPECIALE = P260.COD_VOCE_SPECIALE_INT_RATE) OR' || chr(10) || '(P442.COD_VOCE = P260.COD_VOCE_INT_RITARDO AND' || chr(10) || 'P442.COD_VOCE_SPECIALE = P260.COD_VOCE_SPECIALE_INT_RITARDO)' || chr(10) || ') AND' || chr(10) || 'TO_CHAR(P442.DATA_COMPETENZA_A,''YYYY'') = P260.ANNO AND' || chr(10) || 'P260.ANNO = P264.ANNO AND P260.COD_TIPOIMPORTO = P264.COD_TIPOIMPORTO AND' || chr(10) || 'P264.PROGRESSIVO = P441.PROGRESSIVO AND' || chr(10) || 'P264.COD_ENTE = T480.CODCATASTALE(+) AND P264.COD_ENTE = T482.COD_REGIONE(+)' || chr(10) || ')' || chr(10) || 'GROUP BY TIPO_RIGA, COD_TRIBUTO, COD_ENTE, MESE, ANNO' || chr(10) || 'HAVING SUM(IMPORTO) <> 0' || chr(10) || 'ORDER BY TIPO_RIGA, COD_ENTE, COD_TRIBUTO, ANNO', 'SELECT TIPO_RIGA, COD_TRIBUTO, COD_ENTE CODICE, '''' ESTREMI_IDENT,' || chr(10) || '       MESE RIFERIMENTO_A, ANNO RIFERIMENTO_B, SUM(IMPORTO) IMPORTO FROM' || chr(10) || '(' || chr(10) || '-- IRPEF da competenze del mese' || chr(10) || 'SELECT ''F'' TIPO_RIGA,' || chr(10) || 'DECODE(P442.COD_VOCE||P442.COD_VOCE_SPECIALE,''11210BASE'',''100E'',''11220BASE'',''102E'',''11230BASE'',''110E'',''11520BASE'',''112E'',' || chr(10) || '       ''11500BASE'',DECODE(P430.COD_CAUSALEIRPEF,''1045'',''106E'',''104E''),' || chr(10) || '       ''11210CONG'',DECODE(SIGN(TO_CHAR(P441.DATA_CEDOLINO,''YYYY'') - TO_CHAR(P442.DATA_COMPETENZA_A,''YYYY'')),1,''111E'',''100E'')) COD_TRIBUTO,' || chr(10) || ''''' COD_ENTE, ''00'' || TO_CHAR(P441.DATA_CEDOLINO,''MM'') MESE,' || chr(10) || 'DECODE(P442.COD_VOCE||P442.COD_VOCE_SPECIALE,''11210CONG'',' || chr(10) || '       DECODE(SIGN(TO_CHAR(P441.DATA_CEDOLINO,''YYYY'') - TO_CHAR(P442.DATA_COMPETENZA_A,''YYYY'')),' || chr(10) || '              1,TO_NUMBER(TO_CHAR(P441.DATA_CEDOLINO,''YYYY'')) - 1,TO_NUMBER(TO_CHAR(P441.DATA_CEDOLINO,''YYYY''))),' || chr(10) || '       TO_NUMBER(TO_CHAR(P441.DATA_CEDOLINO,''YYYY''))) ANNO,' || chr(10) || 'P442.IMPORTO' || chr(10) || 'FROM P441_CEDOLINO P441, P442_CEDOLINOVOCI P442, P430_ANAGRAFICO P430' || chr(10) || 'WHERE P441.ID_CEDOLINO = P442.ID_CEDOLINO' || chr(10) || 'AND P441.PROGRESSIVO = P430.PROGRESSIVO AND P441.DATA_CEDOLINO BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || 'AND P441.DATA_CEDOLINO = :DataElaborazione AND P441.CHIUSO IN (:StatoCedolini)' || chr(10) || 'AND P442.COD_VOCE||P442.COD_VOCE_SPECIALE IN (''11210BASE'',''11220BASE'',''11230BASE'',''11500BASE'',''11520BASE'',''11210CONG'')' || chr(10) || 'AND P442.TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || '-- Addizionali saldo e acconto' || chr(10) || 'SELECT DECODE(P258.TIPO_ADDIZIONALE,''R'',''R'',''C'',''S'') TIPO_RIGA,' || chr(10) || 'DECODE(P442.COD_VOCE,''11250'',''384E'',''11255'',''385E'',''11270'',''381E'') COD_TRIBUTO,' || chr(10) || 'P258.COD_ENTE, ''00'' || TO_CHAR(P441.DATA_CEDOLINO,''MM'') MESE, P258.ANNO, P442.IMPORTO' || chr(10) || 'FROM P441_CEDOLINO P441, P442_CEDOLINOVOCI P442, P258_ADDIZIONALIIRPEF P258' || chr(10) || 'WHERE P441.ID_CEDOLINO = P442.ID_CEDOLINO AND P441.PROGRESSIVO = P258.PROGRESSIVO' || chr(10) || 'AND P441.DATA_CEDOLINO = :DataElaborazione AND P441.CHIUSO IN (:StatoCedolini)' || chr(10) || 'AND P258.ANNO = TO_CHAR(P442.DATA_COMPETENZA_A,''YYYY'')' || chr(10) || 'AND P258.TIPO_ADDIZIONALE = DECODE(P442.COD_VOCE,''11250'',''C'',''11255'',''C'',''11270'',''R'')' || chr(10) || 'AND P258.TIPO_VERSAMENTO = DECODE(P442.COD_VOCE,''11250'',''S'',''11255'',''A'',''11270'',''S'')' || chr(10) || 'AND P442.COD_VOCE IN (''11250'',''11255'',''11270'')' || chr(10) || 'AND P442.COD_VOCE_SPECIALE = ''BASE'' AND P442.TIPO_RECORD = ''M''' || chr(10) || 'UNION ALL' || chr(10) || '-- Modello 730' || chr(10) || 'SELECT DECODE(P260.TIPO_ENTE,''N'',''F'',''R'',''R'',''C'',''S'') TIPO_RIGA,' || chr(10) || 'SUBSTR(P200.COD_CAUSALEIRPEF,4) COD_TRIBUTO,' || chr(10) || 'P264.COD_ENTE, ''00'' || TO_CHAR(P441.DATA_CEDOLINO,''MM'') MESE,' || chr(10) || 'P260.ANNO + P260.ANNO_IMPOSTA ANNO,' || chr(10) || 'P442.IMPORTO * DECODE(P200.IMPORTO_COLONNA,''C'',-1,''R'',1) IMPORTO' || chr(10) || 'FROM P441_CEDOLINO P441, P442_CEDOLINOVOCI P442, P200_VOCI P200,' || chr(10) || '     P260_MOD730TIPOIMPORTI P260, P264_MOD730IMPORTI P264,' || chr(10) || '     T480_COMUNI T480, T482_REGIONI T482' || chr(10) || 'WHERE P441.ID_CEDOLINO = P442.ID_CEDOLINO' || chr(10) || 'AND P441.DATA_CEDOLINO = :DataElaborazione AND P441.CHIUSO IN (:StatoCedolini)' || chr(10) || 'AND P442.TIPO_RECORD = ''M'' AND P200.ID_VOCE = P442.ID_VOCE AND' || chr(10) || '(' || chr(10) || '(P442.COD_VOCE = P260.COD_VOCE AND' || chr(10) || 'P442.COD_VOCE_SPECIALE = P260.COD_VOCE_SPECIALE) OR' || chr(10) || '(P442.COD_VOCE = P260.COD_VOCE_INT_RATE AND' || chr(10) || 'P442.COD_VOCE_SPECIALE = P260.COD_VOCE_SPECIALE_INT_RATE) OR' || chr(10) || '(P442.COD_VOCE = P260.COD_VOCE_INT_RITARDO AND' || chr(10) || 'P442.COD_VOCE_SPECIALE = P260.COD_VOCE_SPECIALE_INT_RITARDO)' || chr(10) || ') AND' || chr(10) || 'TO_CHAR(P442.DATA_COMPETENZA_A,''YYYY'') = P260.ANNO AND' || chr(10) || 'P260.ANNO = P264.ANNO AND P260.COD_TIPOIMPORTO = P264.COD_TIPOIMPORTO AND' || chr(10) || 'P264.PROGRESSIVO = P441.PROGRESSIVO AND' || chr(10) || 'P264.COD_ENTE = T480.CODCATASTALE(+) AND P264.COD_ENTE = T482.COD_REGIONE(+)' || chr(10) || ')' || chr(10) || 'GROUP BY TIPO_RIGA, COD_TRIBUTO, COD_ENTE, MESE, ANNO' || chr(10) || 'HAVING SUM(IMPORTO) <> 0' || chr(10) || 'ORDER BY TIPO_RIGA, COD_ENTE, COD_TRIBUTO, ANNO', 'N', null, null, null, null, null, null, null);
insert into P660_FLUSSIREGOLE (NOME_FLUSSO, DECORRENZA, PARTE, NUMERO, DESCRIZIONE, TIPO_RECORD, SEZIONE_FILE, NUMERO_FILE, FORMATO_FILE, LUNGHEZZA_FILE, FORMATO_ANNOMESE, NUMERICO, COD_ARROTONDAMENTO, FORMATO, OMETTI_VUOTO, TIPO_DATO, REGOLA_CALCOLO_AUTOMATICA, REGOLA_CALCOLO_MANUALE, REGOLA_MODIFICABILE, COMMENTO, FL_NUMERO_TREDICESIMA, FL_NUMERO_ARRCORR, FL_NUMERO_ARRPREC, NOME_DATO, CODICI_CAUSALI, FL_NUMERO_TREDPREC)
values ('F24EP', to_date('01-01-2008', 'dd-mm-yyyy'), 'E', '002', 'IRAP', null, null, null, null, null, 'N', 'N', null, null, 'S', 'R', 'SELECT TIPO_RIGA, COD_TRIBUTO, COD_ENTE CODICE, '''' ESTREMI_IDENT,' || chr(10) || '       MESE RIFERIMENTO_A, ANNO RIFERIMENTO_B, IMPORTO IMPORTO FROM' || chr(10) || '(' || chr(10) || 'SELECT ''R'' TIPO_RIGA,''380E'' COD_TRIBUTO,' || chr(10) || '  (SELECT T482.COD_IRPEF FROM P500_CUDSETUP P500, T481_PROVINCE T481, T482_REGIONI T482' || chr(10) || '     WHERE P500.ANNO = TO_CHAR(P441.DATA_CEDOLINO,''YYYY'') AND P500.PROVINCIA = T481.COD_PROVINCIA' || chr(10) || '     AND T481.COD_REGIONE = T482.COD_REGIONE)' || chr(10) || '  COD_ENTE,' || chr(10) || '''00'' || TO_CHAR(P441.DATA_CEDOLINO,''MM'') MESE,' || chr(10) || 'TO_NUMBER(TO_CHAR(P441.DATA_CEDOLINO,''YYYY'')) ANNO,' || chr(10) || 'SUM(P442.IMPORTO) IMPORTO' || chr(10) || 'FROM P441_CEDOLINO P441, P442_CEDOLINOVOCI P442' || chr(10) || 'WHERE P441.ID_CEDOLINO = P442.ID_CEDOLINO' || chr(10) || 'AND P441.DATA_CEDOLINO = :DataElaborazione AND P441.CHIUSO IN (:StatoCedolini)' || chr(10) || 'AND P442.COD_VOCE IN (''11100'',''11102'')' || chr(10) || 'AND P442.COD_VOCE_SPECIALE = ''BASE'' AND P442.TIPO_RECORD = ''M''' || chr(10) || 'GROUP BY P441.DATA_CEDOLINO' || chr(10) || 'HAVING SUM(IMPORTO) <> 0' || chr(10) || ')', 'SELECT TIPO_RIGA, COD_TRIBUTO, COD_ENTE CODICE, '''' ESTREMI_IDENT,' || chr(10) || '       MESE RIFERIMENTO_A, ANNO RIFERIMENTO_B, IMPORTO IMPORTO FROM' || chr(10) || '(' || chr(10) || 'SELECT ''R'' TIPO_RIGA,''380E'' COD_TRIBUTO,' || chr(10) || '  (SELECT T482.COD_IRPEF FROM P500_CUDSETUP P500, T481_PROVINCE T481, T482_REGIONI T482' || chr(10) || '     WHERE P500.ANNO = TO_CHAR(P441.DATA_CEDOLINO,''YYYY'') AND P500.PROVINCIA = T481.COD_PROVINCIA' || chr(10) || '     AND T481.COD_REGIONE = T482.COD_REGIONE)' || chr(10) || '  COD_ENTE,' || chr(10) || '''00'' || TO_CHAR(P441.DATA_CEDOLINO,''MM'') MESE,' || chr(10) || 'TO_NUMBER(TO_CHAR(P441.DATA_CEDOLINO,''YYYY'')) ANNO,' || chr(10) || 'SUM(P442.IMPORTO) IMPORTO' || chr(10) || 'FROM P441_CEDOLINO P441, P442_CEDOLINOVOCI P442' || chr(10) || 'WHERE P441.ID_CEDOLINO = P442.ID_CEDOLINO' || chr(10) || 'AND P441.DATA_CEDOLINO = :DataElaborazione AND P441.CHIUSO IN (:StatoCedolini)' || chr(10) || 'AND P442.COD_VOCE IN (''11100'',''11102'')' || chr(10) || 'AND P442.COD_VOCE_SPECIALE = ''BASE'' AND P442.TIPO_RECORD = ''M''' || chr(10) || 'GROUP BY P441.DATA_CEDOLINO' || chr(10) || 'HAVING SUM(IMPORTO) <> 0' || chr(10) || ')', 'N', null, null, null, null, null, null, null);
insert into P660_FLUSSIREGOLE (NOME_FLUSSO, DECORRENZA, PARTE, NUMERO, DESCRIZIONE, TIPO_RECORD, SEZIONE_FILE, NUMERO_FILE, FORMATO_FILE, LUNGHEZZA_FILE, FORMATO_ANNOMESE, NUMERICO, COD_ARROTONDAMENTO, FORMATO, OMETTI_VUOTO, TIPO_DATO, REGOLA_CALCOLO_AUTOMATICA, REGOLA_CALCOLO_MANUALE, REGOLA_MODIFICABILE, COMMENTO, FL_NUMERO_TREDICESIMA, FL_NUMERO_ARRCORR, FL_NUMERO_ARRPREC, NOME_DATO, CODICI_CAUSALI, FL_NUMERO_TREDPREC)
values ('F24EP', to_date('01-01-2008', 'dd-mm-yyyy'), 'I', '001', 'INPS DM10', null, null, null, null, null, 'N', 'N', null, null, 'S', 'R', 'SELECT ''I'' TIPO_RIGA, ''DM10'' COD_TRIBUTO, SEDE_INPS CODICE, MATRICOLA_INPS ESTREMI_IDENT, ' || chr(10) || '       TO_CHAR(:DataElaborazione,''MMYYYY'') RIFERIMENTO_A, '''' RIFERIMENTO_B,' || chr(10) || '       SUM(IMPORTO) IMPORTO FROM' || chr(10) || '(' || chr(10) || 'SELECT DECODE(P672.MATRICOLA_INPS,'''',P500.MATRICOLA_INPS,P672.MATRICOLA_INPS) MATRICOLA_INPS,' || chr(10) || '       P500.SEDE_INPS, DECODE(P673.NUMERO,''Z510'',1,''Z515'',-1) * P673.VALORE IMPORTO' || chr(10) || 'FROM P672_XMLTESTATE P672, P673_XMLDATIINDIVIDUALI P673, P500_CUDSETUP P500' || chr(10) || 'WHERE P672.NOME_FLUSSO = ''UNIEMENS'' AND P672.DATA_FINE_PERIODO = :DataElaborazione' || chr(10) || 'AND P672.Chiuso IN (:StatoUniemens) AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || 'AND P673.NUMERO IN (''Z510'',''Z515'') AND P673.TIPO_RECORD = ''M''' || chr(10) || 'AND P500.ANNO = TO_CHAR(:DataElaborazione,''YYYY'')' || chr(10) || ')' || chr(10) || 'GROUP BY SEDE_INPS, MATRICOLA_INPS' || chr(10) || 'ORDER BY MATRICOLA_INPS', 'SELECT ''I'' TIPO_RIGA, ''DM10'' COD_TRIBUTO, SEDE_INPS CODICE, MATRICOLA_INPS ESTREMI_IDENT, ' || chr(10) || '       TO_CHAR(:DataElaborazione,''MMYYYY'') RIFERIMENTO_A, '''' RIFERIMENTO_B,' || chr(10) || '       SUM(IMPORTO) IMPORTO FROM' || chr(10) || '(' || chr(10) || 'SELECT DECODE(P672.MATRICOLA_INPS,'''',P500.MATRICOLA_INPS,P672.MATRICOLA_INPS) MATRICOLA_INPS,' || chr(10) || '       P500.SEDE_INPS, DECODE(P673.NUMERO,''Z510'',1,''Z515'',-1) * P673.VALORE IMPORTO' || chr(10) || 'FROM P672_XMLTESTATE P672, P673_XMLDATIINDIVIDUALI P673, P500_CUDSETUP P500' || chr(10) || 'WHERE P672.NOME_FLUSSO = ''UNIEMENS'' AND P672.DATA_FINE_PERIODO = :DataElaborazione' || chr(10) || 'AND P672.Chiuso IN (:StatoUniemens) AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || 'AND P673.NUMERO IN (''Z510'',''Z515'') AND P673.TIPO_RECORD = ''M''' || chr(10) || 'AND P500.ANNO = TO_CHAR(:DataElaborazione,''YYYY'')' || chr(10) || ')' || chr(10) || 'GROUP BY SEDE_INPS, MATRICOLA_INPS' || chr(10) || 'ORDER BY MATRICOLA_INPS', 'N', null, null, null, null, null, null, null);
insert into P660_FLUSSIREGOLE (NOME_FLUSSO, DECORRENZA, PARTE, NUMERO, DESCRIZIONE, TIPO_RECORD, SEZIONE_FILE, NUMERO_FILE, FORMATO_FILE, LUNGHEZZA_FILE, FORMATO_ANNOMESE, NUMERICO, COD_ARROTONDAMENTO, FORMATO, OMETTI_VUOTO, TIPO_DATO, REGOLA_CALCOLO_AUTOMATICA, REGOLA_CALCOLO_MANUALE, REGOLA_MODIFICABILE, COMMENTO, FL_NUMERO_TREDICESIMA, FL_NUMERO_ARRCORR, FL_NUMERO_ARRPREC, NOME_DATO, CODICI_CAUSALI, FL_NUMERO_TREDPREC)
values ('F24EP', to_date('01-01-2008', 'dd-mm-yyyy'), 'I', '002', 'INPS gestione separata', null, null, null, null, null, 'N', 'N', null, null, 'S', 'R', 'SELECT ''I'' TIPO_RIGA, COD_TRIBUTO, SEDE_INPS CODICE, CAP||COMUNE ESTREMI_IDENT, ' || chr(10) || '       TO_CHAR(:DataElaborazione,''MMYYYY'') RIFERIMENTO_A, '''' RIFERIMENTO_B,' || chr(10) || '       SUM(ROUND(IMPONIBILE * ALIQUOTA / 10000,2)) IMPORTO FROM' || chr(10) || '(' || chr(10) || 'SELECT P500.SEDE_INPS, TRIM(P500.CAP) CAP, TRIM(P500.COMUNE) COMUNE,' || chr(10) || '       DECODE(P430.COD_TIPOASSOGGETTAMENTO,''INPS1'',''C10'',''INPS2'',''CXX'',''INPS3'',''C10'') COD_TRIBUTO,' || chr(10) || '       P673.VALORE IMPONIBILE,' || chr(10) || '     NVL((SELECT P673A.VALORE FROM P673_XMLDATIINDIVIDUALI P673A WHERE P673A.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '     AND P673A.PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '     AND P673A.PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND P673A.TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '     AND P673A.NUMERO = ''C035''),0) ALIQUOTA' || chr(10) || 'FROM P672_XMLTESTATE P672, P673_XMLDATIINDIVIDUALI P673, P500_CUDSETUP P500, P430_ANAGRAFICO P430' || chr(10) || 'WHERE P672.NOME_FLUSSO = ''UNIEMENS'' AND P672.DATA_FINE_PERIODO = :DataElaborazione' || chr(10) || 'AND P672.Chiuso IN (:StatoUniemens) AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || 'AND P673.NUMERO = ''C030'' AND P673.TIPO_RECORD = ''M''' || chr(10) || 'AND P500.ANNO = TO_CHAR(:DataElaborazione,''YYYY'')' || chr(10) || 'AND P430.PROGRESSIVO = P673.PROGRESSIVO AND :DataElaborazione BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || ')' || chr(10) || 'GROUP BY SEDE_INPS, CAP, COMUNE, COD_TRIBUTO' || chr(10) || 'ORDER BY COD_TRIBUTO', 'SELECT ''I'' TIPO_RIGA, COD_TRIBUTO, SEDE_INPS CODICE, CAP||COMUNE ESTREMI_IDENT, ' || chr(10) || '       TO_CHAR(:DataElaborazione,''MMYYYY'') RIFERIMENTO_A, '''' RIFERIMENTO_B,' || chr(10) || '       SUM(ROUND(IMPONIBILE * ALIQUOTA / 10000,2)) IMPORTO FROM' || chr(10) || '(' || chr(10) || 'SELECT P500.SEDE_INPS, TRIM(P500.CAP) CAP, TRIM(P500.COMUNE) COMUNE,' || chr(10) || '       DECODE(P430.COD_TIPOASSOGGETTAMENTO,''INPS1'',''C10'',''INPS2'',''CXX'',''INPS3'',''C10'') COD_TRIBUTO,' || chr(10) || '       P673.VALORE IMPONIBILE,' || chr(10) || '     NVL((SELECT P673A.VALORE FROM P673_XMLDATIINDIVIDUALI P673A WHERE P673A.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || '     AND P673A.PROGRESSIVO = P673.PROGRESSIVO' || chr(10) || '     AND P673A.PROGRESSIVO_NUMERO = P673.PROGRESSIVO_NUMERO AND P673A.TIPO_RECORD = P673.TIPO_RECORD' || chr(10) || '     AND P673A.NUMERO = ''C035''),0) ALIQUOTA' || chr(10) || 'FROM P672_XMLTESTATE P672, P673_XMLDATIINDIVIDUALI P673, P500_CUDSETUP P500, P430_ANAGRAFICO P430' || chr(10) || 'WHERE P672.NOME_FLUSSO = ''UNIEMENS'' AND P672.DATA_FINE_PERIODO = :DataElaborazione' || chr(10) || 'AND P672.Chiuso IN (:StatoUniemens) AND P672.ID_FLUSSO = P673.ID_FLUSSO' || chr(10) || 'AND P673.NUMERO = ''C030'' AND P673.TIPO_RECORD = ''M''' || chr(10) || 'AND P500.ANNO = TO_CHAR(:DataElaborazione,''YYYY'')' || chr(10) || 'AND P430.PROGRESSIVO = P673.PROGRESSIVO AND :DataElaborazione BETWEEN P430.DECORRENZA AND P430.DECORRENZA_FINE' || chr(10) || ')' || chr(10) || 'GROUP BY SEDE_INPS, CAP, COMUNE, COD_TRIBUTO' || chr(10) || 'ORDER BY COD_TRIBUTO', 'N', null, null, null, null, null, null, null);
insert into P660_FLUSSIREGOLE (NOME_FLUSSO, DECORRENZA, PARTE, NUMERO, DESCRIZIONE, TIPO_RECORD, SEZIONE_FILE, NUMERO_FILE, FORMATO_FILE, LUNGHEZZA_FILE, FORMATO_ANNOMESE, NUMERICO, COD_ARROTONDAMENTO, FORMATO, OMETTI_VUOTO, TIPO_DATO, REGOLA_CALCOLO_AUTOMATICA, REGOLA_CALCOLO_MANUALE, REGOLA_MODIFICABILE, COMMENTO, FL_NUMERO_TREDICESIMA, FL_NUMERO_ARRCORR, FL_NUMERO_ARRPREC, NOME_DATO, CODICI_CAUSALI, FL_NUMERO_TREDPREC)
values ('F24EP', to_date('01-01-2008', 'dd-mm-yyyy'), 'Q', '001', 'INPDAP', null, null, null, null, null, 'N', 'N', null, null, 'S', 'R', 'SELECT ''Q'' TIPO_RIGA, ''P''||CASSA||CAUSALE COD_TRIBUTO,' || chr(10) || '       (SELECT TRIM(UPPER(P500.PROVINCIA)) FROM P500_CUDSETUP P500 WHERE P500.ANNO = TO_CHAR(:DataElaborazione,''YYYY'')) CODICE,' || chr(10) || '       '''' ESTREMI_IDENT, TO_CHAR(:DataElaborazione,''MMYYYY'') RIFERIMENTO_A, TO_CHAR(:DataElaborazione,''MMYYYY'') RIFERIMENTO_B, IMPORTO FROM' || chr(10) || '(' || chr(10) || 'SELECT PROGRESSIVO_NUMERO, CASSA, CAUSALE, SUM(VALORE) IMPORTO FROM' || chr(10) || '(' || chr(10) || 'SELECT P663.PROGRESSIVO_NUMERO,' || chr(10) || '  (SELECT P663A.VALORE FROM P663_FLUSSIDATIINDIVIDUALI P663A WHERE P663A.ID_FLUSSO = P663.ID_FLUSSO' || chr(10) || '     AND P663A.PROGRESSIVO = P663.PROGRESSIVO AND P663A.PARTE = P663.PARTE' || chr(10) || '     AND P663A.PROGRESSIVO_NUMERO = P663.PROGRESSIVO_NUMERO AND P663A.TIPO_RECORD = P663.TIPO_RECORD' || chr(10) || '     AND P663A.NUMERO = ''001'') CASSA,' || chr(10) || '  P660.CODICI_CAUSALI CAUSALE,' || chr(10) || '  P663.VALORE' || chr(10) || 'FROM P662_FLUSSITESTATE P662, P663_FLUSSIDATIINDIVIDUALI P663, P660_FLUSSIREGOLE P660' || chr(10) || 'WHERE P662.NOME_FLUSSO = ''DMA'' AND P662.DATA_FINE_PERIODO = :DataElaborazione' || chr(10) || 'AND P662.Chiuso IN (:StatoDMA) AND P662.ID_FLUSSO = P663.ID_FLUSSO' || chr(10) || 'AND P663.PARTE = ''Z2'' AND P663.TIPO_RECORD = ''M'' AND EXISTS' || chr(10) || '  (SELECT ''X'' FROM P663_FLUSSIDATIINDIVIDUALI P663B WHERE P663B.ID_FLUSSO = P663.ID_FLUSSO' || chr(10) || '   AND P663B.PROGRESSIVO = P663.PROGRESSIVO AND P663B.PARTE = P663.PARTE' || chr(10) || '   AND P663B.PROGRESSIVO_NUMERO = P663.PROGRESSIVO_NUMERO AND P663B.TIPO_RECORD = P663.TIPO_RECORD' || chr(10) || '   AND P663B.NUMERO = ''003'' AND P663B.VALORE = ''31'')' || chr(10) || 'AND P660.NOME_FLUSSO = P662.NOME_FLUSSO AND P660.PARTE = P663.PARTE  ' || chr(10) || 'AND P660.NUMERO = P663.NUMERO ' || chr(10) || 'AND P660.DECORRENZA = (SELECT MAX(DECORRENZA) FROM P660_FLUSSIREGOLE P660A ' || chr(10) || '                       WHERE P660.NOME_FLUSSO = P660A.NOME_FLUSSO AND P660.PARTE = P660A.PARTE ' || chr(10) || '                       AND P660.NUMERO = P660A.NUMERO AND P660A.DECORRENZA <= :DataElaborazione)' || chr(10) || 'AND P660.CODICI_CAUSALI IS NOT NULL AND P663.NUMERO <> ''021''' || chr(10) || '' || chr(10) || 'UNION ALL' || chr(10) || '' || chr(10) || 'SELECT 10000 PROGRESSIVO_NUMERO,' || chr(10) || '(SELECT VALORE FROM P663_FLUSSIDATIINDIVIDUALI WHERE ID_FLUSSO = P663.ID_FLUSSO ' || chr(10) || '    AND PROGRESSIVO = P663.PROGRESSIVO AND PARTE = P663.PARTE AND NUMERO = ''002'' ' || chr(10) || '    AND PROGRESSIVO_NUMERO = P663.PROGRESSIVO_NUMERO AND TIPO_RECORD = P663.TIPO_RECORD) CASSA,' || chr(10) || '(SELECT VALORE FROM P663_FLUSSIDATIINDIVIDUALI WHERE ID_FLUSSO = P663.ID_FLUSSO ' || chr(10) || '   AND PROGRESSIVO = P663.PROGRESSIVO AND PARTE = P663.PARTE AND NUMERO = ''003'' ' || chr(10) || '   AND PROGRESSIVO_NUMERO = P663.PROGRESSIVO_NUMERO AND TIPO_RECORD = P663.TIPO_RECORD) CAUSALE,' || chr(10) || 'DECODE((SELECT VALORE FROM P663_FLUSSIDATIINDIVIDUALI WHERE ID_FLUSSO = P663.ID_FLUSSO ' || chr(10) || '   AND PROGRESSIVO = P663.PROGRESSIVO AND PARTE = P663.PARTE AND NUMERO = ''007'' ' || chr(10) || '   AND PROGRESSIVO_NUMERO = P663.PROGRESSIVO_NUMERO AND TIPO_RECORD = P663.TIPO_RECORD),''V'',VALORE,''R'',-VALORE) IMPORTO' || chr(10) || 'FROM P662_FLUSSITESTATE P662, P663_FLUSSIDATIINDIVIDUALI P663' || chr(10) || 'WHERE P662.NOME_FLUSSO = ''DMA'' AND P662.DATA_FINE_PERIODO = :DataElaborazione' || chr(10) || 'AND P662.Chiuso IN (:StatoDMA) AND P662.ID_FLUSSO = P663.ID_FLUSSO' || chr(10) || 'AND TIPO_RECORD = ''M'' AND PARTE = ''F1'' AND NUMERO = ''005''' || chr(10) || 'AND (SELECT VALORE FROM P663_FLUSSIDATIINDIVIDUALI WHERE ID_FLUSSO = P663.ID_FLUSSO ' || chr(10) || '    AND PROGRESSIVO = P663.PROGRESSIVO AND PARTE = P663.PARTE AND NUMERO = ''003'' ' || chr(10) || '    AND PROGRESSIVO_NUMERO = P663.PROGRESSIVO_NUMERO AND TIPO_RECORD = P663.TIPO_RECORD) IN (''12'',''41'')' || chr(10) || ')' || chr(10) || 'GROUP BY PROGRESSIVO_NUMERO, CASSA, CAUSALE' || chr(10) || 'ORDER BY PROGRESSIVO_NUMERO, CASSA, CAUSALE' || chr(10) || ')', 'SELECT ''Q'' TIPO_RIGA, ''P''||CASSA||CAUSALE COD_TRIBUTO,' || chr(10) || '       (SELECT TRIM(UPPER(P500.PROVINCIA)) FROM P500_CUDSETUP P500 WHERE P500.ANNO = TO_CHAR(:DataElaborazione,''YYYY'')) CODICE,' || chr(10) || '       '''' ESTREMI_IDENT, TO_CHAR(:DataElaborazione,''MMYYYY'') RIFERIMENTO_A, TO_CHAR(:DataElaborazione,''MMYYYY'') RIFERIMENTO_B, IMPORTO FROM' || chr(10) || '(' || chr(10) || 'SELECT PROGRESSIVO_NUMERO, CASSA, CAUSALE, SUM(VALORE) IMPORTO FROM' || chr(10) || '(' || chr(10) || 'SELECT P663.PROGRESSIVO_NUMERO,' || chr(10) || '  (SELECT P663A.VALORE FROM P663_FLUSSIDATIINDIVIDUALI P663A WHERE P663A.ID_FLUSSO = P663.ID_FLUSSO' || chr(10) || '     AND P663A.PROGRESSIVO = P663.PROGRESSIVO AND P663A.PARTE = P663.PARTE' || chr(10) || '     AND P663A.PROGRESSIVO_NUMERO = P663.PROGRESSIVO_NUMERO AND P663A.TIPO_RECORD = P663.TIPO_RECORD' || chr(10) || '     AND P663A.NUMERO = ''001'') CASSA,' || chr(10) || '  P660.CODICI_CAUSALI CAUSALE,' || chr(10) || '  P663.VALORE' || chr(10) || 'FROM P662_FLUSSITESTATE P662, P663_FLUSSIDATIINDIVIDUALI P663, P660_FLUSSIREGOLE P660' || chr(10) || 'WHERE P662.NOME_FLUSSO = ''DMA'' AND P662.DATA_FINE_PERIODO = :DataElaborazione' || chr(10) || 'AND P662.Chiuso IN (:StatoDMA) AND P662.ID_FLUSSO = P663.ID_FLUSSO' || chr(10) || 'AND P663.PARTE = ''Z2'' AND P663.TIPO_RECORD = ''M'' AND EXISTS' || chr(10) || '  (SELECT ''X'' FROM P663_FLUSSIDATIINDIVIDUALI P663B WHERE P663B.ID_FLUSSO = P663.ID_FLUSSO' || chr(10) || '   AND P663B.PROGRESSIVO = P663.PROGRESSIVO AND P663B.PARTE = P663.PARTE' || chr(10) || '   AND P663B.PROGRESSIVO_NUMERO = P663.PROGRESSIVO_NUMERO AND P663B.TIPO_RECORD = P663.TIPO_RECORD' || chr(10) || '   AND P663B.NUMERO = ''003'' AND P663B.VALORE = ''31'')' || chr(10) || 'AND P660.NOME_FLUSSO = P662.NOME_FLUSSO AND P660.PARTE = P663.PARTE  ' || chr(10) || 'AND P660.NUMERO = P663.NUMERO ' || chr(10) || 'AND P660.DECORRENZA = (SELECT MAX(DECORRENZA) FROM P660_FLUSSIREGOLE P660A ' || chr(10) || '                       WHERE P660.NOME_FLUSSO = P660A.NOME_FLUSSO AND P660.PARTE = P660A.PARTE ' || chr(10) || '                       AND P660.NUMERO = P660A.NUMERO AND P660A.DECORRENZA <= :DataElaborazione)' || chr(10) || 'AND P660.CODICI_CAUSALI IS NOT NULL AND P663.NUMERO <> ''021''' || chr(10) || '' || chr(10) || 'UNION ALL' || chr(10) || '' || chr(10) || 'SELECT 10000 PROGRESSIVO_NUMERO,' || chr(10) || '(SELECT VALORE FROM P663_FLUSSIDATIINDIVIDUALI WHERE ID_FLUSSO = P663.ID_FLUSSO ' || chr(10) || '    AND PROGRESSIVO = P663.PROGRESSIVO AND PARTE = P663.PARTE AND NUMERO = ''002'' ' || chr(10) || '    AND PROGRESSIVO_NUMERO = P663.PROGRESSIVO_NUMERO AND TIPO_RECORD = P663.TIPO_RECORD) CASSA,' || chr(10) || '(SELECT VALORE FROM P663_FLUSSIDATIINDIVIDUALI WHERE ID_FLUSSO = P663.ID_FLUSSO ' || chr(10) || '   AND PROGRESSIVO = P663.PROGRESSIVO AND PARTE = P663.PARTE AND NUMERO = ''003'' ' || chr(10) || '   AND PROGRESSIVO_NUMERO = P663.PROGRESSIVO_NUMERO AND TIPO_RECORD = P663.TIPO_RECORD) CAUSALE,' || chr(10) || 'DECODE((SELECT VALORE FROM P663_FLUSSIDATIINDIVIDUALI WHERE ID_FLUSSO = P663.ID_FLUSSO ' || chr(10) || '   AND PROGRESSIVO = P663.PROGRESSIVO AND PARTE = P663.PARTE AND NUMERO = ''007'' ' || chr(10) || '   AND PROGRESSIVO_NUMERO = P663.PROGRESSIVO_NUMERO AND TIPO_RECORD = P663.TIPO_RECORD),''V'',VALORE,''R'',-VALORE) IMPORTO' || chr(10) || 'FROM P662_FLUSSITESTATE P662, P663_FLUSSIDATIINDIVIDUALI P663' || chr(10) || 'WHERE P662.NOME_FLUSSO = ''DMA'' AND P662.DATA_FINE_PERIODO = :DataElaborazione' || chr(10) || 'AND P662.Chiuso IN (:StatoDMA) AND P662.ID_FLUSSO = P663.ID_FLUSSO' || chr(10) || 'AND TIPO_RECORD = ''M'' AND PARTE = ''F1'' AND NUMERO = ''005''' || chr(10) || 'AND (SELECT VALORE FROM P663_FLUSSIDATIINDIVIDUALI WHERE ID_FLUSSO = P663.ID_FLUSSO ' || chr(10) || '    AND PROGRESSIVO = P663.PROGRESSIVO AND PARTE = P663.PARTE AND NUMERO = ''003'' ' || chr(10) || '    AND PROGRESSIVO_NUMERO = P663.PROGRESSIVO_NUMERO AND TIPO_RECORD = P663.TIPO_RECORD) IN (''12'',''41'')' || chr(10) || ')' || chr(10) || 'GROUP BY PROGRESSIVO_NUMERO, CASSA, CAUSALE' || chr(10) || 'ORDER BY PROGRESSIVO_NUMERO, CASSA, CAUSALE' || chr(10) || ')', 'N', null, null, null, null, null, null, null);

  end if;
end;
/

UPDATE t480_comuni t SET T.CITTA='POZZAGLIA SABINA' WHERE T.CODCATASTALE='G951';

